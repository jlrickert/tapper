var v6=Object.create;var{getPrototypeOf:G6,defineProperty:eJ,getOwnPropertyNames:O6}=Object;var f6=Object.prototype.hasOwnProperty;var TJ=(J,K,Q)=>{Q=J!=null?v6(G6(J)):{};let Z=K||!J||!J.__esModule?eJ(Q,"default",{value:J,enumerable:!0}):Q;for(let q of O6(J))if(!f6.call(Z,q))eJ(Z,q,{get:()=>J[q],enumerable:!0});return Z};var E0=(J,K)=>()=>(K||J((K={exports:{}}).exports,K),K.exports);var qJ=E0((c8,CQ)=>{CQ.exports=function(K){return K!==null&&typeof K==="object"&&typeof K.addUndirectedEdgeWithKey==="function"&&typeof K.dropNode==="function"&&typeof K.multi==="boolean"}});var IQ=E0((t7)=>{function r7(J){if(typeof J!=="number"||isNaN(J))return 1;return J}function a7(J,K){var Q={},Z=function(V){if(typeof V>"u")return K;return V};if(typeof K==="function")Z=K;var q=function(V){return Z(V[J])},W=function(){return Z(void 0)};if(typeof J==="string")Q.fromAttributes=q,Q.fromGraph=function(V,z){return q(V.getNodeAttributes(z))},Q.fromEntry=function(V,z){return q(z)};else if(typeof J==="function")Q.fromAttributes=function(){throw Error("graphology-utils/getters/createNodeValueGetter: irrelevant usage.")},Q.fromGraph=function(V,z){return Z(J(z,V.getNodeAttributes(z)))},Q.fromEntry=function(V,z){return Z(J(V,z))};else Q.fromAttributes=W,Q.fromGraph=W,Q.fromEntry=W;return Q}function PQ(J,K){var Q={},Z=function(V){if(typeof V>"u")return K;return V};if(typeof K==="function")Z=K;var q=function(V){return Z(V[J])},W=function(){return Z(void 0)};if(typeof J==="string")Q.fromAttributes=q,Q.fromGraph=function(V,z){return q(V.getEdgeAttributes(z))},Q.fromEntry=function(V,z){return q(z)},Q.fromPartialEntry=Q.fromEntry,Q.fromMinimalEntry=Q.fromEntry;else if(typeof J==="function")Q.fromAttributes=function(){throw Error("graphology-utils/getters/createEdgeValueGetter: irrelevant usage.")},Q.fromGraph=function(V,z){var B=V.extremities(z);return Z(J(z,V.getEdgeAttributes(z),B[0],B[1],V.getNodeAttributes(B[0]),V.getNodeAttributes(B[1]),V.isUndirected(z)))},Q.fromEntry=function(V,z,B,H,Y,$,X){return Z(J(V,z,B,H,Y,$,X))},Q.fromPartialEntry=function(V,z,B,H){return Z(J(V,z,B,H))},Q.fromMinimalEntry=function(V,z){return Z(J(V,z))};else Q.fromAttributes=W,Q.fromGraph=W,Q.fromEntry=W,Q.fromMinimalEntry=W;return Q}t7.createNodeValueGetter=a7;t7.createEdgeValueGetter=PQ;t7.createEdgeWeightGetter=function(J){return PQ(J,r7)}});var GQ=E0((p8,vQ)=>{var l=0,_=1,b=2,N=3,P0=4,I0=5,y=6,kQ=7,WJ=8,SQ=9,Z9=0,K9=1,q9=2,d=0,B0=1,a=2,M0=3,R0=4,m=5,Z0=6,F0=7,L0=8,RQ=3,j0=10,W9=3,o=9,NJ=10;vQ.exports=function(K,Q,Z){var q,W,V,z,B,H,Y,$,X,j,w=Q.length,L=Z.length,A=K.adjustSizes,G=K.barnesHutTheta*K.barnesHutTheta,k,T,P,O,M,I,R,U=[];for(V=0;V<w;V+=j0)Q[V+P0]=Q[V+b],Q[V+I0]=Q[V+N],Q[V+b]=0,Q[V+N]=0;if(K.outboundAttractionDistribution){k=0;for(V=0;V<w;V+=j0)k+=Q[V+y];k/=w/j0}if(K.barnesHutOptimize){var u=1/0,c=-1/0,h=1/0,J0=-1/0,E,n,q0;for(V=0;V<w;V+=j0)u=Math.min(u,Q[V+l]),c=Math.max(c,Q[V+l]),h=Math.min(h,Q[V+_]),J0=Math.max(J0,Q[V+_]);var T0=c-u,$0=J0-h;if(T0>$0)h-=(T0-$0)/2,J0=h+T0;else u-=($0-T0)/2,c=u+$0;U[0+d]=-1,U[0+B0]=(u+c)/2,U[0+a]=(h+J0)/2,U[0+M0]=Math.max(c-u,J0-h),U[0+R0]=-1,U[0+m]=-1,U[0+Z0]=0,U[0+F0]=0,U[0+L0]=0,q=1;for(V=0;V<w;V+=j0){W=0,q0=RQ;while(!0)if(U[W+m]>=0){if(Q[V+l]<U[W+B0])if(Q[V+_]<U[W+a])E=U[W+m];else E=U[W+m]+o;else if(Q[V+_]<U[W+a])E=U[W+m]+o*2;else E=U[W+m]+o*3;U[W+F0]=(U[W+F0]*U[W+Z0]+Q[V+l]*Q[V+y])/(U[W+Z0]+Q[V+y]),U[W+L0]=(U[W+L0]*U[W+Z0]+Q[V+_]*Q[V+y])/(U[W+Z0]+Q[V+y]),U[W+Z0]+=Q[V+y],W=E;continue}else if(U[W+d]<0){U[W+d]=V;break}else{if(U[W+m]=q*o,$=U[W+M0]/2,X=U[W+m],U[X+d]=-1,U[X+B0]=U[W+B0]-$,U[X+a]=U[W+a]-$,U[X+M0]=$,U[X+R0]=X+o,U[X+m]=-1,U[X+Z0]=0,U[X+F0]=0,U[X+L0]=0,X+=o,U[X+d]=-1,U[X+B0]=U[W+B0]-$,U[X+a]=U[W+a]+$,U[X+M0]=$,U[X+R0]=X+o,U[X+m]=-1,U[X+Z0]=0,U[X+F0]=0,U[X+L0]=0,X+=o,U[X+d]=-1,U[X+B0]=U[W+B0]+$,U[X+a]=U[W+a]-$,U[X+M0]=$,U[X+R0]=X+o,U[X+m]=-1,U[X+Z0]=0,U[X+F0]=0,U[X+L0]=0,X+=o,U[X+d]=-1,U[X+B0]=U[W+B0]+$,U[X+a]=U[W+a]+$,U[X+M0]=$,U[X+R0]=U[W+R0],U[X+m]=-1,U[X+Z0]=0,U[X+F0]=0,U[X+L0]=0,q+=4,Q[U[W+d]+l]<U[W+B0])if(Q[U[W+d]+_]<U[W+a])E=U[W+m];else E=U[W+m]+o;else if(Q[U[W+d]+_]<U[W+a])E=U[W+m]+o*2;else E=U[W+m]+o*3;if(U[W+Z0]=Q[U[W+d]+y],U[W+F0]=Q[U[W+d]+l],U[W+L0]=Q[U[W+d]+_],U[E+d]=U[W+d],U[W+d]=-1,Q[V+l]<U[W+B0])if(Q[V+_]<U[W+a])n=U[W+m];else n=U[W+m]+o;else if(Q[V+_]<U[W+a])n=U[W+m]+o*2;else n=U[W+m]+o*3;if(E===n)if(q0--){W=E;continue}else{q0=RQ;break}U[n+d]=V;break}}}if(K.barnesHutOptimize){T=K.scalingRatio;for(V=0;V<w;V+=j0){W=0;while(!0)if(U[W+m]>=0)if(I=Math.pow(Q[V+l]-U[W+F0],2)+Math.pow(Q[V+_]-U[W+L0],2),j=U[W+M0],4*j*j/I<G){if(P=Q[V+l]-U[W+F0],O=Q[V+_]-U[W+L0],A===!0){if(I>0)R=T*Q[V+y]*U[W+Z0]/I,Q[V+b]+=P*R,Q[V+N]+=O*R;else if(I<0)R=-T*Q[V+y]*U[W+Z0]/Math.sqrt(I),Q[V+b]+=P*R,Q[V+N]+=O*R}else if(I>0)R=T*Q[V+y]*U[W+Z0]/I,Q[V+b]+=P*R,Q[V+N]+=O*R;if(W=U[W+R0],W<0)break;continue}else{W=U[W+m];continue}else{if(H=U[W+d],H>=0&&H!==V){if(P=Q[V+l]-Q[H+l],O=Q[V+_]-Q[H+_],I=P*P+O*O,A===!0){if(I>0)R=T*Q[V+y]*Q[H+y]/I,Q[V+b]+=P*R,Q[V+N]+=O*R;else if(I<0)R=-T*Q[V+y]*Q[H+y]/Math.sqrt(I),Q[V+b]+=P*R,Q[V+N]+=O*R}else if(I>0)R=T*Q[V+y]*Q[H+y]/I,Q[V+b]+=P*R,Q[V+N]+=O*R}if(W=U[W+R0],W<0)break;continue}}}else{T=K.scalingRatio;for(z=0;z<w;z+=j0)for(B=0;B<z;B+=j0)if(P=Q[z+l]-Q[B+l],O=Q[z+_]-Q[B+_],A===!0){if(I=Math.sqrt(P*P+O*O)-Q[z+WJ]-Q[B+WJ],I>0)R=T*Q[z+y]*Q[B+y]/I/I,Q[z+b]+=P*R,Q[z+N]+=O*R,Q[B+b]-=P*R,Q[B+N]-=O*R;else if(I<0)R=100*T*Q[z+y]*Q[B+y],Q[z+b]+=P*R,Q[z+N]+=O*R,Q[B+b]-=P*R,Q[B+N]-=O*R}else if(I=Math.sqrt(P*P+O*O),I>0)R=T*Q[z+y]*Q[B+y]/I/I,Q[z+b]+=P*R,Q[z+N]+=O*R,Q[B+b]-=P*R,Q[B+N]-=O*R}X=K.gravity/K.scalingRatio,T=K.scalingRatio;for(V=0;V<w;V+=j0){if(R=0,P=Q[V+l],O=Q[V+_],I=Math.sqrt(Math.pow(P,2)+Math.pow(O,2)),K.strongGravityMode){if(I>0)R=T*Q[V+y]*X}else if(I>0)R=T*Q[V+y]*X/I;Q[V+b]-=P*R,Q[V+N]-=O*R}T=1*(K.outboundAttractionDistribution?k:1);for(Y=0;Y<L;Y+=W9){if(z=Z[Y+Z9],B=Z[Y+K9],$=Z[Y+q9],M=Math.pow($,K.edgeWeightInfluence),P=Q[z+l]-Q[B+l],O=Q[z+_]-Q[B+_],A===!0){if(I=Math.sqrt(P*P+O*O)-Q[z+WJ]-Q[B+WJ],K.linLogMode){if(K.outboundAttractionDistribution){if(I>0)R=-T*M*Math.log(1+I)/I/Q[z+y]}else if(I>0)R=-T*M*Math.log(1+I)/I}else if(K.outboundAttractionDistribution){if(I>0)R=-T*M/Q[z+y]}else if(I>0)R=-T*M}else if(I=Math.sqrt(Math.pow(P,2)+Math.pow(O,2)),K.linLogMode){if(K.outboundAttractionDistribution){if(I>0)R=-T*M*Math.log(1+I)/I/Q[z+y]}else if(I>0)R=-T*M*Math.log(1+I)/I}else if(K.outboundAttractionDistribution)I=1,R=-T*M/Q[z+y];else I=1,R=-T*M;if(I>0)Q[z+b]+=P*R,Q[z+N]+=O*R,Q[B+b]-=P*R,Q[B+N]-=O*R}var W0,Q0,K0,Y0,r,x0;if(A===!0){for(V=0;V<w;V+=j0)if(Q[V+SQ]!==1){if(W0=Math.sqrt(Math.pow(Q[V+b],2)+Math.pow(Q[V+N],2)),W0>NJ)Q[V+b]=Q[V+b]*NJ/W0,Q[V+N]=Q[V+N]*NJ/W0;Q0=Q[V+y]*Math.sqrt((Q[V+P0]-Q[V+b])*(Q[V+P0]-Q[V+b])+(Q[V+I0]-Q[V+N])*(Q[V+I0]-Q[V+N])),K0=Math.sqrt((Q[V+P0]+Q[V+b])*(Q[V+P0]+Q[V+b])+(Q[V+I0]+Q[V+N])*(Q[V+I0]+Q[V+N]))/2,Y0=0.1*Math.log(1+K0)/(1+Math.sqrt(Q0)),r=Q[V+l]+Q[V+b]*(Y0/K.slowDown),Q[V+l]=r,x0=Q[V+_]+Q[V+N]*(Y0/K.slowDown),Q[V+_]=x0}}else for(V=0;V<w;V+=j0)if(Q[V+SQ]!==1)Q0=Q[V+y]*Math.sqrt((Q[V+P0]-Q[V+b])*(Q[V+P0]-Q[V+b])+(Q[V+I0]-Q[V+N])*(Q[V+I0]-Q[V+N])),K0=Math.sqrt((Q[V+P0]+Q[V+b])*(Q[V+P0]+Q[V+b])+(Q[V+I0]+Q[V+N])*(Q[V+I0]+Q[V+N]))/2,Y0=Q[V+kQ]*Math.log(1+K0)/(1+Math.sqrt(Q0)),Q[V+kQ]=Math.min(1,Math.sqrt(Y0*(Math.pow(Q[V+b],2)+Math.pow(Q[V+N],2))/(1+Math.sqrt(Q0)))),r=Q[V+l]+Q[V+b]*(Y0/K.slowDown),Q[V+l]=r,x0=Q[V+_]+Q[V+N]*(Y0/K.slowDown),Q[V+_]=x0;return{}}});var fQ=E0((V9)=>{var i0=10,OQ=3;V9.assign=function(J){J=J||{};var K=Array.prototype.slice.call(arguments).slice(1),Q,Z,q;for(Q=0,q=K.length;Q<q;Q++){if(!K[Q])continue;for(Z in K[Q])J[Z]=K[Q][Z]}return J};V9.validateSettings=function(J){if("linLogMode"in J&&typeof J.linLogMode!=="boolean")return{message:"the `linLogMode` setting should be a boolean."};if("outboundAttractionDistribution"in J&&typeof J.outboundAttractionDistribution!=="boolean")return{message:"the `outboundAttractionDistribution` setting should be a boolean."};if("adjustSizes"in J&&typeof J.adjustSizes!=="boolean")return{message:"the `adjustSizes` setting should be a boolean."};if("edgeWeightInfluence"in J&&typeof J.edgeWeightInfluence!=="number")return{message:"the `edgeWeightInfluence` setting should be a number."};if("scalingRatio"in J&&!(typeof J.scalingRatio==="number"&&J.scalingRatio>=0))return{message:"the `scalingRatio` setting should be a number >= 0."};if("strongGravityMode"in J&&typeof J.strongGravityMode!=="boolean")return{message:"the `strongGravityMode` setting should be a boolean."};if("gravity"in J&&!(typeof J.gravity==="number"&&J.gravity>=0))return{message:"the `gravity` setting should be a number >= 0."};if("slowDown"in J&&!(typeof J.slowDown==="number"||J.slowDown>=0))return{message:"the `slowDown` setting should be a number >= 0."};if("barnesHutOptimize"in J&&typeof J.barnesHutOptimize!=="boolean")return{message:"the `barnesHutOptimize` setting should be a boolean."};if("barnesHutTheta"in J&&!(typeof J.barnesHutTheta==="number"&&J.barnesHutTheta>=0))return{message:"the `barnesHutTheta` setting should be a number >= 0."};return null};V9.graphToByteArrays=function(J,K){var{order:Q,size:Z}=J,q={},W,V=new Float32Array(Q*i0),z=new Float32Array(Z*OQ);return W=0,J.forEachNode(function(B,H){q[B]=W,V[W]=H.x,V[W+1]=H.y,V[W+2]=0,V[W+3]=0,V[W+4]=0,V[W+5]=0,V[W+6]=1,V[W+7]=1,V[W+8]=H.size||1,V[W+9]=H.fixed?1:0,W+=i0}),W=0,J.forEachEdge(function(B,H,Y,$,X,j,w){var L=q[Y],A=q[$],G=K(B,H,Y,$,X,j,w);V[L+6]+=G,V[A+6]+=G,z[W]=L,z[W+1]=A,z[W+2]=G,W+=OQ}),{nodes:V,edges:z}};V9.assignLayoutChanges=function(J,K,Q){var Z=0;J.updateEachNodeAttributes(function(q,W){return W.x=K[Z],W.y=K[Z+1],Z+=i0,Q?Q(q,W):W})};V9.readGraphPositions=function(J,K){var Q=0;J.forEachNode(function(Z,q){K[Q]=q.x,K[Q+1]=q.y,Q+=i0})};V9.collectLayoutChanges=function(J,K,Q){var Z=J.nodes(),q={};for(var W=0,V=0,z=K.length;W<z;W+=i0){if(Q){var B=Object.assign({},J.getNodeAttributes(Z[V]));B.x=K[W],B.y=K[W+1],B=Q(Z[V],B),q[Z[V]]={x:B.x,y:B.y}}else q[Z[V]]={x:K[W],y:K[W+1]};V++}return q};V9.createWorker=function(K){var Q=window.URL||window.webkitURL,Z=K.toString(),q=Q.createObjectURL(new Blob(["("+Z+").call(this);"],{type:"text/javascript"})),W=new Worker(q);return Q.revokeObjectURL(q),W}});var bQ=E0((s8,MQ)=>{MQ.exports={linLogMode:!1,outboundAttractionDistribution:!1,adjustSizes:!1,edgeWeightInfluence:1,scalingRatio:1,strongGravityMode:!1,gravity:1,slowDown:1,barnesHutOptimize:!1,barnesHutTheta:0.5}});var xQ=E0((n8,yQ)=>{var U9=qJ(),w9=IQ().createEdgeWeightGetter,F9=GQ(),o0=fQ(),L9=bQ();function NQ(J,K,Q){if(!U9(K))throw Error("graphology-layout-forceatlas2: the given graph is not a valid graphology instance.");if(typeof Q==="number")Q={iterations:Q};var Z=Q.iterations;if(typeof Z!=="number")throw Error("graphology-layout-forceatlas2: invalid number of iterations.");if(Z<=0)throw Error("graphology-layout-forceatlas2: you should provide a positive number of iterations.");var q=w9("getEdgeWeight"in Q?Q.getEdgeWeight:"weight").fromEntry,W=typeof Q.outputReducer==="function"?Q.outputReducer:null,V=o0.assign({},L9,Q.settings),z=o0.validateSettings(V);if(z)throw Error("graphology-layout-forceatlas2: "+z.message);var B=o0.graphToByteArrays(K,q),H;for(H=0;H<Z;H++)F9(V,B.nodes,B.edges);if(J){o0.assignLayoutChanges(K,B.nodes,W);return}return o0.collectLayoutChanges(K,B.nodes)}function T9(J){var K=typeof J==="number"?J:J.order;return{barnesHutOptimize:K>2000,strongGravityMode:!0,gravity:0.05,scalingRatio:10,slowDown:1+Math.log(K)}}var yJ=NQ.bind(null,!1);yJ.assign=NQ.bind(null,!0);yJ.inferSettings=T9;yQ.exports=yJ});var CJ=Symbol.for,O0=Symbol("kCapture"),KQ=CJ("events.errorMonitor"),M6=Symbol("events.maxEventTargetListeners"),b6=Symbol("events.maxEventTargetListenersWarned"),JQ=CJ("nodejs.rejection"),N6=CJ("nodejs.rejection"),QQ=Array.prototype.slice,f0=10,w0=function(J){if(this._events===void 0||this._events===this.__proto__._events)this._events={__proto__:null},this._eventsCount=0;if(this._maxListeners??=void 0,this[O0]=J?.captureRejections?Boolean(J?.captureRejections):D[O0])this.emit=D6},D=w0.prototype={};D._events=void 0;D._eventsCount=0;D._maxListeners=void 0;D.setMaxListeners=function(J){return PJ(J,"setMaxListeners",0),this._maxListeners=J,this};D.constructor=w0;D.getMaxListeners=function(){return this?._maxListeners??f0};function qQ(J,K){var{_events:Q}=J;if(K[0]??=Error("Unhandled error."),!Q)throw K[0];var Z=Q[KQ];if(Z)for(var q of QQ.call(Z))q.apply(J,K);var W=Q.error;if(!W)throw K[0];for(var q of QQ.call(W))q.apply(J,K);return!0}function y6(J,K,Q,Z){K.then(void 0,function(q){queueMicrotask(()=>x6(J,q,Q,Z))})}function x6(J,K,Q,Z){if(typeof J[JQ]==="function")J[JQ](K,Q,...Z);else try{J[O0]=!1,J.emit("error",K)}finally{J[O0]=!0}}var E6=function(J,...K){if(J==="error")return qQ(this,K);var{_events:Q}=this;if(Q===void 0)return!1;var Z=Q[J];if(Z===void 0)return!1;let q=Z.length>1?Z.slice():Z;for(let W=0,{length:V}=q;W<V;W++){let z=q[W];switch(K.length){case 0:z.call(this);break;case 1:z.call(this,K[0]);break;case 2:z.call(this,K[0],K[1]);break;case 3:z.call(this,K[0],K[1],K[2]);break;default:z.apply(this,K);break}}return!0},D6=function(J,...K){if(J==="error")return qQ(this,K);var{_events:Q}=this;if(Q===void 0)return!1;var Z=Q[J];if(Z===void 0)return!1;let q=Z.length>1?Z.slice():Z;for(let W=0,{length:V}=q;W<V;W++){let z=q[W],B;switch(K.length){case 0:B=z.call(this);break;case 1:B=z.call(this,K[0]);break;case 2:B=z.call(this,K[0],K[1]);break;case 3:B=z.call(this,K[0],K[1],K[2]);break;default:B=z.apply(this,K);break}if(B!==void 0&&typeof B?.then==="function"&&B.then===Promise.prototype.then)y6(this,B,J,K)}return!0};D.emit=E6;D.addListener=function(J,K){s0(K);var Q=this._events;if(!Q)Q=this._events={__proto__:null},this._eventsCount=0;else if(Q.newListener)this.emit("newListener",J,K.listener??K);var Z=Q[J];if(!Z)Q[J]=[K],this._eventsCount++;else{Z.push(K);var q=this._maxListeners??f0;if(q>0&&Z.length>q&&!Z.warned)WQ(this,J,Z)}return this};D.on=D.addListener;D.prependListener=function(J,K){s0(K);var Q=this._events;if(!Q)Q=this._events={__proto__:null},this._eventsCount=0;else if(Q.newListener)this.emit("newListener",J,K.listener??K);var Z=Q[J];if(!Z)Q[J]=[K],this._eventsCount++;else{Z.unshift(K);var q=this._maxListeners??f0;if(q>0&&Z.length>q&&!Z.warned)WQ(this,J,Z)}return this};function WQ(J,K,Q){Q.warned=!0;let Z=Error(`Possible EventEmitter memory leak detected. ${Q.length} ${String(K)} listeners added to [${J.constructor.name}]. Use emitter.setMaxListeners() to increase limit`);Z.name="MaxListenersExceededWarning",Z.emitter=J,Z.type=K,Z.count=Q.length,console.warn(Z)}function VQ(J,K,...Q){this.removeListener(J,K),K.apply(this,Q)}D.once=function(J,K){s0(K);let Q=VQ.bind(this,J,K);return Q.listener=K,this.addListener(J,Q),this};D.prependOnceListener=function(J,K){s0(K);let Q=VQ.bind(this,J,K);return Q.listener=K,this.prependListener(J,Q),this};D.removeListener=function(J,K){s0(K);var{_events:Q}=this;if(!Q)return this;var Z=Q[J];if(!Z)return this;var q=Z.length;let W=-1;for(let V=q-1;V>=0;V--)if(Z[V]===K||Z[V].listener===K){W=V;break}if(W<0)return this;if(W===0)Z.shift();else Z.splice(W,1);if(Z.length===0)delete Q[J],this._eventsCount--;return this};D.off=D.removeListener;D.removeAllListeners=function(J){var{_events:K}=this;if(J&&K){if(K[J])delete K[J],this._eventsCount--}else this._events={__proto__:null};return this};D.listeners=function(J){var{_events:K}=this;if(!K)return[];var Q=K[J];if(!Q)return[];return Q.map((Z)=>Z.listener??Z)};D.rawListeners=function(J){var{_events:K}=this;if(!K)return[];var Q=K[J];if(!Q)return[];return Q.slice()};D.listenerCount=function(J){var{_events:K}=this;if(!K)return 0;return K[J]?.length??0};D.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};D[O0]=!1;function _6(J,K,Q){var Z=Q?.signal;if(zQ(Z,"options.signal"),Z?.aborted)throw new AJ(void 0,{cause:Z?.reason});let{resolve:q,reject:W,promise:V}=$newPromiseCapability(Promise),z=(Y)=>{if(J.removeListener(K,B),Z!=null)JJ(Z,"abort",H);W(Y)},B=(...Y)=>{if(typeof J.removeListener==="function")J.removeListener("error",z);if(Z!=null)JJ(Z,"abort",H);q(Y)};if(ZQ(J,K,B,{once:!0}),K!=="error"&&typeof J.once==="function")J.once("error",z);function H(){JJ(J,K,B),JJ(J,"error",z),W(new AJ(void 0,{cause:Z?.reason}))}if(Z!=null)ZQ(Z,"abort",H,{once:!0});return V}function u6(J,K){return J.listeners(K)}function h6(J,...K){PJ(J,"setMaxListeners",0);var Q;if(K&&(Q=K.length))for(let Z=0;Z<Q;Z++)K[Z].setMaxListeners(J);else f0=J}function m6(J,K){return J.listenerCount(K)}function JJ(J,K,Q,Z){if(typeof J.removeListener==="function")J.removeListener(K,Q);else J.removeEventListener(K,Q,Z)}function ZQ(J,K,Q,Z){if(typeof J.on==="function")if(Z.once)J.once(K,Q);else J.on(K,Q);else J.addEventListener(K,Q,Z)}class AJ extends Error{constructor(J="The operation was aborted",K=void 0){if(K!==void 0&&typeof K!=="object")throw D0("options","Object",K);super(J,K);this.code="ABORT_ERR",this.name="AbortError"}}function D0(J,K,Q){let Z=TypeError(`The "${J}" argument must be of type ${K}. Received ${Q}`);return Z.code="ERR_INVALID_ARG_TYPE",Z}function c6(J,K,Q){let Z=RangeError(`The "${J}" argument is out of range. It must be ${K}. Received ${Q}`);return Z.code="ERR_OUT_OF_RANGE",Z}function zQ(J,K){if(J!==void 0&&(J===null||typeof J!=="object"||!("aborted"in J)))throw D0(K,"AbortSignal",J)}function PJ(J,K,Q,Z){if(typeof J!=="number")throw D0(K,"number",J);if(Q!=null&&J<Q||Z!=null&&J>Z||(Q!=null||Z!=null)&&Number.isNaN(J))throw c6(K,`${Q!=null?`>= ${Q}`:""}${Q!=null&&Z!=null?" && ":""}${Z!=null?`<= ${Z}`:""}`,J)}function s0(J){if(typeof J!=="function")throw TypeError("The listener must be a function")}function l6(J,K){if(typeof J!=="boolean")throw D0(K,"boolean",J)}function p6(J){return J?._maxListeners??f0}function g6(J,K){if(J===void 0)throw D0("signal","AbortSignal",J);if(zQ(J,"signal"),typeof K!=="function")throw D0("listener","function",K);let Q;if(J.aborted)queueMicrotask(()=>K());else J.addEventListener("abort",K,{__proto__:null,once:!0}),Q=()=>{J.removeEventListener("abort",K)};return{__proto__:null,[Symbol.dispose](){Q?.()}}}Object.defineProperties(w0,{captureRejections:{get(){return D[O0]},set(J){l6(J,"EventEmitter.captureRejections"),D[O0]=J},enumerable:!0},defaultMaxListeners:{enumerable:!0,get:()=>{return f0},set:(J)=>{PJ(J,"defaultMaxListeners",0),f0=J}},kMaxEventTargetListeners:{value:M6,enumerable:!1,configurable:!1,writable:!1},kMaxEventTargetListenersWarned:{value:b6,enumerable:!1,configurable:!1,writable:!1}});Object.assign(w0,{once:_6,getEventListeners:u6,getMaxListeners:p6,setMaxListeners:h6,EventEmitter:w0,usingDomains:!1,captureRejectionSymbol:N6,errorMonitor:KQ,addAbortListener:g6,init:w0,listenerCount:m6});function s6(){let J=arguments[0];for(let K=1,Q=arguments.length;K<Q;K++){if(!arguments[K])continue;for(let Z in arguments[K])J[Z]=arguments[K][Z]}return J}var p=s6;if(typeof Object.assign==="function")p=Object.assign;function z0(J,K,Q,Z){let q=J._nodes.get(K),W=null;if(!q)return W;if(Z==="mixed")W=q.out&&q.out[Q]||q.undirected&&q.undirected[Q];else if(Z==="directed")W=q.out&&q.out[Q];else W=q.undirected&&q.undirected[Q];return W}function i(J){return typeof J==="object"&&J!==null}function YQ(J){let K;for(K in J)return!1;return!0}function V0(J,K,Q){Object.defineProperty(J,K,{enumerable:!1,configurable:!1,writable:!0,value:Q})}function X0(J,K,Q){let Z={enumerable:!0,configurable:!0};if(typeof Q==="function")Z.get=Q;else Z.value=Q,Z.writable=!1;Object.defineProperty(J,K,Z)}function BQ(J){if(!i(J))return!1;if(J.attributes&&!Array.isArray(J.attributes))return!1;return!0}function n6(){let J=Math.floor(Math.random()*256)&255;return()=>{return J++}}function A0(){let J=arguments,K=null,Q=-1;return{[Symbol.iterator](){return this},next(){let Z=null;do{if(K===null){if(Q++,Q>=J.length)return{done:!0};K=J[Q][Symbol.iterator]()}if(Z=K.next(),Z.done){K=null;continue}break}while(!0);return Z}}}function u0(){return{[Symbol.iterator](){return this},next(){return{done:!0}}}}class ZJ extends Error{constructor(J){super();this.name="GraphError",this.message=J}}class S extends ZJ{constructor(J){super(J);if(this.name="InvalidArgumentsGraphError",typeof Error.captureStackTrace==="function")Error.captureStackTrace(this,S.prototype.constructor)}}class C extends ZJ{constructor(J){super(J);if(this.name="NotFoundGraphError",typeof Error.captureStackTrace==="function")Error.captureStackTrace(this,C.prototype.constructor)}}class f extends ZJ{constructor(J){super(J);if(this.name="UsageGraphError",typeof Error.captureStackTrace==="function")Error.captureStackTrace(this,f.prototype.constructor)}}function XQ(J,K){this.key=J,this.attributes=K,this.clear()}XQ.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.undirectedDegree=0,this.undirectedLoops=0,this.directedLoops=0,this.in={},this.out={},this.undirected={}};function jQ(J,K){this.key=J,this.attributes=K,this.clear()}jQ.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.directedLoops=0,this.in={},this.out={}};function UQ(J,K){this.key=J,this.attributes=K,this.clear()}UQ.prototype.clear=function(){this.undirectedDegree=0,this.undirectedLoops=0,this.undirected={}};function h0(J,K,Q,Z,q){this.key=K,this.attributes=q,this.undirected=J,this.source=Q,this.target=Z}h0.prototype.attach=function(){let J="out",K="in";if(this.undirected)J=K="undirected";let Q=this.source.key,Z=this.target.key;if(this.source[J][Z]=this,this.undirected&&Q===Z)return;this.target[K][Q]=this};h0.prototype.attachMulti=function(){let J="out",K="in",Q=this.source.key,Z=this.target.key;if(this.undirected)J=K="undirected";let q=this.source[J],W=q[Z];if(typeof W>"u"){if(q[Z]=this,!(this.undirected&&Q===Z))this.target[K][Q]=this;return}W.previous=this,this.next=W,q[Z]=this,this.target[K][Q]=this};h0.prototype.detach=function(){let J=this.source.key,K=this.target.key,Q="out",Z="in";if(this.undirected)Q=Z="undirected";delete this.source[Q][K],delete this.target[Z][J]};h0.prototype.detachMulti=function(){let J=this.source.key,K=this.target.key,Q="out",Z="in";if(this.undirected)Q=Z="undirected";if(this.previous===void 0)if(this.next===void 0)delete this.source[Q][K],delete this.target[Z][J];else this.next.previous=void 0,this.source[Q][K]=this.next,this.target[Z][J]=this.next;else if(this.previous.next=this.next,this.next!==void 0)this.next.previous=this.previous};var wQ=0,FQ=1,d6=2,LQ=3;function C0(J,K,Q,Z,q,W,V){let z,B,H,Y;if(Z=""+Z,Q===wQ){if(z=J._nodes.get(Z),!z)throw new C(`Graph.${K}: could not find the "${Z}" node in the graph.`);H=q,Y=W}else if(Q===LQ){if(q=""+q,B=J._edges.get(q),!B)throw new C(`Graph.${K}: could not find the "${q}" edge in the graph.`);let $=B.source.key,X=B.target.key;if(Z===$)z=B.target;else if(Z===X)z=B.source;else throw new C(`Graph.${K}: the "${Z}" node is not attached to the "${q}" edge (${$}, ${X}).`);H=W,Y=V}else{if(B=J._edges.get(Z),!B)throw new C(`Graph.${K}: could not find the "${Z}" edge in the graph.`);if(Q===FQ)z=B.source;else z=B.target;H=q,Y=W}return[z,H,Y]}function i6(J,K,Q){J.prototype[K]=function(Z,q,W){let[V,z]=C0(this,K,Q,Z,q,W);return V.attributes[z]}}function o6(J,K,Q){J.prototype[K]=function(Z,q){let[W]=C0(this,K,Q,Z,q);return W.attributes}}function r6(J,K,Q){J.prototype[K]=function(Z,q,W){let[V,z]=C0(this,K,Q,Z,q,W);return V.attributes.hasOwnProperty(z)}}function a6(J,K,Q){J.prototype[K]=function(Z,q,W,V){let[z,B,H]=C0(this,K,Q,Z,q,W,V);return z.attributes[B]=H,this.emit("nodeAttributesUpdated",{key:z.key,type:"set",attributes:z.attributes,name:B}),this}}function t6(J,K,Q){J.prototype[K]=function(Z,q,W,V){let[z,B,H]=C0(this,K,Q,Z,q,W,V);if(typeof H!=="function")throw new S(`Graph.${K}: updater should be a function.`);let Y=z.attributes,$=H(Y[B]);return Y[B]=$,this.emit("nodeAttributesUpdated",{key:z.key,type:"set",attributes:z.attributes,name:B}),this}}function e6(J,K,Q){J.prototype[K]=function(Z,q,W){let[V,z]=C0(this,K,Q,Z,q,W);return delete V.attributes[z],this.emit("nodeAttributesUpdated",{key:V.key,type:"remove",attributes:V.attributes,name:z}),this}}function J7(J,K,Q){J.prototype[K]=function(Z,q,W){let[V,z]=C0(this,K,Q,Z,q,W);if(!i(z))throw new S(`Graph.${K}: provided attributes are not a plain object.`);return V.attributes=z,this.emit("nodeAttributesUpdated",{key:V.key,type:"replace",attributes:V.attributes}),this}}function Q7(J,K,Q){J.prototype[K]=function(Z,q,W){let[V,z]=C0(this,K,Q,Z,q,W);if(!i(z))throw new S(`Graph.${K}: provided attributes are not a plain object.`);return p(V.attributes,z),this.emit("nodeAttributesUpdated",{key:V.key,type:"merge",attributes:V.attributes,data:z}),this}}function Z7(J,K,Q){J.prototype[K]=function(Z,q,W){let[V,z]=C0(this,K,Q,Z,q,W);if(typeof z!=="function")throw new S(`Graph.${K}: provided updater is not a function.`);return V.attributes=z(V.attributes),this.emit("nodeAttributesUpdated",{key:V.key,type:"update",attributes:V.attributes}),this}}var K7=[{name:(J)=>`get${J}Attribute`,attacher:i6},{name:(J)=>`get${J}Attributes`,attacher:o6},{name:(J)=>`has${J}Attribute`,attacher:r6},{name:(J)=>`set${J}Attribute`,attacher:a6},{name:(J)=>`update${J}Attribute`,attacher:t6},{name:(J)=>`remove${J}Attribute`,attacher:e6},{name:(J)=>`replace${J}Attributes`,attacher:J7},{name:(J)=>`merge${J}Attributes`,attacher:Q7},{name:(J)=>`update${J}Attributes`,attacher:Z7}];function q7(J){K7.forEach(function({name:K,attacher:Q}){Q(J,K("Node"),wQ),Q(J,K("Source"),FQ),Q(J,K("Target"),d6),Q(J,K("Opposite"),LQ)})}function W7(J,K,Q){J.prototype[K]=function(Z,q){let W;if(this.type!=="mixed"&&Q!=="mixed"&&Q!==this.type)throw new f(`Graph.${K}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new f(`Graph.${K}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);let V=""+Z,z=""+q;if(q=arguments[2],W=z0(this,V,z,Q),!W)throw new C(`Graph.${K}: could not find an edge for the given path ("${V}" - "${z}").`)}else{if(Q!=="mixed")throw new f(`Graph.${K}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(Z=""+Z,W=this._edges.get(Z),!W)throw new C(`Graph.${K}: could not find the "${Z}" edge in the graph.`)}return W.attributes[q]}}function V7(J,K,Q){J.prototype[K]=function(Z){let q;if(this.type!=="mixed"&&Q!=="mixed"&&Q!==this.type)throw new f(`Graph.${K}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>1){if(this.multi)throw new f(`Graph.${K}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);let W=""+Z,V=""+arguments[1];if(q=z0(this,W,V,Q),!q)throw new C(`Graph.${K}: could not find an edge for the given path ("${W}" - "${V}").`)}else{if(Q!=="mixed")throw new f(`Graph.${K}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(Z=""+Z,q=this._edges.get(Z),!q)throw new C(`Graph.${K}: could not find the "${Z}" edge in the graph.`)}return q.attributes}}function z7(J,K,Q){J.prototype[K]=function(Z,q){let W;if(this.type!=="mixed"&&Q!=="mixed"&&Q!==this.type)throw new f(`Graph.${K}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new f(`Graph.${K}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);let V=""+Z,z=""+q;if(q=arguments[2],W=z0(this,V,z,Q),!W)throw new C(`Graph.${K}: could not find an edge for the given path ("${V}" - "${z}").`)}else{if(Q!=="mixed")throw new f(`Graph.${K}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(Z=""+Z,W=this._edges.get(Z),!W)throw new C(`Graph.${K}: could not find the "${Z}" edge in the graph.`)}return W.attributes.hasOwnProperty(q)}}function B7(J,K,Q){J.prototype[K]=function(Z,q,W){let V;if(this.type!=="mixed"&&Q!=="mixed"&&Q!==this.type)throw new f(`Graph.${K}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new f(`Graph.${K}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);let z=""+Z,B=""+q;if(q=arguments[2],W=arguments[3],V=z0(this,z,B,Q),!V)throw new C(`Graph.${K}: could not find an edge for the given path ("${z}" - "${B}").`)}else{if(Q!=="mixed")throw new f(`Graph.${K}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(Z=""+Z,V=this._edges.get(Z),!V)throw new C(`Graph.${K}: could not find the "${Z}" edge in the graph.`)}return V.attributes[q]=W,this.emit("edgeAttributesUpdated",{key:V.key,type:"set",attributes:V.attributes,name:q}),this}}function H7(J,K,Q){J.prototype[K]=function(Z,q,W){let V;if(this.type!=="mixed"&&Q!=="mixed"&&Q!==this.type)throw new f(`Graph.${K}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new f(`Graph.${K}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);let z=""+Z,B=""+q;if(q=arguments[2],W=arguments[3],V=z0(this,z,B,Q),!V)throw new C(`Graph.${K}: could not find an edge for the given path ("${z}" - "${B}").`)}else{if(Q!=="mixed")throw new f(`Graph.${K}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(Z=""+Z,V=this._edges.get(Z),!V)throw new C(`Graph.${K}: could not find the "${Z}" edge in the graph.`)}if(typeof W!=="function")throw new S(`Graph.${K}: updater should be a function.`);return V.attributes[q]=W(V.attributes[q]),this.emit("edgeAttributesUpdated",{key:V.key,type:"set",attributes:V.attributes,name:q}),this}}function $7(J,K,Q){J.prototype[K]=function(Z,q){let W;if(this.type!=="mixed"&&Q!=="mixed"&&Q!==this.type)throw new f(`Graph.${K}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new f(`Graph.${K}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);let V=""+Z,z=""+q;if(q=arguments[2],W=z0(this,V,z,Q),!W)throw new C(`Graph.${K}: could not find an edge for the given path ("${V}" - "${z}").`)}else{if(Q!=="mixed")throw new f(`Graph.${K}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(Z=""+Z,W=this._edges.get(Z),!W)throw new C(`Graph.${K}: could not find the "${Z}" edge in the graph.`)}return delete W.attributes[q],this.emit("edgeAttributesUpdated",{key:W.key,type:"remove",attributes:W.attributes,name:q}),this}}function Y7(J,K,Q){J.prototype[K]=function(Z,q){let W;if(this.type!=="mixed"&&Q!=="mixed"&&Q!==this.type)throw new f(`Graph.${K}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new f(`Graph.${K}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);let V=""+Z,z=""+q;if(q=arguments[2],W=z0(this,V,z,Q),!W)throw new C(`Graph.${K}: could not find an edge for the given path ("${V}" - "${z}").`)}else{if(Q!=="mixed")throw new f(`Graph.${K}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(Z=""+Z,W=this._edges.get(Z),!W)throw new C(`Graph.${K}: could not find the "${Z}" edge in the graph.`)}if(!i(q))throw new S(`Graph.${K}: provided attributes are not a plain object.`);return W.attributes=q,this.emit("edgeAttributesUpdated",{key:W.key,type:"replace",attributes:W.attributes}),this}}function X7(J,K,Q){J.prototype[K]=function(Z,q){let W;if(this.type!=="mixed"&&Q!=="mixed"&&Q!==this.type)throw new f(`Graph.${K}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new f(`Graph.${K}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);let V=""+Z,z=""+q;if(q=arguments[2],W=z0(this,V,z,Q),!W)throw new C(`Graph.${K}: could not find an edge for the given path ("${V}" - "${z}").`)}else{if(Q!=="mixed")throw new f(`Graph.${K}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(Z=""+Z,W=this._edges.get(Z),!W)throw new C(`Graph.${K}: could not find the "${Z}" edge in the graph.`)}if(!i(q))throw new S(`Graph.${K}: provided attributes are not a plain object.`);return p(W.attributes,q),this.emit("edgeAttributesUpdated",{key:W.key,type:"merge",attributes:W.attributes,data:q}),this}}function j7(J,K,Q){J.prototype[K]=function(Z,q){let W;if(this.type!=="mixed"&&Q!=="mixed"&&Q!==this.type)throw new f(`Graph.${K}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new f(`Graph.${K}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);let V=""+Z,z=""+q;if(q=arguments[2],W=z0(this,V,z,Q),!W)throw new C(`Graph.${K}: could not find an edge for the given path ("${V}" - "${z}").`)}else{if(Q!=="mixed")throw new f(`Graph.${K}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(Z=""+Z,W=this._edges.get(Z),!W)throw new C(`Graph.${K}: could not find the "${Z}" edge in the graph.`)}if(typeof q!=="function")throw new S(`Graph.${K}: provided updater is not a function.`);return W.attributes=q(W.attributes),this.emit("edgeAttributesUpdated",{key:W.key,type:"update",attributes:W.attributes}),this}}var U7=[{name:(J)=>`get${J}Attribute`,attacher:W7},{name:(J)=>`get${J}Attributes`,attacher:V7},{name:(J)=>`has${J}Attribute`,attacher:z7},{name:(J)=>`set${J}Attribute`,attacher:B7},{name:(J)=>`update${J}Attribute`,attacher:H7},{name:(J)=>`remove${J}Attribute`,attacher:$7},{name:(J)=>`replace${J}Attributes`,attacher:Y7},{name:(J)=>`merge${J}Attributes`,attacher:X7},{name:(J)=>`update${J}Attributes`,attacher:j7}];function w7(J){U7.forEach(function({name:K,attacher:Q}){Q(J,K("Edge"),"mixed"),Q(J,K("DirectedEdge"),"directed"),Q(J,K("UndirectedEdge"),"undirected")})}var F7=[{name:"edges",type:"mixed"},{name:"inEdges",type:"directed",direction:"in"},{name:"outEdges",type:"directed",direction:"out"},{name:"inboundEdges",type:"mixed",direction:"in"},{name:"outboundEdges",type:"mixed",direction:"out"},{name:"directedEdges",type:"directed"},{name:"undirectedEdges",type:"undirected"}];function L7(J,K,Q,Z){let q=!1;for(let W in K){if(W===Z)continue;let V=K[W];if(q=Q(V.key,V.attributes,V.source.key,V.target.key,V.source.attributes,V.target.attributes,V.undirected),J&&q)return V.key}return}function T7(J,K,Q,Z){let q,W,V,z=!1;for(let B in K){if(B===Z)continue;q=K[B];do{if(W=q.source,V=q.target,z=Q(q.key,q.attributes,W.key,V.key,W.attributes,V.attributes,q.undirected),J&&z)return q.key;q=q.next}while(q!==void 0)}return}function IJ(J,K){let Q=Object.keys(J),Z=Q.length,q,W=0;return{[Symbol.iterator](){return this},next(){do if(!q){if(W>=Z)return{done:!0};let V=Q[W++];if(V===K){q=void 0;continue}q=J[V]}else q=q.next;while(!q);return{done:!1,value:{edge:q.key,attributes:q.attributes,source:q.source.key,target:q.target.key,sourceAttributes:q.source.attributes,targetAttributes:q.target.attributes,undirected:q.undirected}}}}}function A7(J,K,Q,Z){let q=K[Q];if(!q)return;let{source:W,target:V}=q;if(Z(q.key,q.attributes,W.key,V.key,W.attributes,V.attributes,q.undirected)&&J)return q.key}function C7(J,K,Q,Z){let q=K[Q];if(!q)return;let W=!1;do{if(W=Z(q.key,q.attributes,q.source.key,q.target.key,q.source.attributes,q.target.attributes,q.undirected),J&&W)return q.key;q=q.next}while(q!==void 0);return}function kJ(J,K){let Q=J[K];if(Q.next!==void 0)return{[Symbol.iterator](){return this},next(){if(!Q)return{done:!0};let q={edge:Q.key,attributes:Q.attributes,source:Q.source.key,target:Q.target.key,sourceAttributes:Q.source.attributes,targetAttributes:Q.target.attributes,undirected:Q.undirected};return Q=Q.next,{done:!1,value:q}}};let Z=!1;return{[Symbol.iterator](){return this},next(){if(Z===!0)return{done:!0};return Z=!0,{done:!1,value:{edge:Q.key,attributes:Q.attributes,source:Q.source.key,target:Q.target.key,sourceAttributes:Q.source.attributes,targetAttributes:Q.target.attributes,undirected:Q.undirected}}}}}function P7(J,K){if(J.size===0)return[];if(K==="mixed"||K===J.type)return Array.from(J._edges.keys());let Q=K==="undirected"?J.undirectedSize:J.directedSize,Z=Array(Q),q=K==="undirected",W=J._edges.values(),V=0,z,B;while(z=W.next(),z.done!==!0)if(B=z.value,B.undirected===q)Z[V++]=B.key;return Z}function TQ(J,K,Q,Z){if(K.size===0)return;let q=Q!=="mixed"&&Q!==K.type,W=Q==="undirected",V,z,B=!1,H=K._edges.values();while(V=H.next(),V.done!==!0){if(z=V.value,q&&z.undirected!==W)continue;let{key:Y,attributes:$,source:X,target:j}=z;if(B=Z(Y,$,X.key,j.key,X.attributes,j.attributes,z.undirected),J&&B)return Y}return}function I7(J,K){if(J.size===0)return u0();let Q=K!=="mixed"&&K!==J.type,Z=K==="undirected",q=J._edges.values();return{[Symbol.iterator](){return this},next(){let W,V;while(!0){if(W=q.next(),W.done)return W;if(V=W.value,Q&&V.undirected!==Z)continue;break}return{value:{edge:V.key,attributes:V.attributes,source:V.source.key,target:V.target.key,sourceAttributes:V.source.attributes,targetAttributes:V.target.attributes,undirected:V.undirected},done:!1}}}}function SJ(J,K,Q,Z,q,W){let V=K?T7:L7,z;if(Q!=="undirected"){if(Z!=="out"){if(z=V(J,q.in,W),J&&z)return z}if(Z!=="in"){if(z=V(J,q.out,W,!Z?q.key:void 0),J&&z)return z}}if(Q!=="directed"){if(z=V(J,q.undirected,W),J&&z)return z}return}function k7(J,K,Q,Z){let q=[];return SJ(!1,J,K,Q,Z,function(W){q.push(W)}),q}function S7(J,K,Q){let Z=u0();if(J!=="undirected"){if(K!=="out"&&typeof Q.in<"u")Z=A0(Z,IJ(Q.in));if(K!=="in"&&typeof Q.out<"u")Z=A0(Z,IJ(Q.out,!K?Q.key:void 0))}if(J!=="directed"&&typeof Q.undirected<"u")Z=A0(Z,IJ(Q.undirected));return Z}function RJ(J,K,Q,Z,q,W,V){let z=Q?C7:A7,B;if(K!=="undirected"){if(typeof q.in<"u"&&Z!=="out"){if(B=z(J,q.in,W,V),J&&B)return B}if(typeof q.out<"u"&&Z!=="in"&&(Z||q.key!==W)){if(B=z(J,q.out,W,V),J&&B)return B}}if(K!=="directed"){if(typeof q.undirected<"u"){if(B=z(J,q.undirected,W,V),J&&B)return B}}return}function R7(J,K,Q,Z,q){let W=[];return RJ(!1,J,K,Q,Z,q,function(V){W.push(V)}),W}function v7(J,K,Q,Z){let q=u0();if(J!=="undirected"){if(typeof Q.in<"u"&&K!=="out"&&Z in Q.in)q=A0(q,kJ(Q.in,Z));if(typeof Q.out<"u"&&K!=="in"&&Z in Q.out&&(K||Q.key!==Z))q=A0(q,kJ(Q.out,Z))}if(J!=="directed"){if(typeof Q.undirected<"u"&&Z in Q.undirected)q=A0(q,kJ(Q.undirected,Z))}return q}function G7(J,K){let{name:Q,type:Z,direction:q}=K;J.prototype[Q]=function(W,V){if(Z!=="mixed"&&this.type!=="mixed"&&Z!==this.type)return[];if(!arguments.length)return P7(this,Z);if(arguments.length===1){W=""+W;let z=this._nodes.get(W);if(typeof z>"u")throw new C(`Graph.${Q}: could not find the "${W}" node in the graph.`);return k7(this.multi,Z==="mixed"?this.type:Z,q,z)}if(arguments.length===2){W=""+W,V=""+V;let z=this._nodes.get(W);if(!z)throw new C(`Graph.${Q}:  could not find the "${W}" source node in the graph.`);if(!this._nodes.has(V))throw new C(`Graph.${Q}:  could not find the "${V}" target node in the graph.`);return R7(Z,this.multi,q,z,V)}throw new S(`Graph.${Q}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function O7(J,K){let{name:Q,type:Z,direction:q}=K,W="forEach"+Q[0].toUpperCase()+Q.slice(1,-1);J.prototype[W]=function(H,Y,$){if(Z!=="mixed"&&this.type!=="mixed"&&Z!==this.type)return;if(arguments.length===1)return $=H,TQ(!1,this,Z,$);if(arguments.length===2){H=""+H,$=Y;let X=this._nodes.get(H);if(typeof X>"u")throw new C(`Graph.${W}: could not find the "${H}" node in the graph.`);return SJ(!1,this.multi,Z==="mixed"?this.type:Z,q,X,$)}if(arguments.length===3){H=""+H,Y=""+Y;let X=this._nodes.get(H);if(!X)throw new C(`Graph.${W}:  could not find the "${H}" source node in the graph.`);if(!this._nodes.has(Y))throw new C(`Graph.${W}:  could not find the "${Y}" target node in the graph.`);return RJ(!1,Z,this.multi,q,X,Y,$)}throw new S(`Graph.${W}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)};let V="map"+Q[0].toUpperCase()+Q.slice(1);J.prototype[V]=function(){let H=Array.prototype.slice.call(arguments),Y=H.pop(),$;if(H.length===0){let X=0;if(Z!=="directed")X+=this.undirectedSize;if(Z!=="undirected")X+=this.directedSize;$=Array(X);let j=0;H.push((w,L,A,G,k,T,P)=>{$[j++]=Y(w,L,A,G,k,T,P)})}else $=[],H.push((X,j,w,L,A,G,k)=>{$.push(Y(X,j,w,L,A,G,k))});return this[W].apply(this,H),$};let z="filter"+Q[0].toUpperCase()+Q.slice(1);J.prototype[z]=function(){let H=Array.prototype.slice.call(arguments),Y=H.pop(),$=[];return H.push((X,j,w,L,A,G,k)=>{if(Y(X,j,w,L,A,G,k))$.push(X)}),this[W].apply(this,H),$};let B="reduce"+Q[0].toUpperCase()+Q.slice(1);J.prototype[B]=function(){let H=Array.prototype.slice.call(arguments);if(H.length<2||H.length>4)throw new S(`Graph.${B}: invalid number of arguments (expecting 2, 3 or 4 and got ${H.length}).`);if(typeof H[H.length-1]==="function"&&typeof H[H.length-2]!=="function")throw new S(`Graph.${B}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let Y,$;if(H.length===2)Y=H[0],$=H[1],H=[];else if(H.length===3)Y=H[1],$=H[2],H=[H[0]];else if(H.length===4)Y=H[2],$=H[3],H=[H[0],H[1]];let X=$;return H.push((j,w,L,A,G,k,T)=>{X=Y(X,j,w,L,A,G,k,T)}),this[W].apply(this,H),X}}function f7(J,K){let{name:Q,type:Z,direction:q}=K,W="find"+Q[0].toUpperCase()+Q.slice(1,-1);J.prototype[W]=function(B,H,Y){if(Z!=="mixed"&&this.type!=="mixed"&&Z!==this.type)return!1;if(arguments.length===1)return Y=B,TQ(!0,this,Z,Y);if(arguments.length===2){B=""+B,Y=H;let $=this._nodes.get(B);if(typeof $>"u")throw new C(`Graph.${W}: could not find the "${B}" node in the graph.`);return SJ(!0,this.multi,Z==="mixed"?this.type:Z,q,$,Y)}if(arguments.length===3){B=""+B,H=""+H;let $=this._nodes.get(B);if(!$)throw new C(`Graph.${W}:  could not find the "${B}" source node in the graph.`);if(!this._nodes.has(H))throw new C(`Graph.${W}:  could not find the "${H}" target node in the graph.`);return RJ(!0,Z,this.multi,q,$,H,Y)}throw new S(`Graph.${W}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)};let V="some"+Q[0].toUpperCase()+Q.slice(1,-1);J.prototype[V]=function(){let B=Array.prototype.slice.call(arguments),H=B.pop();if(B.push(($,X,j,w,L,A,G)=>{return H($,X,j,w,L,A,G)}),this[W].apply(this,B))return!0;return!1};let z="every"+Q[0].toUpperCase()+Q.slice(1,-1);J.prototype[z]=function(){let B=Array.prototype.slice.call(arguments),H=B.pop();if(B.push(($,X,j,w,L,A,G)=>{return!H($,X,j,w,L,A,G)}),this[W].apply(this,B))return!1;return!0}}function M7(J,K){let{name:Q,type:Z,direction:q}=K,W=Q.slice(0,-1)+"Entries";J.prototype[W]=function(V,z){if(Z!=="mixed"&&this.type!=="mixed"&&Z!==this.type)return u0();if(!arguments.length)return I7(this,Z);if(arguments.length===1){V=""+V;let B=this._nodes.get(V);if(!B)throw new C(`Graph.${W}: could not find the "${V}" node in the graph.`);return S7(Z,q,B)}if(arguments.length===2){V=""+V,z=""+z;let B=this._nodes.get(V);if(!B)throw new C(`Graph.${W}:  could not find the "${V}" source node in the graph.`);if(!this._nodes.has(z))throw new C(`Graph.${W}:  could not find the "${z}" target node in the graph.`);return v7(Z,q,B,z)}throw new S(`Graph.${W}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function b7(J){F7.forEach((K)=>{G7(J,K),O7(J,K),f7(J,K),M7(J,K)})}var N7=[{name:"neighbors",type:"mixed"},{name:"inNeighbors",type:"directed",direction:"in"},{name:"outNeighbors",type:"directed",direction:"out"},{name:"inboundNeighbors",type:"mixed",direction:"in"},{name:"outboundNeighbors",type:"mixed",direction:"out"},{name:"directedNeighbors",type:"directed"},{name:"undirectedNeighbors",type:"undirected"}];function KJ(){this.A=null,this.B=null}KJ.prototype.wrap=function(J){if(this.A===null)this.A=J;else if(this.B===null)this.B=J};KJ.prototype.has=function(J){if(this.A!==null&&J in this.A)return!0;if(this.B!==null&&J in this.B)return!0;return!1};function n0(J,K,Q,Z,q){for(let W in Z){let V=Z[W],z=V.source,B=V.target,H=z===Q?B:z;if(K&&K.has(H.key))continue;let Y=q(H.key,H.attributes);if(J&&Y)return H.key}return}function vJ(J,K,Q,Z,q){if(K!=="mixed"){if(K==="undirected")return n0(J,null,Z,Z.undirected,q);if(typeof Q==="string")return n0(J,null,Z,Z[Q],q)}let W=new KJ,V;if(K!=="undirected"){if(Q!=="out"){if(V=n0(J,null,Z,Z.in,q),J&&V)return V;W.wrap(Z.in)}if(Q!=="in"){if(V=n0(J,W,Z,Z.out,q),J&&V)return V;W.wrap(Z.out)}}if(K!=="directed"){if(V=n0(J,W,Z,Z.undirected,q),J&&V)return V}return}function y7(J,K,Q){if(J!=="mixed"){if(J==="undirected")return Object.keys(Q.undirected);if(typeof K==="string")return Object.keys(Q[K])}let Z=[];return vJ(!1,J,K,Q,function(q){Z.push(q)}),Z}function d0(J,K,Q){let Z=Object.keys(Q),q=Z.length,W=0;return{[Symbol.iterator](){return this},next(){let V=null;do{if(W>=q){if(J)J.wrap(Q);return{done:!0}}let z=Q[Z[W++]],B=z.source,H=z.target;if(V=B===K?H:B,J&&J.has(V.key)){V=null;continue}}while(V===null);return{done:!1,value:{neighbor:V.key,attributes:V.attributes}}}}}function x7(J,K,Q){if(J!=="mixed"){if(J==="undirected")return d0(null,Q,Q.undirected);if(typeof K==="string")return d0(null,Q,Q[K])}let Z=u0(),q=new KJ;if(J!=="undirected"){if(K!=="out")Z=A0(Z,d0(q,Q,Q.in));if(K!=="in")Z=A0(Z,d0(q,Q,Q.out))}if(J!=="directed")Z=A0(Z,d0(q,Q,Q.undirected));return Z}function E7(J,K){let{name:Q,type:Z,direction:q}=K;J.prototype[Q]=function(W){if(Z!=="mixed"&&this.type!=="mixed"&&Z!==this.type)return[];W=""+W;let V=this._nodes.get(W);if(typeof V>"u")throw new C(`Graph.${Q}: could not find the "${W}" node in the graph.`);return y7(Z==="mixed"?this.type:Z,q,V)}}function D7(J,K){let{name:Q,type:Z,direction:q}=K,W="forEach"+Q[0].toUpperCase()+Q.slice(1,-1);J.prototype[W]=function(H,Y){if(Z!=="mixed"&&this.type!=="mixed"&&Z!==this.type)return;H=""+H;let $=this._nodes.get(H);if(typeof $>"u")throw new C(`Graph.${W}: could not find the "${H}" node in the graph.`);vJ(!1,Z==="mixed"?this.type:Z,q,$,Y)};let V="map"+Q[0].toUpperCase()+Q.slice(1);J.prototype[V]=function(H,Y){let $=[];return this[W](H,(X,j)=>{$.push(Y(X,j))}),$};let z="filter"+Q[0].toUpperCase()+Q.slice(1);J.prototype[z]=function(H,Y){let $=[];return this[W](H,(X,j)=>{if(Y(X,j))$.push(X)}),$};let B="reduce"+Q[0].toUpperCase()+Q.slice(1);J.prototype[B]=function(H,Y,$){if(arguments.length<3)throw new S(`Graph.${B}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let X=$;return this[W](H,(j,w)=>{X=Y(X,j,w)}),X}}function _7(J,K){let{name:Q,type:Z,direction:q}=K,W=Q[0].toUpperCase()+Q.slice(1,-1),V="find"+W;J.prototype[V]=function(H,Y){if(Z!=="mixed"&&this.type!=="mixed"&&Z!==this.type)return;H=""+H;let $=this._nodes.get(H);if(typeof $>"u")throw new C(`Graph.${V}: could not find the "${H}" node in the graph.`);return vJ(!0,Z==="mixed"?this.type:Z,q,$,Y)};let z="some"+W;J.prototype[z]=function(H,Y){if(this[V](H,Y))return!0;return!1};let B="every"+W;J.prototype[B]=function(H,Y){if(this[V](H,(X,j)=>{return!Y(X,j)}))return!1;return!0}}function u7(J,K){let{name:Q,type:Z,direction:q}=K,W=Q.slice(0,-1)+"Entries";J.prototype[W]=function(V){if(Z!=="mixed"&&this.type!=="mixed"&&Z!==this.type)return u0();V=""+V;let z=this._nodes.get(V);if(typeof z>"u")throw new C(`Graph.${W}: could not find the "${V}" node in the graph.`);return x7(Z==="mixed"?this.type:Z,q,z)}}function h7(J){N7.forEach((K)=>{E7(J,K),D7(J,K),_7(J,K),u7(J,K)})}function QJ(J,K,Q,Z,q){let W=Z._nodes.values(),V=Z.type,z,B,H,Y,$,X,j;while(z=W.next(),z.done!==!0){let w=!1;if(B=z.value,V!=="undirected"){Y=B.out;for(H in Y){$=Y[H];do{if(X=$.target,w=!0,j=q(B.key,X.key,B.attributes,X.attributes,$.key,$.attributes,$.undirected),J&&j)return $;$=$.next}while($)}}if(V!=="directed"){Y=B.undirected;for(H in Y){if(K&&B.key>H)continue;$=Y[H];do{if(X=$.target,X.key!==H)X=$.source;if(w=!0,j=q(B.key,X.key,B.attributes,X.attributes,$.key,$.attributes,$.undirected),J&&j)return $;$=$.next}while($)}}if(Q&&!w){if(j=q(B.key,null,B.attributes,null,null,null,null),J&&j)return null}}return}function m7(J,K){let Q={key:J};if(!YQ(K.attributes))Q.attributes=p({},K.attributes);return Q}function c7(J,K,Q){let Z={key:K,source:Q.source.key,target:Q.target.key};if(!YQ(Q.attributes))Z.attributes=p({},Q.attributes);if(J==="mixed"&&Q.undirected)Z.undirected=!0;return Z}function l7(J){if(!i(J))throw new S('Graph.import: invalid serialized node. A serialized node should be a plain object with at least a "key" property.');if(!("key"in J))throw new S("Graph.import: serialized node is missing its key.");if("attributes"in J&&(!i(J.attributes)||J.attributes===null))throw new S("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.")}function p7(J){if(!i(J))throw new S('Graph.import: invalid serialized edge. A serialized edge should be a plain object with at least a "source" & "target" property.');if(!("source"in J))throw new S("Graph.import: serialized edge is missing its source.");if(!("target"in J))throw new S("Graph.import: serialized edge is missing its target.");if("attributes"in J&&(!i(J.attributes)||J.attributes===null))throw new S("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.");if("undirected"in J&&typeof J.undirected!=="boolean")throw new S("Graph.import: invalid undirectedness information. Undirected should be boolean or omitted.")}var g7=n6(),s7=new Set(["directed","undirected","mixed"]),HQ=new Set(["domain","_events","_eventsCount","_maxListeners"]),n7=[{name:(J)=>`${J}Edge`,generateKey:!0},{name:(J)=>`${J}DirectedEdge`,generateKey:!0,type:"directed"},{name:(J)=>`${J}UndirectedEdge`,generateKey:!0,type:"undirected"},{name:(J)=>`${J}EdgeWithKey`},{name:(J)=>`${J}DirectedEdgeWithKey`,type:"directed"},{name:(J)=>`${J}UndirectedEdgeWithKey`,type:"undirected"}],d7={allowSelfLoops:!0,multi:!1,type:"mixed"};function i7(J,K,Q){if(Q&&!i(Q))throw new S(`Graph.addNode: invalid attributes. Expecting an object but got "${Q}"`);if(K=""+K,Q=Q||{},J._nodes.has(K))throw new f(`Graph.addNode: the "${K}" node already exist in the graph.`);let Z=new J.NodeDataClass(K,Q);return J._nodes.set(K,Z),J.emit("nodeAdded",{key:K,attributes:Q}),Z}function $Q(J,K,Q){let Z=new J.NodeDataClass(K,Q);return J._nodes.set(K,Z),J.emit("nodeAdded",{key:K,attributes:Q}),Z}function AQ(J,K,Q,Z,q,W,V,z){if(!Z&&J.type==="undirected")throw new f(`Graph.${K}: you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead.`);if(Z&&J.type==="directed")throw new f(`Graph.${K}: you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead.`);if(z&&!i(z))throw new S(`Graph.${K}: invalid attributes. Expecting an object but got "${z}"`);if(W=""+W,V=""+V,z=z||{},!J.allowSelfLoops&&W===V)throw new f(`Graph.${K}: source & target are the same ("${W}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);let B=J._nodes.get(W),H=J._nodes.get(V);if(!B)throw new C(`Graph.${K}: source node "${W}" not found.`);if(!H)throw new C(`Graph.${K}: target node "${V}" not found.`);let Y={key:null,undirected:Z,source:W,target:V,attributes:z};if(Q)q=J._edgeKeyGenerator();else if(q=""+q,J._edges.has(q))throw new f(`Graph.${K}: the "${q}" edge already exists in the graph.`);if(!J.multi&&(Z?typeof B.undirected[V]<"u":typeof B.out[V]<"u"))throw new f(`Graph.${K}: an edge linking "${W}" to "${V}" already exists. If you really want to add multiple edges linking those nodes, you should create a multi graph by using the 'multi' option.`);let $=new h0(Z,q,B,H,z);J._edges.set(q,$);let X=W===V;if(Z){if(B.undirectedDegree++,H.undirectedDegree++,X)B.undirectedLoops++,J._undirectedSelfLoopCount++}else if(B.outDegree++,H.inDegree++,X)B.directedLoops++,J._directedSelfLoopCount++;if(J.multi)$.attachMulti();else $.attach();if(Z)J._undirectedSize++;else J._directedSize++;return Y.key=q,J.emit("edgeAdded",Y),q}function o7(J,K,Q,Z,q,W,V,z,B){if(!Z&&J.type==="undirected")throw new f(`Graph.${K}: you cannot merge/update a directed edge to an undirected graph. Use the #.mergeEdge/#.updateEdge or #.addUndirectedEdge instead.`);if(Z&&J.type==="directed")throw new f(`Graph.${K}: you cannot merge/update an undirected edge to a directed graph. Use the #.mergeEdge/#.updateEdge or #.addDirectedEdge instead.`);if(z){if(B){if(typeof z!=="function")throw new S(`Graph.${K}: invalid updater function. Expecting a function but got "${z}"`)}else if(!i(z))throw new S(`Graph.${K}: invalid attributes. Expecting an object but got "${z}"`)}W=""+W,V=""+V;let H;if(B)H=z,z=void 0;if(!J.allowSelfLoops&&W===V)throw new f(`Graph.${K}: source & target are the same ("${W}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);let Y=J._nodes.get(W),$=J._nodes.get(V),X,j;if(!Q){if(X=J._edges.get(q),X){if(X.source.key!==W||X.target.key!==V){if(!Z||X.source.key!==V||X.target.key!==W)throw new f(`Graph.${K}: inconsistency detected when attempting to merge the "${q}" edge with "${W}" source & "${V}" target vs. ("${X.source.key}", "${X.target.key}").`)}j=X}}if(!j&&!J.multi&&Y)j=Z?Y.undirected[V]:Y.out[V];if(j){let k=[j.key,!1,!1,!1];if(B?!H:!z)return k;if(B){let T=j.attributes;j.attributes=H(T),J.emit("edgeAttributesUpdated",{type:"replace",key:j.key,attributes:j.attributes})}else p(j.attributes,z),J.emit("edgeAttributesUpdated",{type:"merge",key:j.key,attributes:j.attributes,data:z});return k}if(z=z||{},B&&H)z=H(z);let w={key:null,undirected:Z,source:W,target:V,attributes:z};if(Q)q=J._edgeKeyGenerator();else if(q=""+q,J._edges.has(q))throw new f(`Graph.${K}: the "${q}" edge already exists in the graph.`);let L=!1,A=!1;if(!Y){if(Y=$Q(J,W,{}),L=!0,W===V)$=Y,A=!0}if(!$)$=$Q(J,V,{}),A=!0;X=new h0(Z,q,Y,$,z),J._edges.set(q,X);let G=W===V;if(Z){if(Y.undirectedDegree++,$.undirectedDegree++,G)Y.undirectedLoops++,J._undirectedSelfLoopCount++}else if(Y.outDegree++,$.inDegree++,G)Y.directedLoops++,J._directedSelfLoopCount++;if(J.multi)X.attachMulti();else X.attach();if(Z)J._undirectedSize++;else J._directedSize++;return w.key=q,J.emit("edgeAdded",w),[q,!0,L,A]}function _0(J,K){J._edges.delete(K.key);let{source:Q,target:Z,attributes:q}=K,W=K.undirected,V=Q===Z;if(W){if(Q.undirectedDegree--,Z.undirectedDegree--,V)Q.undirectedLoops--,J._undirectedSelfLoopCount--}else if(Q.outDegree--,Z.inDegree--,V)Q.directedLoops--,J._directedSelfLoopCount--;if(J.multi)K.detachMulti();else K.detach();if(W)J._undirectedSize--;else J._directedSize--;J.emit("edgeDropped",{key:K.key,attributes:q,source:Q.key,target:Z.key,undirected:W})}class x extends w0{constructor(J){super();if(J=p({},d7,J),typeof J.multi!=="boolean")throw new S(`Graph.constructor: invalid 'multi' option. Expecting a boolean but got "${J.multi}".`);if(!s7.has(J.type))throw new S(`Graph.constructor: invalid 'type' option. Should be one of "mixed", "directed" or "undirected" but got "${J.type}".`);if(typeof J.allowSelfLoops!=="boolean")throw new S(`Graph.constructor: invalid 'allowSelfLoops' option. Expecting a boolean but got "${J.allowSelfLoops}".`);let K=J.type==="mixed"?XQ:J.type==="directed"?jQ:UQ;V0(this,"NodeDataClass",K);let Q="geid_"+g7()+"_",Z=0,q=()=>{let W;do W=Q+Z++;while(this._edges.has(W));return W};V0(this,"_attributes",{}),V0(this,"_nodes",new Map),V0(this,"_edges",new Map),V0(this,"_directedSize",0),V0(this,"_undirectedSize",0),V0(this,"_directedSelfLoopCount",0),V0(this,"_undirectedSelfLoopCount",0),V0(this,"_edgeKeyGenerator",q),V0(this,"_options",J),HQ.forEach((W)=>V0(this,W,this[W])),X0(this,"order",()=>this._nodes.size),X0(this,"size",()=>this._edges.size),X0(this,"directedSize",()=>this._directedSize),X0(this,"undirectedSize",()=>this._undirectedSize),X0(this,"selfLoopCount",()=>this._directedSelfLoopCount+this._undirectedSelfLoopCount),X0(this,"directedSelfLoopCount",()=>this._directedSelfLoopCount),X0(this,"undirectedSelfLoopCount",()=>this._undirectedSelfLoopCount),X0(this,"multi",this._options.multi),X0(this,"type",this._options.type),X0(this,"allowSelfLoops",this._options.allowSelfLoops),X0(this,"implementation",()=>"graphology")}_resetInstanceCounters(){this._directedSize=0,this._undirectedSize=0,this._directedSelfLoopCount=0,this._undirectedSelfLoopCount=0}hasNode(J){return this._nodes.has(""+J)}hasDirectedEdge(J,K){if(this.type==="undirected")return!1;if(arguments.length===1){let Q=""+J,Z=this._edges.get(Q);return!!Z&&!Z.undirected}else if(arguments.length===2){J=""+J,K=""+K;let Q=this._nodes.get(J);if(!Q)return!1;return Q.out.hasOwnProperty(K)}throw new S(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasUndirectedEdge(J,K){if(this.type==="directed")return!1;if(arguments.length===1){let Q=""+J,Z=this._edges.get(Q);return!!Z&&Z.undirected}else if(arguments.length===2){J=""+J,K=""+K;let Q=this._nodes.get(J);if(!Q)return!1;return Q.undirected.hasOwnProperty(K)}throw new S(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasEdge(J,K){if(arguments.length===1){let Q=""+J;return this._edges.has(Q)}else if(arguments.length===2){J=""+J,K=""+K;let Q=this._nodes.get(J);if(!Q)return!1;return typeof Q.out<"u"&&Q.out.hasOwnProperty(K)||typeof Q.undirected<"u"&&Q.undirected.hasOwnProperty(K)}throw new S(`Graph.hasEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}directedEdge(J,K){if(this.type==="undirected")return;if(J=""+J,K=""+K,this.multi)throw new f("Graph.directedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.directedEdges instead.");let Q=this._nodes.get(J);if(!Q)throw new C(`Graph.directedEdge: could not find the "${J}" source node in the graph.`);if(!this._nodes.has(K))throw new C(`Graph.directedEdge: could not find the "${K}" target node in the graph.`);let Z=Q.out&&Q.out[K]||void 0;if(Z)return Z.key}undirectedEdge(J,K){if(this.type==="directed")return;if(J=""+J,K=""+K,this.multi)throw new f("Graph.undirectedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.undirectedEdges instead.");let Q=this._nodes.get(J);if(!Q)throw new C(`Graph.undirectedEdge: could not find the "${J}" source node in the graph.`);if(!this._nodes.has(K))throw new C(`Graph.undirectedEdge: could not find the "${K}" target node in the graph.`);let Z=Q.undirected&&Q.undirected[K]||void 0;if(Z)return Z.key}edge(J,K){if(this.multi)throw new f("Graph.edge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.edges instead.");J=""+J,K=""+K;let Q=this._nodes.get(J);if(!Q)throw new C(`Graph.edge: could not find the "${J}" source node in the graph.`);if(!this._nodes.has(K))throw new C(`Graph.edge: could not find the "${K}" target node in the graph.`);let Z=Q.out&&Q.out[K]||Q.undirected&&Q.undirected[K]||void 0;if(Z)return Z.key}areDirectedNeighbors(J,K){J=""+J,K=""+K;let Q=this._nodes.get(J);if(!Q)throw new C(`Graph.areDirectedNeighbors: could not find the "${J}" node in the graph.`);if(this.type==="undirected")return!1;return K in Q.in||K in Q.out}areOutNeighbors(J,K){J=""+J,K=""+K;let Q=this._nodes.get(J);if(!Q)throw new C(`Graph.areOutNeighbors: could not find the "${J}" node in the graph.`);if(this.type==="undirected")return!1;return K in Q.out}areInNeighbors(J,K){J=""+J,K=""+K;let Q=this._nodes.get(J);if(!Q)throw new C(`Graph.areInNeighbors: could not find the "${J}" node in the graph.`);if(this.type==="undirected")return!1;return K in Q.in}areUndirectedNeighbors(J,K){J=""+J,K=""+K;let Q=this._nodes.get(J);if(!Q)throw new C(`Graph.areUndirectedNeighbors: could not find the "${J}" node in the graph.`);if(this.type==="directed")return!1;return K in Q.undirected}areNeighbors(J,K){J=""+J,K=""+K;let Q=this._nodes.get(J);if(!Q)throw new C(`Graph.areNeighbors: could not find the "${J}" node in the graph.`);if(this.type!=="undirected"){if(K in Q.in||K in Q.out)return!0}if(this.type!=="directed"){if(K in Q.undirected)return!0}return!1}areInboundNeighbors(J,K){J=""+J,K=""+K;let Q=this._nodes.get(J);if(!Q)throw new C(`Graph.areInboundNeighbors: could not find the "${J}" node in the graph.`);if(this.type!=="undirected"){if(K in Q.in)return!0}if(this.type!=="directed"){if(K in Q.undirected)return!0}return!1}areOutboundNeighbors(J,K){J=""+J,K=""+K;let Q=this._nodes.get(J);if(!Q)throw new C(`Graph.areOutboundNeighbors: could not find the "${J}" node in the graph.`);if(this.type!=="undirected"){if(K in Q.out)return!0}if(this.type!=="directed"){if(K in Q.undirected)return!0}return!1}inDegree(J){J=""+J;let K=this._nodes.get(J);if(!K)throw new C(`Graph.inDegree: could not find the "${J}" node in the graph.`);if(this.type==="undirected")return 0;return K.inDegree}outDegree(J){J=""+J;let K=this._nodes.get(J);if(!K)throw new C(`Graph.outDegree: could not find the "${J}" node in the graph.`);if(this.type==="undirected")return 0;return K.outDegree}directedDegree(J){J=""+J;let K=this._nodes.get(J);if(!K)throw new C(`Graph.directedDegree: could not find the "${J}" node in the graph.`);if(this.type==="undirected")return 0;return K.inDegree+K.outDegree}undirectedDegree(J){J=""+J;let K=this._nodes.get(J);if(!K)throw new C(`Graph.undirectedDegree: could not find the "${J}" node in the graph.`);if(this.type==="directed")return 0;return K.undirectedDegree}inboundDegree(J){J=""+J;let K=this._nodes.get(J);if(!K)throw new C(`Graph.inboundDegree: could not find the "${J}" node in the graph.`);let Q=0;if(this.type!=="directed")Q+=K.undirectedDegree;if(this.type!=="undirected")Q+=K.inDegree;return Q}outboundDegree(J){J=""+J;let K=this._nodes.get(J);if(!K)throw new C(`Graph.outboundDegree: could not find the "${J}" node in the graph.`);let Q=0;if(this.type!=="directed")Q+=K.undirectedDegree;if(this.type!=="undirected")Q+=K.outDegree;return Q}degree(J){J=""+J;let K=this._nodes.get(J);if(!K)throw new C(`Graph.degree: could not find the "${J}" node in the graph.`);let Q=0;if(this.type!=="directed")Q+=K.undirectedDegree;if(this.type!=="undirected")Q+=K.inDegree+K.outDegree;return Q}inDegreeWithoutSelfLoops(J){J=""+J;let K=this._nodes.get(J);if(!K)throw new C(`Graph.inDegreeWithoutSelfLoops: could not find the "${J}" node in the graph.`);if(this.type==="undirected")return 0;return K.inDegree-K.directedLoops}outDegreeWithoutSelfLoops(J){J=""+J;let K=this._nodes.get(J);if(!K)throw new C(`Graph.outDegreeWithoutSelfLoops: could not find the "${J}" node in the graph.`);if(this.type==="undirected")return 0;return K.outDegree-K.directedLoops}directedDegreeWithoutSelfLoops(J){J=""+J;let K=this._nodes.get(J);if(!K)throw new C(`Graph.directedDegreeWithoutSelfLoops: could not find the "${J}" node in the graph.`);if(this.type==="undirected")return 0;return K.inDegree+K.outDegree-K.directedLoops*2}undirectedDegreeWithoutSelfLoops(J){J=""+J;let K=this._nodes.get(J);if(!K)throw new C(`Graph.undirectedDegreeWithoutSelfLoops: could not find the "${J}" node in the graph.`);if(this.type==="directed")return 0;return K.undirectedDegree-K.undirectedLoops*2}inboundDegreeWithoutSelfLoops(J){J=""+J;let K=this._nodes.get(J);if(!K)throw new C(`Graph.inboundDegreeWithoutSelfLoops: could not find the "${J}" node in the graph.`);let Q=0,Z=0;if(this.type!=="directed")Q+=K.undirectedDegree,Z+=K.undirectedLoops*2;if(this.type!=="undirected")Q+=K.inDegree,Z+=K.directedLoops;return Q-Z}outboundDegreeWithoutSelfLoops(J){J=""+J;let K=this._nodes.get(J);if(!K)throw new C(`Graph.outboundDegreeWithoutSelfLoops: could not find the "${J}" node in the graph.`);let Q=0,Z=0;if(this.type!=="directed")Q+=K.undirectedDegree,Z+=K.undirectedLoops*2;if(this.type!=="undirected")Q+=K.outDegree,Z+=K.directedLoops;return Q-Z}degreeWithoutSelfLoops(J){J=""+J;let K=this._nodes.get(J);if(!K)throw new C(`Graph.degreeWithoutSelfLoops: could not find the "${J}" node in the graph.`);let Q=0,Z=0;if(this.type!=="directed")Q+=K.undirectedDegree,Z+=K.undirectedLoops*2;if(this.type!=="undirected")Q+=K.inDegree+K.outDegree,Z+=K.directedLoops*2;return Q-Z}source(J){J=""+J;let K=this._edges.get(J);if(!K)throw new C(`Graph.source: could not find the "${J}" edge in the graph.`);return K.source.key}target(J){J=""+J;let K=this._edges.get(J);if(!K)throw new C(`Graph.target: could not find the "${J}" edge in the graph.`);return K.target.key}extremities(J){J=""+J;let K=this._edges.get(J);if(!K)throw new C(`Graph.extremities: could not find the "${J}" edge in the graph.`);return[K.source.key,K.target.key]}opposite(J,K){J=""+J,K=""+K;let Q=this._edges.get(K);if(!Q)throw new C(`Graph.opposite: could not find the "${K}" edge in the graph.`);let Z=Q.source.key,q=Q.target.key;if(J===Z)return q;if(J===q)return Z;throw new C(`Graph.opposite: the "${J}" node is not attached to the "${K}" edge (${Z}, ${q}).`)}hasExtremity(J,K){J=""+J,K=""+K;let Q=this._edges.get(J);if(!Q)throw new C(`Graph.hasExtremity: could not find the "${J}" edge in the graph.`);return Q.source.key===K||Q.target.key===K}isUndirected(J){J=""+J;let K=this._edges.get(J);if(!K)throw new C(`Graph.isUndirected: could not find the "${J}" edge in the graph.`);return K.undirected}isDirected(J){J=""+J;let K=this._edges.get(J);if(!K)throw new C(`Graph.isDirected: could not find the "${J}" edge in the graph.`);return!K.undirected}isSelfLoop(J){J=""+J;let K=this._edges.get(J);if(!K)throw new C(`Graph.isSelfLoop: could not find the "${J}" edge in the graph.`);return K.source===K.target}addNode(J,K){return i7(this,J,K).key}mergeNode(J,K){if(K&&!i(K))throw new S(`Graph.mergeNode: invalid attributes. Expecting an object but got "${K}"`);J=""+J,K=K||{};let Q=this._nodes.get(J);if(Q){if(K)p(Q.attributes,K),this.emit("nodeAttributesUpdated",{type:"merge",key:J,attributes:Q.attributes,data:K});return[J,!1]}return Q=new this.NodeDataClass(J,K),this._nodes.set(J,Q),this.emit("nodeAdded",{key:J,attributes:K}),[J,!0]}updateNode(J,K){if(K&&typeof K!=="function")throw new S(`Graph.updateNode: invalid updater function. Expecting a function but got "${K}"`);J=""+J;let Q=this._nodes.get(J);if(Q){if(K){let q=Q.attributes;Q.attributes=K(q),this.emit("nodeAttributesUpdated",{type:"replace",key:J,attributes:Q.attributes})}return[J,!1]}let Z=K?K({}):{};return Q=new this.NodeDataClass(J,Z),this._nodes.set(J,Q),this.emit("nodeAdded",{key:J,attributes:Z}),[J,!0]}dropNode(J){J=""+J;let K=this._nodes.get(J);if(!K)throw new C(`Graph.dropNode: could not find the "${J}" node in the graph.`);let Q;if(this.type!=="undirected"){for(let Z in K.out){Q=K.out[Z];do _0(this,Q),Q=Q.next;while(Q)}for(let Z in K.in){Q=K.in[Z];do _0(this,Q),Q=Q.next;while(Q)}}if(this.type!=="directed")for(let Z in K.undirected){Q=K.undirected[Z];do _0(this,Q),Q=Q.next;while(Q)}this._nodes.delete(J),this.emit("nodeDropped",{key:J,attributes:K.attributes})}dropEdge(J){let K;if(arguments.length>1){let Q=""+arguments[0],Z=""+arguments[1];if(K=z0(this,Q,Z,this.type),!K)throw new C(`Graph.dropEdge: could not find the "${Q}" -> "${Z}" edge in the graph.`)}else if(J=""+J,K=this._edges.get(J),!K)throw new C(`Graph.dropEdge: could not find the "${J}" edge in the graph.`);return _0(this,K),this}dropDirectedEdge(J,K){if(arguments.length<2)throw new f("Graph.dropDirectedEdge: it does not make sense to try and drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new f("Graph.dropDirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");J=""+J,K=""+K;let Q=z0(this,J,K,"directed");if(!Q)throw new C(`Graph.dropDirectedEdge: could not find a "${J}" -> "${K}" edge in the graph.`);return _0(this,Q),this}dropUndirectedEdge(J,K){if(arguments.length<2)throw new f("Graph.dropUndirectedEdge: it does not make sense to drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new f("Graph.dropUndirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");let Q=z0(this,J,K,"undirected");if(!Q)throw new C(`Graph.dropUndirectedEdge: could not find a "${J}" -> "${K}" edge in the graph.`);return _0(this,Q),this}clear(){this._edges.clear(),this._nodes.clear(),this._resetInstanceCounters(),this.emit("cleared")}clearEdges(){let J=this._nodes.values(),K;while(K=J.next(),K.done!==!0)K.value.clear();this._edges.clear(),this._resetInstanceCounters(),this.emit("edgesCleared")}getAttribute(J){return this._attributes[J]}getAttributes(){return this._attributes}hasAttribute(J){return this._attributes.hasOwnProperty(J)}setAttribute(J,K){return this._attributes[J]=K,this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:J}),this}updateAttribute(J,K){if(typeof K!=="function")throw new S("Graph.updateAttribute: updater should be a function.");let Q=this._attributes[J];return this._attributes[J]=K(Q),this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:J}),this}removeAttribute(J){return delete this._attributes[J],this.emit("attributesUpdated",{type:"remove",attributes:this._attributes,name:J}),this}replaceAttributes(J){if(!i(J))throw new S("Graph.replaceAttributes: provided attributes are not a plain object.");return this._attributes=J,this.emit("attributesUpdated",{type:"replace",attributes:this._attributes}),this}mergeAttributes(J){if(!i(J))throw new S("Graph.mergeAttributes: provided attributes are not a plain object.");return p(this._attributes,J),this.emit("attributesUpdated",{type:"merge",attributes:this._attributes,data:J}),this}updateAttributes(J){if(typeof J!=="function")throw new S("Graph.updateAttributes: provided updater is not a function.");return this._attributes=J(this._attributes),this.emit("attributesUpdated",{type:"update",attributes:this._attributes}),this}updateEachNodeAttributes(J,K){if(typeof J!=="function")throw new S("Graph.updateEachNodeAttributes: expecting an updater function.");if(K&&!BQ(K))throw new S("Graph.updateEachNodeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");let Q=this._nodes.values(),Z,q;while(Z=Q.next(),Z.done!==!0)q=Z.value,q.attributes=J(q.key,q.attributes);this.emit("eachNodeAttributesUpdated",{hints:K?K:null})}updateEachEdgeAttributes(J,K){if(typeof J!=="function")throw new S("Graph.updateEachEdgeAttributes: expecting an updater function.");if(K&&!BQ(K))throw new S("Graph.updateEachEdgeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");let Q=this._edges.values(),Z,q,W,V;while(Z=Q.next(),Z.done!==!0)q=Z.value,W=q.source,V=q.target,q.attributes=J(q.key,q.attributes,W.key,V.key,W.attributes,V.attributes,q.undirected);this.emit("eachEdgeAttributesUpdated",{hints:K?K:null})}forEachAdjacencyEntry(J){if(typeof J!=="function")throw new S("Graph.forEachAdjacencyEntry: expecting a callback.");QJ(!1,!1,!1,this,J)}forEachAdjacencyEntryWithOrphans(J){if(typeof J!=="function")throw new S("Graph.forEachAdjacencyEntryWithOrphans: expecting a callback.");QJ(!1,!1,!0,this,J)}forEachAssymetricAdjacencyEntry(J){if(typeof J!=="function")throw new S("Graph.forEachAssymetricAdjacencyEntry: expecting a callback.");QJ(!1,!0,!1,this,J)}forEachAssymetricAdjacencyEntryWithOrphans(J){if(typeof J!=="function")throw new S("Graph.forEachAssymetricAdjacencyEntryWithOrphans: expecting a callback.");QJ(!1,!0,!0,this,J)}nodes(){return Array.from(this._nodes.keys())}forEachNode(J){if(typeof J!=="function")throw new S("Graph.forEachNode: expecting a callback.");let K=this._nodes.values(),Q,Z;while(Q=K.next(),Q.done!==!0)Z=Q.value,J(Z.key,Z.attributes)}findNode(J){if(typeof J!=="function")throw new S("Graph.findNode: expecting a callback.");let K=this._nodes.values(),Q,Z;while(Q=K.next(),Q.done!==!0)if(Z=Q.value,J(Z.key,Z.attributes))return Z.key;return}mapNodes(J){if(typeof J!=="function")throw new S("Graph.mapNode: expecting a callback.");let K=this._nodes.values(),Q,Z,q=Array(this.order),W=0;while(Q=K.next(),Q.done!==!0)Z=Q.value,q[W++]=J(Z.key,Z.attributes);return q}someNode(J){if(typeof J!=="function")throw new S("Graph.someNode: expecting a callback.");let K=this._nodes.values(),Q,Z;while(Q=K.next(),Q.done!==!0)if(Z=Q.value,J(Z.key,Z.attributes))return!0;return!1}everyNode(J){if(typeof J!=="function")throw new S("Graph.everyNode: expecting a callback.");let K=this._nodes.values(),Q,Z;while(Q=K.next(),Q.done!==!0)if(Z=Q.value,!J(Z.key,Z.attributes))return!1;return!0}filterNodes(J){if(typeof J!=="function")throw new S("Graph.filterNodes: expecting a callback.");let K=this._nodes.values(),Q,Z,q=[];while(Q=K.next(),Q.done!==!0)if(Z=Q.value,J(Z.key,Z.attributes))q.push(Z.key);return q}reduceNodes(J,K){if(typeof J!=="function")throw new S("Graph.reduceNodes: expecting a callback.");if(arguments.length<2)throw new S("Graph.reduceNodes: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.");let Q=K,Z=this._nodes.values(),q,W;while(q=Z.next(),q.done!==!0)W=q.value,Q=J(Q,W.key,W.attributes);return Q}nodeEntries(){let J=this._nodes.values();return{[Symbol.iterator](){return this},next(){let K=J.next();if(K.done)return K;let Q=K.value;return{value:{node:Q.key,attributes:Q.attributes},done:!1}}}}export(){let J=Array(this._nodes.size),K=0;this._nodes.forEach((Z,q)=>{J[K++]=m7(q,Z)});let Q=Array(this._edges.size);return K=0,this._edges.forEach((Z,q)=>{Q[K++]=c7(this.type,q,Z)}),{options:{type:this.type,multi:this.multi,allowSelfLoops:this.allowSelfLoops},attributes:this.getAttributes(),nodes:J,edges:Q}}import(J,K=!1){if(J instanceof x)return J.forEachNode((z,B)=>{if(K)this.mergeNode(z,B);else this.addNode(z,B)}),J.forEachEdge((z,B,H,Y,$,X,j)=>{if(K)if(j)this.mergeUndirectedEdgeWithKey(z,H,Y,B);else this.mergeDirectedEdgeWithKey(z,H,Y,B);else if(j)this.addUndirectedEdgeWithKey(z,H,Y,B);else this.addDirectedEdgeWithKey(z,H,Y,B)}),this;if(!i(J))throw new S("Graph.import: invalid argument. Expecting a serialized graph or, alternatively, a Graph instance.");if(J.attributes){if(!i(J.attributes))throw new S("Graph.import: invalid attributes. Expecting a plain object.");if(K)this.mergeAttributes(J.attributes);else this.replaceAttributes(J.attributes)}let Q,Z,q,W,V;if(J.nodes){if(q=J.nodes,!Array.isArray(q))throw new S("Graph.import: invalid nodes. Expecting an array.");for(Q=0,Z=q.length;Q<Z;Q++){W=q[Q],l7(W);let{key:z,attributes:B}=W;if(K)this.mergeNode(z,B);else this.addNode(z,B)}}if(J.edges){let z=!1;if(this.type==="undirected")z=!0;if(q=J.edges,!Array.isArray(q))throw new S("Graph.import: invalid edges. Expecting an array.");for(Q=0,Z=q.length;Q<Z;Q++){V=q[Q],p7(V);let{source:B,target:H,attributes:Y,undirected:$=z}=V,X;if("key"in V)X=K?$?this.mergeUndirectedEdgeWithKey:this.mergeDirectedEdgeWithKey:$?this.addUndirectedEdgeWithKey:this.addDirectedEdgeWithKey,X.call(this,V.key,B,H,Y);else X=K?$?this.mergeUndirectedEdge:this.mergeDirectedEdge:$?this.addUndirectedEdge:this.addDirectedEdge,X.call(this,B,H,Y)}}return this}nullCopy(J){let K=new x(p({},this._options,J));return K.replaceAttributes(p({},this.getAttributes())),K}emptyCopy(J){let K=this.nullCopy(J);return this._nodes.forEach((Q,Z)=>{let q=p({},Q.attributes);Q=new K.NodeDataClass(Z,q),K._nodes.set(Z,Q)}),K}copy(J){if(J=J||{},typeof J.type==="string"&&J.type!==this.type&&J.type!=="mixed")throw new f(`Graph.copy: cannot create an incompatible copy from "${this.type}" type to "${J.type}" because this would mean losing information about the current graph.`);if(typeof J.multi==="boolean"&&J.multi!==this.multi&&J.multi!==!0)throw new f("Graph.copy: cannot create an incompatible copy by downgrading a multi graph to a simple one because this would mean losing information about the current graph.");if(typeof J.allowSelfLoops==="boolean"&&J.allowSelfLoops!==this.allowSelfLoops&&J.allowSelfLoops!==!0)throw new f("Graph.copy: cannot create an incompatible copy from a graph allowing self loops to one that does not because this would mean losing information about the current graph.");let K=this.emptyCopy(J),Q=this._edges.values(),Z,q;while(Z=Q.next(),Z.done!==!0)q=Z.value,AQ(K,"copy",!1,q.undirected,q.key,q.source.key,q.target.key,p({},q.attributes));return K}toJSON(){return this.export()}toString(){return"[object Graph]"}inspect(){let J={};this._nodes.forEach((q,W)=>{J[W]=q.attributes});let K={},Q={};this._edges.forEach((q,W)=>{let V=q.undirected?"--":"->",z="",B=q.source.key,H=q.target.key,Y;if(q.undirected&&B>H)Y=B,B=H,H=Y;let $=`(${B})${V}(${H})`;if(!W.startsWith("geid_"))z+=`[${W}]: `;else if(this.multi){if(typeof Q[$]>"u")Q[$]=0;else Q[$]++;z+=`${Q[$]}. `}z+=$,K[z]=q.attributes});let Z={};for(let q in this)if(this.hasOwnProperty(q)&&!HQ.has(q)&&typeof this[q]!=="function"&&typeof q!=="symbol")Z[q]=this[q];return Z.attributes=this._attributes,Z.nodes=J,Z.edges=K,V0(Z,"constructor",this.constructor),Z}}if(typeof Symbol<"u")x.prototype[Symbol.for("nodejs.util.inspect.custom")]=x.prototype.inspect;n7.forEach((J)=>{["add","merge","update"].forEach((K)=>{let Q=J.name(K),Z=K==="add"?AQ:o7;if(J.generateKey)x.prototype[Q]=function(q,W,V){return Z(this,Q,!0,(J.type||this.type)==="undirected",null,q,W,V,K==="update")};else x.prototype[Q]=function(q,W,V,z){return Z(this,Q,!1,(J.type||this.type)==="undirected",q,W,V,z,K==="update")}})});q7(x);w7(x);b7(x);h7(x);class GJ extends x{constructor(J){let K=p({type:"directed"},J);if("multi"in K&&K.multi!==!1)throw new S("DirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(K.type!=="directed")throw new S('DirectedGraph.from: inconsistent "'+K.type+'" type in given options!');super(K)}}class OJ extends x{constructor(J){let K=p({type:"undirected"},J);if("multi"in K&&K.multi!==!1)throw new S("UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(K.type!=="undirected")throw new S('UndirectedGraph.from: inconsistent "'+K.type+'" type in given options!');super(K)}}class fJ extends x{constructor(J){let K=p({multi:!0},J);if("multi"in K&&K.multi!==!0)throw new S("MultiGraph.from: inconsistent indication that the graph should be simple in given options!");super(K)}}class MJ extends x{constructor(J){let K=p({type:"directed",multi:!0},J);if("multi"in K&&K.multi!==!0)throw new S("MultiDirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(K.type!=="directed")throw new S('MultiDirectedGraph.from: inconsistent "'+K.type+'" type in given options!');super(K)}}class bJ extends x{constructor(J){let K=p({type:"undirected",multi:!0},J);if("multi"in K&&K.multi!==!0)throw new S("MultiUndirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(K.type!=="undirected")throw new S('MultiUndirectedGraph.from: inconsistent "'+K.type+'" type in given options!');super(K)}}function m0(J){J.from=function(K,Q){let Z=p({},K.options,Q),q=new J(Z);return q.import(K),q}}m0(x);m0(GJ);m0(OJ);m0(fJ);m0(MJ);m0(bJ);x.Graph=x;x.DirectedGraph=GJ;x.UndirectedGraph=OJ;x.MultiGraph=fJ;x.MultiDirectedGraph=MJ;x.MultiUndirectedGraph=bJ;x.InvalidArgumentsGraphError=S;x.NotFoundGraphError=C;x.UsageGraphError=f;var tJ=TJ(xQ(),1);function A9(J,K){if(typeof J!="object"||!J)return J;var Q=J[Symbol.toPrimitive];if(Q!==void 0){var Z=Q.call(J,K||"default");if(typeof Z!="object")return Z;throw TypeError("@@toPrimitive must return a primitive value.")}return(K==="string"?String:Number)(J)}function N0(J){var K=A9(J,"string");return typeof K=="symbol"?K:K+""}function g(J,K){if(!(J instanceof K))throw TypeError("Cannot call a class as a function")}function EQ(J,K){for(var Q=0;Q<K.length;Q++){var Z=K[Q];Z.enumerable=Z.enumerable||!1,Z.configurable=!0,"value"in Z&&(Z.writable=!0),Object.defineProperty(J,N0(Z.key),Z)}}function s(J,K,Q){return K&&EQ(J.prototype,K),Q&&EQ(J,Q),Object.defineProperty(J,"prototype",{writable:!1}),J}function b0(J){return b0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(K){return K.__proto__||Object.getPrototypeOf(K)},b0(J)}function DQ(){try{var J=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(K){}return(DQ=function(){return!!J})()}function C9(J){if(J===void 0)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return J}function P9(J,K){if(K&&(typeof K=="object"||typeof K=="function"))return K;if(K!==void 0)throw TypeError("Derived constructors may only return object or undefined");return C9(J)}function t(J,K,Q){return K=b0(K),P9(J,DQ()?Reflect.construct(K,Q||[],b0(J).constructor):K.apply(J,Q))}function xJ(J,K){return xJ=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Q,Z){return Q.__proto__=Z,Q},xJ(J,K)}function e(J,K){if(typeof K!="function"&&K!==null)throw TypeError("Super expression must either be null or a function");J.prototype=Object.create(K&&K.prototype,{constructor:{value:J,writable:!0,configurable:!0}}),Object.defineProperty(J,"prototype",{writable:!1}),K&&xJ(J,K)}function I9(J){if(Array.isArray(J))return J}function k9(J,K){var Q=J==null?null:typeof Symbol<"u"&&J[Symbol.iterator]||J["@@iterator"];if(Q!=null){var Z,q,W,V,z=[],B=!0,H=!1;try{if(W=(Q=Q.call(J)).next,K===0){if(Object(Q)!==Q)return;B=!1}else for(;!(B=(Z=W.call(Q)).done)&&(z.push(Z.value),z.length!==K);B=!0);}catch(Y){H=!0,q=Y}finally{try{if(!B&&Q.return!=null&&(V=Q.return(),Object(V)!==V))return}finally{if(H)throw q}}return z}}function VJ(J,K){(K==null||K>J.length)&&(K=J.length);for(var Q=0,Z=Array(K);Q<K;Q++)Z[Q]=J[Q];return Z}function uJ(J,K){if(J){if(typeof J=="string")return VJ(J,K);var Q={}.toString.call(J).slice(8,-1);return Q==="Object"&&J.constructor&&(Q=J.constructor.name),Q==="Map"||Q==="Set"?Array.from(J):Q==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Q)?VJ(J,K):void 0}}function S9(){throw TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function v0(J,K){return I9(J)||k9(J,K)||uJ(J,K)||S9()}var EJ={black:"#000000",silver:"#C0C0C0",gray:"#808080",grey:"#808080",white:"#FFFFFF",maroon:"#800000",red:"#FF0000",purple:"#800080",fuchsia:"#FF00FF",green:"#008000",lime:"#00FF00",olive:"#808000",yellow:"#FFFF00",navy:"#000080",blue:"#0000FF",teal:"#008080",aqua:"#00FFFF",darkblue:"#00008B",mediumblue:"#0000CD",darkgreen:"#006400",darkcyan:"#008B8B",deepskyblue:"#00BFFF",darkturquoise:"#00CED1",mediumspringgreen:"#00FA9A",springgreen:"#00FF7F",cyan:"#00FFFF",midnightblue:"#191970",dodgerblue:"#1E90FF",lightseagreen:"#20B2AA",forestgreen:"#228B22",seagreen:"#2E8B57",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",limegreen:"#32CD32",mediumseagreen:"#3CB371",turquoise:"#40E0D0",royalblue:"#4169E1",steelblue:"#4682B4",darkslateblue:"#483D8B",mediumturquoise:"#48D1CC",indigo:"#4B0082",darkolivegreen:"#556B2F",cadetblue:"#5F9EA0",cornflowerblue:"#6495ED",rebeccapurple:"#663399",mediumaquamarine:"#66CDAA",dimgray:"#696969",dimgrey:"#696969",slateblue:"#6A5ACD",olivedrab:"#6B8E23",slategray:"#708090",slategrey:"#708090",lightslategray:"#778899",lightslategrey:"#778899",mediumslateblue:"#7B68EE",lawngreen:"#7CFC00",chartreuse:"#7FFF00",aquamarine:"#7FFFD4",skyblue:"#87CEEB",lightskyblue:"#87CEFA",blueviolet:"#8A2BE2",darkred:"#8B0000",darkmagenta:"#8B008B",saddlebrown:"#8B4513",darkseagreen:"#8FBC8F",lightgreen:"#90EE90",mediumpurple:"#9370DB",darkviolet:"#9400D3",palegreen:"#98FB98",darkorchid:"#9932CC",yellowgreen:"#9ACD32",sienna:"#A0522D",brown:"#A52A2A",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",lightblue:"#ADD8E6",greenyellow:"#ADFF2F",paleturquoise:"#AFEEEE",lightsteelblue:"#B0C4DE",powderblue:"#B0E0E6",firebrick:"#B22222",darkgoldenrod:"#B8860B",mediumorchid:"#BA55D3",rosybrown:"#BC8F8F",darkkhaki:"#BDB76B",mediumvioletred:"#C71585",indianred:"#CD5C5C",peru:"#CD853F",chocolate:"#D2691E",tan:"#D2B48C",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",thistle:"#D8BFD8",orchid:"#DA70D6",goldenrod:"#DAA520",palevioletred:"#DB7093",crimson:"#DC143C",gainsboro:"#DCDCDC",plum:"#DDA0DD",burlywood:"#DEB887",lightcyan:"#E0FFFF",lavender:"#E6E6FA",darksalmon:"#E9967A",violet:"#EE82EE",palegoldenrod:"#EEE8AA",lightcoral:"#F08080",khaki:"#F0E68C",aliceblue:"#F0F8FF",honeydew:"#F0FFF0",azure:"#F0FFFF",sandybrown:"#F4A460",wheat:"#F5DEB3",beige:"#F5F5DC",whitesmoke:"#F5F5F5",mintcream:"#F5FFFA",ghostwhite:"#F8F8FF",salmon:"#FA8072",antiquewhite:"#FAEBD7",linen:"#FAF0E6",lightgoldenrodyellow:"#FAFAD2",oldlace:"#FDF5E6",magenta:"#FF00FF",deeppink:"#FF1493",orangered:"#FF4500",tomato:"#FF6347",hotpink:"#FF69B4",coral:"#FF7F50",darkorange:"#FF8C00",lightsalmon:"#FFA07A",orange:"#FFA500",lightpink:"#FFB6C1",pink:"#FFC0CB",gold:"#FFD700",peachpuff:"#FFDAB9",navajowhite:"#FFDEAD",moccasin:"#FFE4B5",bisque:"#FFE4C4",mistyrose:"#FFE4E1",blanchedalmond:"#FFEBCD",papayawhip:"#FFEFD5",lavenderblush:"#FFF0F5",seashell:"#FFF5EE",cornsilk:"#FFF8DC",lemonchiffon:"#FFFACD",floralwhite:"#FFFAF0",snow:"#FFFAFA",lightyellow:"#FFFFE0",ivory:"#FFFFF0"};var _Q=new Int8Array(4),DJ=new Int32Array(_Q.buffer,0,1),R9=new Float32Array(_Q.buffer,0,1),v9=/^\s*rgba?\s*\(/,G9=/^\s*rgba?\s*\(\s*([0-9]*)\s*,\s*([0-9]*)\s*,\s*([0-9]*)(?:\s*,\s*(.*)?)?\)\s*$/;function O9(J){var K=0,Q=0,Z=0,q=1;if(J[0]==="#"){if(J.length===4)K=parseInt(J.charAt(1)+J.charAt(1),16),Q=parseInt(J.charAt(2)+J.charAt(2),16),Z=parseInt(J.charAt(3)+J.charAt(3),16);else K=parseInt(J.charAt(1)+J.charAt(2),16),Q=parseInt(J.charAt(3)+J.charAt(4),16),Z=parseInt(J.charAt(5)+J.charAt(6),16);if(J.length===9)q=parseInt(J.charAt(7)+J.charAt(8),16)/255}else if(v9.test(J)){var W=J.match(G9);if(W){if(K=+W[1],Q=+W[2],Z=+W[3],W[4])q=+W[4]}}return{r:K,g:Q,b:Z,a:q}}var l0={};for(c0 in EJ)l0[c0]=p0(EJ[c0]),l0[EJ[c0]]=l0[c0];var c0;function uQ(J,K,Q,Z,q){if(DJ[0]=Z<<24|Q<<16|K<<8|J,q)DJ[0]=DJ[0]&4278190079;return R9[0]}function p0(J){if(J=J.toLowerCase(),typeof l0[J]<"u")return l0[J];var K=O9(J),Q=K.r,Z=K.g,q=K.b,W=K.a;W=W*255|0;var V=uQ(Q,Z,q,W,!0);return l0[J]=V,V}var _J={};function hJ(J){if(typeof _J[J]<"u")return _J[J];var K=(J&16711680)>>>16,Q=(J&65280)>>>8,Z=J&255,q=255,W=uQ(K,Q,Z,q,!0);return _J[J]=W,W}function mJ(J,K,Q,Z){return Q+(K<<8)+(J<<16)}function cJ(J,K,Q,Z,q,W){var V=Math.floor(Q/W*q),z=Math.floor(J.drawingBufferHeight/W-Z/W*q),B=new Uint8Array(4);J.bindFramebuffer(J.FRAMEBUFFER,K),J.readPixels(V,z,1,1,J.RGBA,J.UNSIGNED_BYTE,B);var H=v0(B,4),Y=H[0],$=H[1],X=H[2],j=H[3];return[Y,$,X,j]}function F(J,K,Q){return(K=N0(K))in J?Object.defineProperty(J,K,{value:Q,enumerable:!0,configurable:!0,writable:!0}):J[K]=Q,J}function hQ(J,K){var Q=Object.keys(J);if(Object.getOwnPropertySymbols){var Z=Object.getOwnPropertySymbols(J);K&&(Z=Z.filter(function(q){return Object.getOwnPropertyDescriptor(J,q).enumerable})),Q.push.apply(Q,Z)}return Q}function v(J){for(var K=1;K<arguments.length;K++){var Q=arguments[K]!=null?arguments[K]:{};K%2?hQ(Object(Q),!0).forEach(function(Z){F(J,Z,Q[Z])}):Object.getOwnPropertyDescriptors?Object.defineProperties(J,Object.getOwnPropertyDescriptors(Q)):hQ(Object(Q)).forEach(function(Z){Object.defineProperty(J,Z,Object.getOwnPropertyDescriptor(Q,Z))})}return J}function f9(J,K){for(;!{}.hasOwnProperty.call(J,K)&&(J=b0(J))!==null;);return J}function gJ(){return gJ=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(J,K,Q){var Z=f9(J,K);if(Z){var q=Object.getOwnPropertyDescriptor(Z,K);return q.get?q.get.call(arguments.length<3?J:Q):q.value}},gJ.apply(null,arguments)}function nQ(J,K,Q,Z){var q=gJ(b0(1&Z?J.prototype:J),K,Q);return 2&Z&&typeof q=="function"?function(W){return q.apply(Q,W)}:q}function M9(J){return J.normalized?1:J.size}function lJ(J){var K=0;return J.forEach(function(Q){return K+=M9(Q)}),K}function dQ(J,K,Q){var Z=J==="VERTEX"?K.VERTEX_SHADER:K.FRAGMENT_SHADER,q=K.createShader(Z);if(q===null)throw Error("loadShader: error while creating the shader");K.shaderSource(q,Q),K.compileShader(q);var W=K.getShaderParameter(q,K.COMPILE_STATUS);if(!W){var V=K.getShaderInfoLog(q);throw K.deleteShader(q),Error(`loadShader: error while compiling the shader:
`.concat(V,`
`).concat(Q))}return q}function b9(J,K){return dQ("VERTEX",J,K)}function N9(J,K){return dQ("FRAGMENT",J,K)}function y9(J,K){var Q=J.createProgram();if(Q===null)throw Error("loadProgram: error while creating the program.");var Z,q;for(Z=0,q=K.length;Z<q;Z++)J.attachShader(Q,K[Z]);J.linkProgram(Q);var W=J.getProgramParameter(Q,J.LINK_STATUS);if(!W)throw J.deleteProgram(Q),Error("loadProgram: error while linking the program.");return Q}function mQ(J){var{gl:K,buffer:Q,program:Z,vertexShader:q,fragmentShader:W}=J;K.deleteShader(q),K.deleteShader(W),K.deleteProgram(Z),K.deleteBuffer(Q)}var cQ=`#define PICKING_MODE
`,x9=F(F(F(F(F(F(F(F({},WebGL2RenderingContext.BOOL,1),WebGL2RenderingContext.BYTE,1),WebGL2RenderingContext.UNSIGNED_BYTE,1),WebGL2RenderingContext.SHORT,2),WebGL2RenderingContext.UNSIGNED_SHORT,2),WebGL2RenderingContext.INT,4),WebGL2RenderingContext.UNSIGNED_INT,4),WebGL2RenderingContext.FLOAT,4);var iQ=function(){function J(K,Q,Z){g(this,J),F(this,"array",new Float32Array),F(this,"constantArray",new Float32Array),F(this,"capacity",0),F(this,"verticesCount",0);var q=this.getDefinition();if(this.VERTICES=q.VERTICES,this.VERTEX_SHADER_SOURCE=q.VERTEX_SHADER_SOURCE,this.FRAGMENT_SHADER_SOURCE=q.FRAGMENT_SHADER_SOURCE,this.UNIFORMS=q.UNIFORMS,this.ATTRIBUTES=q.ATTRIBUTES,this.METHOD=q.METHOD,this.CONSTANT_ATTRIBUTES="CONSTANT_ATTRIBUTES"in q?q.CONSTANT_ATTRIBUTES:[],this.CONSTANT_DATA="CONSTANT_DATA"in q?q.CONSTANT_DATA:[],this.isInstanced="CONSTANT_ATTRIBUTES"in q,this.ATTRIBUTES_ITEMS_COUNT=lJ(this.ATTRIBUTES),this.STRIDE=this.VERTICES*this.ATTRIBUTES_ITEMS_COUNT,this.renderer=Z,this.normalProgram=this.getProgramInfo("normal",K,q.VERTEX_SHADER_SOURCE,q.FRAGMENT_SHADER_SOURCE,null),this.pickProgram=Q?this.getProgramInfo("pick",K,cQ+q.VERTEX_SHADER_SOURCE,cQ+q.FRAGMENT_SHADER_SOURCE,Q):null,this.isInstanced){var W=lJ(this.CONSTANT_ATTRIBUTES);if(this.CONSTANT_DATA.length!==this.VERTICES)throw Error("Program: error while getting constant data (expected ".concat(this.VERTICES," items, received ").concat(this.CONSTANT_DATA.length," instead)"));this.constantArray=new Float32Array(this.CONSTANT_DATA.length*W);for(var V=0;V<this.CONSTANT_DATA.length;V++){var z=this.CONSTANT_DATA[V];if(z.length!==W)throw Error("Program: error while getting constant data (one vector has ".concat(z.length," items instead of ").concat(W,")"));for(var B=0;B<z.length;B++)this.constantArray[V*W+B]=z[B]}this.STRIDE=this.ATTRIBUTES_ITEMS_COUNT}}return s(J,[{key:"kill",value:function(){if(mQ(this.normalProgram),this.pickProgram)mQ(this.pickProgram),this.pickProgram=null}},{key:"getProgramInfo",value:function(Q,Z,q,W,V){var z=this.getDefinition(),B=Z.createBuffer();if(B===null)throw Error("Program: error while creating the WebGL buffer.");var H=b9(Z,q),Y=N9(Z,W),$=y9(Z,[H,Y]),X={};z.UNIFORMS.forEach(function(L){var A=Z.getUniformLocation($,L);if(A)X[L]=A});var j={};z.ATTRIBUTES.forEach(function(L){j[L.name]=Z.getAttribLocation($,L.name)});var w;if("CONSTANT_ATTRIBUTES"in z){if(z.CONSTANT_ATTRIBUTES.forEach(function(L){j[L.name]=Z.getAttribLocation($,L.name)}),w=Z.createBuffer(),w===null)throw Error("Program: error while creating the WebGL constant buffer.")}return{name:Q,program:$,gl:Z,frameBuffer:V,buffer:B,constantBuffer:w||{},uniformLocations:X,attributeLocations:j,isPicking:Q==="pick",vertexShader:H,fragmentShader:Y}}},{key:"bindProgram",value:function(Q){var Z=this,q=0,W=Q.gl,V=Q.buffer;if(!this.isInstanced)W.bindBuffer(W.ARRAY_BUFFER,V),q=0,this.ATTRIBUTES.forEach(function(z){return q+=Z.bindAttribute(z,Q,q)}),W.bufferData(W.ARRAY_BUFFER,this.array,W.DYNAMIC_DRAW);else W.bindBuffer(W.ARRAY_BUFFER,Q.constantBuffer),q=0,this.CONSTANT_ATTRIBUTES.forEach(function(z){return q+=Z.bindAttribute(z,Q,q,!1)}),W.bufferData(W.ARRAY_BUFFER,this.constantArray,W.STATIC_DRAW),W.bindBuffer(W.ARRAY_BUFFER,Q.buffer),q=0,this.ATTRIBUTES.forEach(function(z){return q+=Z.bindAttribute(z,Q,q,!0)}),W.bufferData(W.ARRAY_BUFFER,this.array,W.DYNAMIC_DRAW);W.bindBuffer(W.ARRAY_BUFFER,null)}},{key:"unbindProgram",value:function(Q){var Z=this;if(!this.isInstanced)this.ATTRIBUTES.forEach(function(q){return Z.unbindAttribute(q,Q)});else this.CONSTANT_ATTRIBUTES.forEach(function(q){return Z.unbindAttribute(q,Q,!1)}),this.ATTRIBUTES.forEach(function(q){return Z.unbindAttribute(q,Q,!0)})}},{key:"bindAttribute",value:function(Q,Z,q,W){var V=x9[Q.type];if(typeof V!=="number")throw Error('Program.bind: yet unsupported attribute type "'.concat(Q.type,'"'));var z=Z.attributeLocations[Q.name],B=Z.gl;if(z!==-1){B.enableVertexAttribArray(z);var H=!this.isInstanced?this.ATTRIBUTES_ITEMS_COUNT*Float32Array.BYTES_PER_ELEMENT:(W?this.ATTRIBUTES_ITEMS_COUNT:lJ(this.CONSTANT_ATTRIBUTES))*Float32Array.BYTES_PER_ELEMENT;if(B.vertexAttribPointer(z,Q.size,Q.type,Q.normalized||!1,H,q),this.isInstanced&&W)if(B instanceof WebGL2RenderingContext)B.vertexAttribDivisor(z,1);else{var Y=B.getExtension("ANGLE_instanced_arrays");if(Y)Y.vertexAttribDivisorANGLE(z,1)}}return Q.size*V}},{key:"unbindAttribute",value:function(Q,Z,q){var W=Z.attributeLocations[Q.name],V=Z.gl;if(W!==-1){if(V.disableVertexAttribArray(W),this.isInstanced&&q)if(V instanceof WebGL2RenderingContext)V.vertexAttribDivisor(W,0);else{var z=V.getExtension("ANGLE_instanced_arrays");if(z)z.vertexAttribDivisorANGLE(W,0)}}}},{key:"reallocate",value:function(Q){if(Q===this.capacity)return;this.capacity=Q,this.verticesCount=this.VERTICES*Q,this.array=new Float32Array(!this.isInstanced?this.verticesCount*this.ATTRIBUTES_ITEMS_COUNT:this.capacity*this.ATTRIBUTES_ITEMS_COUNT)}},{key:"hasNothingToRender",value:function(){return this.verticesCount===0}},{key:"renderProgram",value:function(Q,Z){var{gl:q,program:W}=Z;q.enable(q.BLEND),q.useProgram(W),this.setUniforms(Q,Z),this.drawWebGL(this.METHOD,Z)}},{key:"render",value:function(Q){if(this.hasNothingToRender())return;if(this.pickProgram)this.pickProgram.gl.viewport(0,0,Q.width*Q.pixelRatio/Q.downSizingRatio,Q.height*Q.pixelRatio/Q.downSizingRatio),this.bindProgram(this.pickProgram),this.renderProgram(v(v({},Q),{},{pixelRatio:Q.pixelRatio/Q.downSizingRatio}),this.pickProgram),this.unbindProgram(this.pickProgram);this.normalProgram.gl.viewport(0,0,Q.width*Q.pixelRatio,Q.height*Q.pixelRatio),this.bindProgram(this.normalProgram),this.renderProgram(Q,this.normalProgram),this.unbindProgram(this.normalProgram)}},{key:"drawWebGL",value:function(Q,Z){var{gl:q,frameBuffer:W}=Z;if(q.bindFramebuffer(q.FRAMEBUFFER,W),!this.isInstanced)q.drawArrays(Q,0,this.verticesCount);else if(q instanceof WebGL2RenderingContext)q.drawArraysInstanced(Q,0,this.VERTICES,this.capacity);else{var V=q.getExtension("ANGLE_instanced_arrays");if(V)V.drawArraysInstancedANGLE(Q,0,this.VERTICES,this.capacity)}}}])}();var E9=function(J){function K(){return g(this,K),t(this,K,arguments)}return e(K,J),s(K,[{key:"kill",value:function(){nQ(K,"kill",this,3)([])}},{key:"process",value:function(Z,q,W){var V=q*this.STRIDE;if(W.hidden){for(var z=V+this.STRIDE;V<z;V++)this.array[V]=0;return}return this.processVisibleItem(hJ(Z),V,W)}}])}(iQ);var sJ=function(J){function K(){var Q;g(this,K);for(var Z=arguments.length,q=Array(Z),W=0;W<Z;W++)q[W]=arguments[W];return Q=t(this,K,[].concat(q)),F(Q,"drawLabel",void 0),Q}return e(K,J),s(K,[{key:"kill",value:function(){nQ(K,"kill",this,3)([])}},{key:"process",value:function(Z,q,W,V,z){var B=q*this.STRIDE;if(z.hidden||W.hidden||V.hidden){for(var H=B+this.STRIDE;B<H;B++)this.array[B]=0;return}return this.processVisibleItem(hJ(Z),B,W,V,z)}}])}(iQ);function D9(J,K){return function(){function Q(Z,q,W){g(this,Q),F(this,"drawLabel",K),this.programs=J.map(function(V){return new V(Z,q,W)})}return s(Q,[{key:"reallocate",value:function(q){this.programs.forEach(function(W){return W.reallocate(q)})}},{key:"process",value:function(q,W,V,z,B){this.programs.forEach(function(H){return H.process(q,W,V,z,B)})}},{key:"render",value:function(q){this.programs.forEach(function(W){return W.render(q)})}},{key:"kill",value:function(){this.programs.forEach(function(q){return q.kill()})}}])}()}function oQ(J,K,Q,Z,q){var{edgeLabelSize:W,edgeLabelFont:V,edgeLabelWeight:z}=q,B=q.edgeLabelColor.attribute?K[q.edgeLabelColor.attribute]||q.edgeLabelColor.color||"#000":q.edgeLabelColor.color,H=K.label;if(!H)return;J.fillStyle=B,J.font="".concat(z," ").concat(W,"px ").concat(V);var Y=Q.size,$=Z.size,X=Q.x,j=Q.y,w=Z.x,L=Z.y,A=(X+w)/2,G=(j+L)/2,k=w-X,T=L-j,P=Math.sqrt(k*k+T*T);if(P<Y+$)return;X+=k*Y/P,j+=T*Y/P,w-=k*$/P,L-=T*$/P,A=(X+w)/2,G=(j+L)/2,k=w-X,T=L-j,P=Math.sqrt(k*k+T*T);var O=J.measureText(H).width;if(O>P){var M="";H=H+M,O=J.measureText(H).width;while(O>P&&H.length>1)H=H.slice(0,-2)+M,O=J.measureText(H).width;if(H.length<4)return}var I;if(k>0)if(T>0)I=Math.acos(k/P);else I=Math.asin(T/P);else if(T>0)I=Math.acos(k/P)+Math.PI;else I=Math.asin(k/P)+Math.PI/2;J.save(),J.translate(A,G),J.rotate(I),J.fillText(H,-O/2,K.size/2+W),J.restore()}function nJ(J,K,Q){if(!K.label)return;var{labelSize:Z,labelFont:q,labelWeight:W}=Q,V=Q.labelColor.attribute?K[Q.labelColor.attribute]||Q.labelColor.color||"#000":Q.labelColor.color;J.fillStyle=V,J.font="".concat(W," ").concat(Z,"px ").concat(q),J.fillText(K.label,K.x+K.size+3,K.y+Z/3)}function rQ(J,K,Q){var{labelSize:Z,labelFont:q,labelWeight:W}=Q;J.font="".concat(W," ").concat(Z,"px ").concat(q),J.fillStyle="#FFF",J.shadowOffsetX=0,J.shadowOffsetY=0,J.shadowBlur=8,J.shadowColor="#000";var V=2;if(typeof K.label==="string"){var z=J.measureText(K.label).width,B=Math.round(z+5),H=Math.round(Z+2*V),Y=Math.max(K.size,Z/2)+V,$=Math.asin(H/2/Y),X=Math.sqrt(Math.abs(Math.pow(Y,2)-Math.pow(H/2,2)));J.beginPath(),J.moveTo(K.x+X,K.y+H/2),J.lineTo(K.x+Y+B,K.y+H/2),J.lineTo(K.x+Y+B,K.y-H/2),J.lineTo(K.x+X,K.y-H/2),J.arc(K.x,K.y,Y,$,-$),J.closePath(),J.fill()}else J.beginPath(),J.arc(K.x,K.y,K.size+V,0,Math.PI*2),J.closePath(),J.fill();J.shadowOffsetX=0,J.shadowOffsetY=0,J.shadowBlur=0,nJ(J,K,Q)}var _9=`
precision highp float;

varying vec4 v_color;
varying vec2 v_diffVector;
varying float v_radius;

uniform float u_correctionRatio;

const vec4 transparent = vec4(0.0, 0.0, 0.0, 0.0);

void main(void) {
  float border = u_correctionRatio * 2.0;
  float dist = length(v_diffVector) - v_radius + border;

  // No antialiasing for picking mode:
  #ifdef PICKING_MODE
  if (dist > border)
    gl_FragColor = transparent;
  else
    gl_FragColor = v_color;

  #else
  float t = 0.0;
  if (dist > border)
    t = 1.0;
  else if (dist > 0.0)
    t = dist / border;

  gl_FragColor = mix(v_color, transparent, t);
  #endif
}
`,u9=_9,h9=`
attribute vec4 a_id;
attribute vec4 a_color;
attribute vec2 a_position;
attribute float a_size;
attribute float a_angle;

uniform mat3 u_matrix;
uniform float u_sizeRatio;
uniform float u_correctionRatio;

varying vec4 v_color;
varying vec2 v_diffVector;
varying float v_radius;
varying float v_border;

const float bias = 255.0 / 254.0;

void main() {
  float size = a_size * u_correctionRatio / u_sizeRatio * 4.0;
  vec2 diffVector = size * vec2(cos(a_angle), sin(a_angle));
  vec2 position = a_position + diffVector;
  gl_Position = vec4(
    (u_matrix * vec3(position, 1)).xy,
    0,
    1
  );

  v_diffVector = diffVector;
  v_radius = size / 2.0;

  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  // For normal mode, we use the color:
  v_color = a_color;
  #endif

  v_color.a *= bias;
}
`,m9=h9,aQ=WebGLRenderingContext,lQ=aQ.UNSIGNED_BYTE,pJ=aQ.FLOAT,c9=["u_sizeRatio","u_correctionRatio","u_matrix"],a0=function(J){function K(){return g(this,K),t(this,K,arguments)}return e(K,J),s(K,[{key:"getDefinition",value:function(){return{VERTICES:3,VERTEX_SHADER_SOURCE:m9,FRAGMENT_SHADER_SOURCE:u9,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:c9,ATTRIBUTES:[{name:"a_position",size:2,type:pJ},{name:"a_size",size:1,type:pJ},{name:"a_color",size:4,type:lQ,normalized:!0},{name:"a_id",size:4,type:lQ,normalized:!0}],CONSTANT_ATTRIBUTES:[{name:"a_angle",size:1,type:pJ}],CONSTANT_DATA:[[K.ANGLE_1],[K.ANGLE_2],[K.ANGLE_3]]}}},{key:"processVisibleItem",value:function(Z,q,W){var V=this.array,z=p0(W.color);V[q++]=W.x,V[q++]=W.y,V[q++]=W.size,V[q++]=z,V[q++]=Z}},{key:"setUniforms",value:function(Z,q){var{gl:W,uniformLocations:V}=q,z=V.u_sizeRatio,B=V.u_correctionRatio,H=V.u_matrix;W.uniform1f(B,Z.correctionRatio),W.uniform1f(z,Z.sizeRatio),W.uniformMatrix3fv(H,!1,Z.matrix)}}])}(E9);F(a0,"ANGLE_1",0);F(a0,"ANGLE_2",2*Math.PI/3);F(a0,"ANGLE_3",4*Math.PI/3);var l9=`
precision mediump float;

varying vec4 v_color;

void main(void) {
  gl_FragColor = v_color;
}
`,p9=l9,g9=`
attribute vec2 a_position;
attribute vec2 a_normal;
attribute float a_radius;
attribute vec3 a_barycentric;

#ifdef PICKING_MODE
attribute vec4 a_id;
#else
attribute vec4 a_color;
#endif

uniform mat3 u_matrix;
uniform float u_sizeRatio;
uniform float u_correctionRatio;
uniform float u_minEdgeThickness;
uniform float u_lengthToThicknessRatio;
uniform float u_widenessToThicknessRatio;

varying vec4 v_color;

const float bias = 255.0 / 254.0;

void main() {
  float minThickness = u_minEdgeThickness;

  float normalLength = length(a_normal);
  vec2 unitNormal = a_normal / normalLength;

  // These first computations are taken from edge.vert.glsl and
  // edge.clamped.vert.glsl. Please read it to get better comments on what's
  // happening:
  float pixelsThickness = max(normalLength / u_sizeRatio, minThickness);
  float webGLThickness = pixelsThickness * u_correctionRatio;
  float webGLNodeRadius = a_radius * 2.0 * u_correctionRatio / u_sizeRatio;
  float webGLArrowHeadLength = webGLThickness * u_lengthToThicknessRatio * 2.0;
  float webGLArrowHeadThickness = webGLThickness * u_widenessToThicknessRatio;

  float da = a_barycentric.x;
  float db = a_barycentric.y;
  float dc = a_barycentric.z;

  vec2 delta = vec2(
      da * (webGLNodeRadius * unitNormal.y)
    + db * ((webGLNodeRadius + webGLArrowHeadLength) * unitNormal.y + webGLArrowHeadThickness * unitNormal.x)
    + dc * ((webGLNodeRadius + webGLArrowHeadLength) * unitNormal.y - webGLArrowHeadThickness * unitNormal.x),

      da * (-webGLNodeRadius * unitNormal.x)
    + db * (-(webGLNodeRadius + webGLArrowHeadLength) * unitNormal.x + webGLArrowHeadThickness * unitNormal.y)
    + dc * (-(webGLNodeRadius + webGLArrowHeadLength) * unitNormal.x - webGLArrowHeadThickness * unitNormal.y)
  );

  vec2 position = (u_matrix * vec3(a_position + delta, 1)).xy;

  gl_Position = vec4(position, 0, 1);

  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  // For normal mode, we use the color:
  v_color = a_color;
  #endif

  v_color.a *= bias;
}
`,s9=g9,tQ=WebGLRenderingContext,pQ=tQ.UNSIGNED_BYTE,zJ=tQ.FLOAT,n9=["u_matrix","u_sizeRatio","u_correctionRatio","u_minEdgeThickness","u_lengthToThicknessRatio","u_widenessToThicknessRatio"],eQ={extremity:"target",lengthToThicknessRatio:2.5,widenessToThicknessRatio:2};function J6(J){var K=v(v({},eQ),J||{});return function(Q){function Z(){return g(this,Z),t(this,Z,arguments)}return e(Z,Q),s(Z,[{key:"getDefinition",value:function(){return{VERTICES:3,VERTEX_SHADER_SOURCE:s9,FRAGMENT_SHADER_SOURCE:p9,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:n9,ATTRIBUTES:[{name:"a_position",size:2,type:zJ},{name:"a_normal",size:2,type:zJ},{name:"a_radius",size:1,type:zJ},{name:"a_color",size:4,type:pQ,normalized:!0},{name:"a_id",size:4,type:pQ,normalized:!0}],CONSTANT_ATTRIBUTES:[{name:"a_barycentric",size:3,type:zJ}],CONSTANT_DATA:[[1,0,0],[0,1,0],[0,0,1]]}}},{key:"processVisibleItem",value:function(W,V,z,B,H){if(K.extremity==="source"){var Y=[B,z];z=Y[0],B=Y[1]}var $=H.size||1,X=B.size||1,j=z.x,w=z.y,L=B.x,A=B.y,G=p0(H.color),k=L-j,T=A-w,P=k*k+T*T,O=0,M=0;if(P)P=1/Math.sqrt(P),O=-T*P*$,M=k*P*$;var I=this.array;I[V++]=L,I[V++]=A,I[V++]=-O,I[V++]=-M,I[V++]=X,I[V++]=G,I[V++]=W}},{key:"setUniforms",value:function(W,V){var{gl:z,uniformLocations:B}=V,H=B.u_matrix,Y=B.u_sizeRatio,$=B.u_correctionRatio,X=B.u_minEdgeThickness,j=B.u_lengthToThicknessRatio,w=B.u_widenessToThicknessRatio;z.uniformMatrix3fv(H,!1,W.matrix),z.uniform1f(Y,W.sizeRatio),z.uniform1f($,W.correctionRatio),z.uniform1f(X,W.minEdgeThickness),z.uniform1f(j,K.lengthToThicknessRatio),z.uniform1f(w,K.widenessToThicknessRatio)}}])}(sJ)}var a8=J6();var d9=`
precision mediump float;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_thickness;
varying float v_feather;

const vec4 transparent = vec4(0.0, 0.0, 0.0, 0.0);

void main(void) {
  // We only handle antialiasing for normal mode:
  #ifdef PICKING_MODE
  gl_FragColor = v_color;
  #else
  float dist = length(v_normal) * v_thickness;

  float t = smoothstep(
    v_thickness - v_feather,
    v_thickness,
    dist
  );

  gl_FragColor = mix(v_color, transparent, t);
  #endif
}
`,Q6=d9,i9=`
attribute vec4 a_id;
attribute vec4 a_color;
attribute vec2 a_normal;
attribute float a_normalCoef;
attribute vec2 a_positionStart;
attribute vec2 a_positionEnd;
attribute float a_positionCoef;
attribute float a_radius;
attribute float a_radiusCoef;

uniform mat3 u_matrix;
uniform float u_zoomRatio;
uniform float u_sizeRatio;
uniform float u_pixelRatio;
uniform float u_correctionRatio;
uniform float u_minEdgeThickness;
uniform float u_lengthToThicknessRatio;
uniform float u_feather;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_thickness;
varying float v_feather;

const float bias = 255.0 / 254.0;

void main() {
  float minThickness = u_minEdgeThickness;

  float radius = a_radius * a_radiusCoef;
  vec2 normal = a_normal * a_normalCoef;
  vec2 position = a_positionStart * (1.0 - a_positionCoef) + a_positionEnd * a_positionCoef;

  float normalLength = length(normal);
  vec2 unitNormal = normal / normalLength;

  // These first computations are taken from edge.vert.glsl. Please read it to
  // get better comments on what's happening:
  float pixelsThickness = max(normalLength, minThickness * u_sizeRatio);
  float webGLThickness = pixelsThickness * u_correctionRatio / u_sizeRatio;

  // Here, we move the point to leave space for the arrow head:
  float direction = sign(radius);
  float webGLNodeRadius = direction * radius * 2.0 * u_correctionRatio / u_sizeRatio;
  float webGLArrowHeadLength = webGLThickness * u_lengthToThicknessRatio * 2.0;

  vec2 compensationVector = vec2(-direction * unitNormal.y, direction * unitNormal.x) * (webGLNodeRadius + webGLArrowHeadLength);

  // Here is the proper position of the vertex
  gl_Position = vec4((u_matrix * vec3(position + unitNormal * webGLThickness + compensationVector, 1)).xy, 0, 1);

  v_thickness = webGLThickness / u_zoomRatio;

  v_normal = unitNormal;

  v_feather = u_feather * u_correctionRatio / u_zoomRatio / u_pixelRatio * 2.0;

  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  // For normal mode, we use the color:
  v_color = a_color;
  #endif

  v_color.a *= bias;
}
`,o9=i9,Z6=WebGLRenderingContext,gQ=Z6.UNSIGNED_BYTE,y0=Z6.FLOAT,r9=["u_matrix","u_zoomRatio","u_sizeRatio","u_correctionRatio","u_pixelRatio","u_feather","u_minEdgeThickness","u_lengthToThicknessRatio"],a9={lengthToThicknessRatio:eQ.lengthToThicknessRatio};function K6(J){var K=v(v({},a9),J||{});return function(Q){function Z(){return g(this,Z),t(this,Z,arguments)}return e(Z,Q),s(Z,[{key:"getDefinition",value:function(){return{VERTICES:6,VERTEX_SHADER_SOURCE:o9,FRAGMENT_SHADER_SOURCE:Q6,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:r9,ATTRIBUTES:[{name:"a_positionStart",size:2,type:y0},{name:"a_positionEnd",size:2,type:y0},{name:"a_normal",size:2,type:y0},{name:"a_color",size:4,type:gQ,normalized:!0},{name:"a_id",size:4,type:gQ,normalized:!0},{name:"a_radius",size:1,type:y0}],CONSTANT_ATTRIBUTES:[{name:"a_positionCoef",size:1,type:y0},{name:"a_normalCoef",size:1,type:y0},{name:"a_radiusCoef",size:1,type:y0}],CONSTANT_DATA:[[0,1,0],[0,-1,0],[1,1,1],[1,1,1],[0,-1,0],[1,-1,-1]]}}},{key:"processVisibleItem",value:function(W,V,z,B,H){var Y=H.size||1,$=z.x,X=z.y,j=B.x,w=B.y,L=p0(H.color),A=j-$,G=w-X,k=B.size||1,T=A*A+G*G,P=0,O=0;if(T)T=1/Math.sqrt(T),P=-G*T*Y,O=A*T*Y;var M=this.array;M[V++]=$,M[V++]=X,M[V++]=j,M[V++]=w,M[V++]=P,M[V++]=O,M[V++]=L,M[V++]=W,M[V++]=k}},{key:"setUniforms",value:function(W,V){var{gl:z,uniformLocations:B}=V,H=B.u_matrix,Y=B.u_zoomRatio,$=B.u_feather,X=B.u_pixelRatio,j=B.u_correctionRatio,w=B.u_sizeRatio,L=B.u_minEdgeThickness,A=B.u_lengthToThicknessRatio;z.uniformMatrix3fv(H,!1,W.matrix),z.uniform1f(Y,W.zoomRatio),z.uniform1f(w,W.sizeRatio),z.uniform1f(j,W.correctionRatio),z.uniform1f(X,W.pixelRatio),z.uniform1f($,W.antiAliasingFeather),z.uniform1f(L,W.minEdgeThickness),z.uniform1f(A,K.lengthToThicknessRatio)}}])}(sJ)}var t8=K6();function t9(J){return D9([K6(J),J6(J)])}var e9=t9(),q6=e9,J8=`
attribute vec4 a_id;
attribute vec4 a_color;
attribute vec2 a_normal;
attribute float a_normalCoef;
attribute vec2 a_positionStart;
attribute vec2 a_positionEnd;
attribute float a_positionCoef;

uniform mat3 u_matrix;
uniform float u_sizeRatio;
uniform float u_zoomRatio;
uniform float u_pixelRatio;
uniform float u_correctionRatio;
uniform float u_minEdgeThickness;
uniform float u_feather;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_thickness;
varying float v_feather;

const float bias = 255.0 / 254.0;

void main() {
  float minThickness = u_minEdgeThickness;

  vec2 normal = a_normal * a_normalCoef;
  vec2 position = a_positionStart * (1.0 - a_positionCoef) + a_positionEnd * a_positionCoef;

  float normalLength = length(normal);
  vec2 unitNormal = normal / normalLength;

  // We require edges to be at least "minThickness" pixels thick *on screen*
  // (so we need to compensate the size ratio):
  float pixelsThickness = max(normalLength, minThickness * u_sizeRatio);

  // Then, we need to retrieve the normalized thickness of the edge in the WebGL
  // referential (in a ([0, 1], [0, 1]) space), using our "magic" correction
  // ratio:
  float webGLThickness = pixelsThickness * u_correctionRatio / u_sizeRatio;

  // Here is the proper position of the vertex
  gl_Position = vec4((u_matrix * vec3(position + unitNormal * webGLThickness, 1)).xy, 0, 1);

  // For the fragment shader though, we need a thickness that takes the "magic"
  // correction ratio into account (as in webGLThickness), but so that the
  // antialiasing effect does not depend on the zoom level. So here's yet
  // another thickness version:
  v_thickness = webGLThickness / u_zoomRatio;

  v_normal = unitNormal;

  v_feather = u_feather * u_correctionRatio / u_zoomRatio / u_pixelRatio * 2.0;

  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  // For normal mode, we use the color:
  v_color = a_color;
  #endif

  v_color.a *= bias;
}
`,Q8=J8,W6=WebGLRenderingContext,sQ=W6.UNSIGNED_BYTE,r0=W6.FLOAT,Z8=["u_matrix","u_zoomRatio","u_sizeRatio","u_correctionRatio","u_pixelRatio","u_feather","u_minEdgeThickness"],V6=function(J){function K(){return g(this,K),t(this,K,arguments)}return e(K,J),s(K,[{key:"getDefinition",value:function(){return{VERTICES:6,VERTEX_SHADER_SOURCE:Q8,FRAGMENT_SHADER_SOURCE:Q6,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:Z8,ATTRIBUTES:[{name:"a_positionStart",size:2,type:r0},{name:"a_positionEnd",size:2,type:r0},{name:"a_normal",size:2,type:r0},{name:"a_color",size:4,type:sQ,normalized:!0},{name:"a_id",size:4,type:sQ,normalized:!0}],CONSTANT_ATTRIBUTES:[{name:"a_positionCoef",size:1,type:r0},{name:"a_normalCoef",size:1,type:r0}],CONSTANT_DATA:[[0,1],[0,-1],[1,1],[1,1],[0,-1],[1,-1]]}}},{key:"processVisibleItem",value:function(Z,q,W,V,z){var B=z.size||1,H=W.x,Y=W.y,$=V.x,X=V.y,j=p0(z.color),w=$-H,L=X-Y,A=w*w+L*L,G=0,k=0;if(A)A=1/Math.sqrt(A),G=-L*A*B,k=w*A*B;var T=this.array;T[q++]=H,T[q++]=Y,T[q++]=$,T[q++]=X,T[q++]=G,T[q++]=k,T[q++]=j,T[q++]=Z}},{key:"setUniforms",value:function(Z,q){var{gl:W,uniformLocations:V}=q,z=V.u_matrix,B=V.u_zoomRatio,H=V.u_feather,Y=V.u_pixelRatio,$=V.u_correctionRatio,X=V.u_sizeRatio,j=V.u_minEdgeThickness;W.uniformMatrix3fv(z,!1,Z.matrix),W.uniform1f(B,Z.zoomRatio),W.uniform1f(X,Z.sizeRatio),W.uniform1f($,Z.correctionRatio),W.uniform1f(Y,Z.pixelRatio),W.uniform1f(H,Z.antiAliasingFeather),W.uniform1f(j,Z.minEdgeThickness)}}])}(sJ);var BJ=function(J){function K(){var Q;return g(this,K),Q=t(this,K),Q.rawEmitter=Q,Q}return e(K,J),s(K)}(w0);var H6=TJ(qJ(),1);var K8=function(K){return K},q8=function(K){return K*K},W8=function(K){return K*(2-K)},V8=function(K){if((K*=2)<1)return 0.5*K*K;return-0.5*(--K*(K-2)-1)},z8=function(K){return K*K*K},B8=function(K){return--K*K*K+1},H8=function(K){if((K*=2)<1)return 0.5*K*K*K;return 0.5*((K-=2)*K*K+2)},$6={linear:K8,quadraticIn:q8,quadraticOut:W8,quadraticInOut:V8,cubicIn:z8,cubicOut:B8,cubicInOut:H8},Y6={easing:"quadraticInOut",duration:150};function H0(){return Float32Array.of(1,0,0,0,1,0,0,0,1)}function HJ(J,K,Q){return J[0]=K,J[4]=typeof Q==="number"?Q:K,J}function z6(J,K){var Q=Math.sin(K),Z=Math.cos(K);return J[0]=Z,J[1]=Q,J[3]=-Q,J[4]=Z,J}function B6(J,K,Q){return J[6]=K,J[7]=Q,J}function G0(J,K){var Q=J[0],Z=J[1],q=J[2],W=J[3],V=J[4],z=J[5],B=J[6],H=J[7],Y=J[8],$=K[0],X=K[1],j=K[2],w=K[3],L=K[4],A=K[5],G=K[6],k=K[7],T=K[8];return J[0]=$*Q+X*W+j*B,J[1]=$*Z+X*V+j*H,J[2]=$*q+X*z+j*Y,J[3]=w*Q+L*W+A*B,J[4]=w*Z+L*V+A*H,J[5]=w*q+L*z+A*Y,J[6]=G*Q+k*W+T*B,J[7]=G*Z+k*V+T*H,J[8]=G*q+k*z+T*Y,J}function $J(J,K){var Q=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,Z=J[0],q=J[1],W=J[3],V=J[4],z=J[6],B=J[7],H=K.x,Y=K.y;return{x:H*Z+Y*W+z*Q,y:H*q+Y*V+B*Q}}function $8(J,K){var Q=J.height/J.width,Z=K.height/K.width;if(Q<1&&Z>1||Q>1&&Z<1)return 1;return Math.min(Math.max(Z,1/Z),Math.max(1/Q,Q))}function g0(J,K,Q,Z,q){var{angle:W,ratio:V,x:z,y:B}=J,H=K.width,Y=K.height,$=H0(),X=Math.min(H,Y)-2*Z,j=$8(K,Q);if(!q)G0($,HJ(H0(),2*(X/H)*j,2*(X/Y)*j)),G0($,z6(H0(),-W)),G0($,HJ(H0(),1/V)),G0($,B6(H0(),-z,-B));else G0($,B6(H0(),z,B)),G0($,HJ(H0(),V)),G0($,z6(H0(),W)),G0($,HJ(H0(),H/X/2/j,Y/X/2/j));return $}function X6(J,K,Q){var Z=$J(J,{x:Math.cos(K.angle),y:Math.sin(K.angle)},0),q=Z.x,W=Z.y;return 1/Math.sqrt(Math.pow(q,2)+Math.pow(W,2))/Q.width}function j6(J){if(!J.order)return{x:[0,1],y:[0,1]};var K=1/0,Q=-1/0,Z=1/0,q=-1/0;return J.forEachNode(function(W,V){var{x:z,y:B}=V;if(z<K)K=z;if(z>Q)Q=z;if(B<Z)Z=B;if(B>q)q=B}),{x:[K,Q],y:[Z,q]}}function U6(J){if(!H6.default(J))throw Error("Sigma: invalid graph instance.");J.forEachNode(function(K,Q){if(!Number.isFinite(Q.x)||!Number.isFinite(Q.y))throw Error("Sigma: Coordinates of node ".concat(K," are invalid. A node must have a numeric 'x' and 'y' attribute."))})}function w6(J,K,Q){var Z=document.createElement(J);if(K)for(var q in K)Z.style[q]=K[q];if(Q)for(var W in Q)Z.setAttribute(W,Q[W]);return Z}function dJ(){if(typeof window.devicePixelRatio<"u")return window.devicePixelRatio;return 1}function iJ(J,K,Q){return Q.sort(function(Z,q){var W=K(Z)||0,V=K(q)||0;if(W<V)return-1;if(W>V)return 1;return 0})}function oJ(J){var K=v0(J.x,2),Q=K[0],Z=K[1],q=v0(J.y,2),W=q[0],V=q[1],z=Math.max(Z-Q,V-W),B=(Z+Q)/2,H=(V+W)/2;if(z===0||Math.abs(z)===1/0||isNaN(z))z=1;if(isNaN(B))B=0;if(isNaN(H))H=0;var Y=function(X){return{x:0.5+(X.x-B)/z,y:0.5+(X.y-H)/z}};return Y.applyTo=function($){$.x=0.5+($.x-B)/z,$.y=0.5+($.y-H)/z},Y.inverse=function($){return{x:B+z*($.x-0.5),y:H+z*($.y-0.5)}},Y.ratio=z,Y}function YJ(J){return YJ=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(K){return typeof K}:function(K){return K&&typeof Symbol=="function"&&K.constructor===Symbol&&K!==Symbol.prototype?"symbol":typeof K},YJ(J)}function rJ(J,K){var Q=K.size;if(Q===0)return;var Z=J.length;J.length+=Q;var q=0;K.forEach(function(W){J[Z+q]=W,q++})}function XJ(J){J=J||{};for(var K=0,Q=arguments.length<=1?0:arguments.length-1;K<Q;K++){var Z=K+1<1||arguments.length<=K+1?void 0:arguments[K+1];if(!Z)continue;Object.assign(J,Z)}return J}var jJ={hideEdgesOnMove:!1,hideLabelsOnMove:!1,renderLabels:!0,renderEdgeLabels:!1,enableEdgeEvents:!1,defaultNodeColor:"#999",defaultNodeType:"circle",defaultEdgeColor:"#ccc",defaultEdgeType:"line",labelFont:"Arial",labelSize:14,labelWeight:"normal",labelColor:{color:"#000"},edgeLabelFont:"Arial",edgeLabelSize:14,edgeLabelWeight:"normal",edgeLabelColor:{attribute:"color"},stagePadding:30,defaultDrawEdgeLabel:oQ,defaultDrawNodeLabel:nJ,defaultDrawNodeHover:rQ,minEdgeThickness:1.7,antiAliasingFeather:1,dragTimeout:100,draggedEventsTolerance:3,inertiaDuration:200,inertiaRatio:3,zoomDuration:250,zoomingRatio:1.7,doubleClickTimeout:300,doubleClickZoomingRatio:2.2,doubleClickZoomingDuration:200,tapMoveTolerance:10,zoomToSizeRatioFunction:Math.sqrt,itemSizesReference:"screen",autoRescale:!0,autoCenter:!0,labelDensity:1,labelGridCellSize:100,labelRenderedSizeThreshold:6,nodeReducer:null,edgeReducer:null,zIndex:!1,minCameraRatio:null,maxCameraRatio:null,enableCameraZooming:!0,enableCameraPanning:!0,enableCameraRotation:!0,cameraPanBoundaries:null,allowInvalidContainer:!1,nodeProgramClasses:{},nodeHoverProgramClasses:{},edgeProgramClasses:{}},Y8={circle:a0},X8={arrow:q6,line:V6};function UJ(J){if(typeof J.labelDensity!=="number"||J.labelDensity<0)throw Error("Settings: invalid `labelDensity`. Expecting a positive number.");var{minCameraRatio:K,maxCameraRatio:Q}=J;if(typeof K==="number"&&typeof Q==="number"&&Q<K)throw Error("Settings: invalid camera ratio boundaries. Expecting `maxCameraRatio` to be greater than `minCameraRatio`.")}function F6(J){var K=XJ({},jJ,J);return K.nodeProgramClasses=XJ({},Y8,K.nodeProgramClasses),K.edgeProgramClasses=XJ({},X8,K.edgeProgramClasses),K}var LZ=TJ(qJ(),1),wJ=1.5,L6=function(J){function K(){var Q;return g(this,K),Q=t(this,K),F(Q,"x",0.5),F(Q,"y",0.5),F(Q,"angle",0),F(Q,"ratio",1),F(Q,"minRatio",null),F(Q,"maxRatio",null),F(Q,"enabledZooming",!0),F(Q,"enabledPanning",!0),F(Q,"enabledRotation",!0),F(Q,"clean",null),F(Q,"nextFrame",null),F(Q,"previousState",null),F(Q,"enabled",!0),Q.previousState=Q.getState(),Q}return e(K,J),s(K,[{key:"enable",value:function(){return this.enabled=!0,this}},{key:"disable",value:function(){return this.enabled=!1,this}},{key:"getState",value:function(){return{x:this.x,y:this.y,angle:this.angle,ratio:this.ratio}}},{key:"hasState",value:function(Z){return this.x===Z.x&&this.y===Z.y&&this.ratio===Z.ratio&&this.angle===Z.angle}},{key:"getPreviousState",value:function(){var Z=this.previousState;if(!Z)return null;return{x:Z.x,y:Z.y,angle:Z.angle,ratio:Z.ratio}}},{key:"getBoundedRatio",value:function(Z){var q=Z;if(typeof this.minRatio==="number")q=Math.max(q,this.minRatio);if(typeof this.maxRatio==="number")q=Math.min(q,this.maxRatio);return q}},{key:"validateState",value:function(Z){var q={};if(this.enabledPanning&&typeof Z.x==="number")q.x=Z.x;if(this.enabledPanning&&typeof Z.y==="number")q.y=Z.y;if(this.enabledZooming&&typeof Z.ratio==="number")q.ratio=this.getBoundedRatio(Z.ratio);if(this.enabledRotation&&typeof Z.angle==="number")q.angle=Z.angle;return this.clean?this.clean(v(v({},this.getState()),q)):q}},{key:"isAnimated",value:function(){return!!this.nextFrame}},{key:"setState",value:function(Z){if(!this.enabled)return this;this.previousState=this.getState();var q=this.validateState(Z);if(typeof q.x==="number")this.x=q.x;if(typeof q.y==="number")this.y=q.y;if(typeof q.ratio==="number")this.ratio=q.ratio;if(typeof q.angle==="number")this.angle=q.angle;if(!this.hasState(this.previousState))this.emit("updated",this.getState());return this}},{key:"updateState",value:function(Z){return this.setState(Z(this.getState())),this}},{key:"animate",value:function(Z){var q=this,W=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},V=arguments.length>2?arguments[2]:void 0;if(!V)return new Promise(function(j){return q.animate(Z,W,j)});if(!this.enabled)return;var z=v(v({},Y6),W),B=this.validateState(Z),H=typeof z.easing==="function"?z.easing:$6[z.easing],Y=Date.now(),$=this.getState(),X=function(){var w=(Date.now()-Y)/z.duration;if(w>=1){if(q.nextFrame=null,q.setState(B),q.animationCallback)q.animationCallback.call(null),q.animationCallback=void 0;return}var L=H(w),A={};if(typeof B.x==="number")A.x=$.x+(B.x-$.x)*L;if(typeof B.y==="number")A.y=$.y+(B.y-$.y)*L;if(q.enabledRotation&&typeof B.angle==="number")A.angle=$.angle+(B.angle-$.angle)*L;if(typeof B.ratio==="number")A.ratio=$.ratio+(B.ratio-$.ratio)*L;q.setState(A),q.nextFrame=requestAnimationFrame(X)};if(this.nextFrame){if(cancelAnimationFrame(this.nextFrame),this.animationCallback)this.animationCallback.call(null);this.nextFrame=requestAnimationFrame(X)}else X();this.animationCallback=V}},{key:"animatedZoom",value:function(Z){if(!Z)return this.animate({ratio:this.ratio/wJ});if(typeof Z==="number")return this.animate({ratio:this.ratio/Z});return this.animate({ratio:this.ratio/(Z.factor||wJ)},Z)}},{key:"animatedUnzoom",value:function(Z){if(!Z)return this.animate({ratio:this.ratio*wJ});if(typeof Z==="number")return this.animate({ratio:this.ratio*Z});return this.animate({ratio:this.ratio*(Z.factor||wJ)},Z)}},{key:"animatedReset",value:function(Z){return this.animate({x:0.5,y:0.5,ratio:1,angle:0},Z)}},{key:"copy",value:function(){return K.from(this.getState())}}],[{key:"from",value:function(Z){var q=new K;return q.setState(Z)}}])}(BJ);function U0(J,K){var Q=K.getBoundingClientRect();return{x:J.clientX-Q.left,y:J.clientY-Q.top}}function k0(J,K){var Q=v(v({},U0(J,K)),{},{sigmaDefaultPrevented:!1,preventSigmaDefault:function(){Q.sigmaDefaultPrevented=!0},original:J});return Q}function t0(J){var K="x"in J?J:v(v({},J.touches[0]||J.previousTouches[0]),{},{original:J.original,sigmaDefaultPrevented:J.sigmaDefaultPrevented,preventSigmaDefault:function(){J.sigmaDefaultPrevented=!0,K.sigmaDefaultPrevented=!0}});return K}function j8(J,K){return v(v({},k0(J,K)),{},{delta:k6(J)})}var U8=2;function FJ(J){var K=[];for(var Q=0,Z=Math.min(J.length,U8);Q<Z;Q++)K.push(J[Q]);return K}function e0(J,K,Q){var Z={touches:FJ(J.touches).map(function(q){return U0(q,Q)}),previousTouches:K.map(function(q){return U0(q,Q)}),sigmaDefaultPrevented:!1,preventSigmaDefault:function(){Z.sigmaDefaultPrevented=!0},original:J};return Z}function k6(J){if(typeof J.deltaY<"u")return J.deltaY*-3/360;if(typeof J.detail<"u")return J.detail/-9;throw Error("Captor: could not extract delta from event.")}var S6=function(J){function K(Q,Z){var q;return g(this,K),q=t(this,K),q.container=Q,q.renderer=Z,q}return e(K,J),s(K)}(BJ),w8=["doubleClickTimeout","doubleClickZoomingDuration","doubleClickZoomingRatio","dragTimeout","draggedEventsTolerance","inertiaDuration","inertiaRatio","zoomDuration","zoomingRatio"],F8=w8.reduce(function(J,K){return v(v({},J),{},F({},K,jJ[K]))},{}),L8=function(J){function K(Q,Z){var q;return g(this,K),q=t(this,K,[Q,Z]),F(q,"enabled",!0),F(q,"draggedEvents",0),F(q,"downStartTime",null),F(q,"lastMouseX",null),F(q,"lastMouseY",null),F(q,"isMouseDown",!1),F(q,"isMoving",!1),F(q,"movingTimeout",null),F(q,"startCameraState",null),F(q,"clicks",0),F(q,"doubleClickTimeout",null),F(q,"currentWheelDirection",0),F(q,"settings",F8),q.handleClick=q.handleClick.bind(q),q.handleRightClick=q.handleRightClick.bind(q),q.handleDown=q.handleDown.bind(q),q.handleUp=q.handleUp.bind(q),q.handleMove=q.handleMove.bind(q),q.handleWheel=q.handleWheel.bind(q),q.handleLeave=q.handleLeave.bind(q),q.handleEnter=q.handleEnter.bind(q),Q.addEventListener("click",q.handleClick,{capture:!1}),Q.addEventListener("contextmenu",q.handleRightClick,{capture:!1}),Q.addEventListener("mousedown",q.handleDown,{capture:!1}),Q.addEventListener("wheel",q.handleWheel,{capture:!1}),Q.addEventListener("mouseleave",q.handleLeave,{capture:!1}),Q.addEventListener("mouseenter",q.handleEnter,{capture:!1}),document.addEventListener("mousemove",q.handleMove,{capture:!1}),document.addEventListener("mouseup",q.handleUp,{capture:!1}),q}return e(K,J),s(K,[{key:"kill",value:function(){var Z=this.container;Z.removeEventListener("click",this.handleClick),Z.removeEventListener("contextmenu",this.handleRightClick),Z.removeEventListener("mousedown",this.handleDown),Z.removeEventListener("wheel",this.handleWheel),Z.removeEventListener("mouseleave",this.handleLeave),Z.removeEventListener("mouseenter",this.handleEnter),document.removeEventListener("mousemove",this.handleMove),document.removeEventListener("mouseup",this.handleUp)}},{key:"handleClick",value:function(Z){var q=this;if(!this.enabled)return;if(this.clicks++,this.clicks===2){if(this.clicks=0,typeof this.doubleClickTimeout==="number")clearTimeout(this.doubleClickTimeout),this.doubleClickTimeout=null;return this.handleDoubleClick(Z)}if(setTimeout(function(){q.clicks=0,q.doubleClickTimeout=null},this.settings.doubleClickTimeout),this.draggedEvents<this.settings.draggedEventsTolerance)this.emit("click",k0(Z,this.container))}},{key:"handleRightClick",value:function(Z){if(!this.enabled)return;this.emit("rightClick",k0(Z,this.container))}},{key:"handleDoubleClick",value:function(Z){if(!this.enabled)return;Z.preventDefault(),Z.stopPropagation();var q=k0(Z,this.container);if(this.emit("doubleClick",q),q.sigmaDefaultPrevented)return;var W=this.renderer.getCamera(),V=W.getBoundedRatio(W.getState().ratio/this.settings.doubleClickZoomingRatio);W.animate(this.renderer.getViewportZoomedState(U0(Z,this.container),V),{easing:"quadraticInOut",duration:this.settings.doubleClickZoomingDuration})}},{key:"handleDown",value:function(Z){if(!this.enabled)return;if(Z.button===0){this.startCameraState=this.renderer.getCamera().getState();var q=U0(Z,this.container),W=q.x,V=q.y;this.lastMouseX=W,this.lastMouseY=V,this.draggedEvents=0,this.downStartTime=Date.now(),this.isMouseDown=!0}this.emit("mousedown",k0(Z,this.container))}},{key:"handleUp",value:function(Z){var q=this;if(!this.enabled||!this.isMouseDown)return;var W=this.renderer.getCamera();if(this.isMouseDown=!1,typeof this.movingTimeout==="number")clearTimeout(this.movingTimeout),this.movingTimeout=null;var V=U0(Z,this.container),z=V.x,B=V.y,H=W.getState(),Y=W.getPreviousState()||{x:0,y:0};if(this.isMoving)W.animate({x:H.x+this.settings.inertiaRatio*(H.x-Y.x),y:H.y+this.settings.inertiaRatio*(H.y-Y.y)},{duration:this.settings.inertiaDuration,easing:"quadraticOut"});else if(this.lastMouseX!==z||this.lastMouseY!==B)W.setState({x:H.x,y:H.y});this.isMoving=!1,setTimeout(function(){var $=q.draggedEvents>0;if(q.draggedEvents=0,$&&q.renderer.getSetting("hideEdgesOnMove"))q.renderer.refresh()},0),this.emit("mouseup",k0(Z,this.container))}},{key:"handleMove",value:function(Z){var q=this;if(!this.enabled)return;var W=k0(Z,this.container);if(this.emit("mousemovebody",W),Z.target===this.container||Z.composedPath()[0]===this.container)this.emit("mousemove",W);if(W.sigmaDefaultPrevented)return;if(this.isMouseDown){if(this.isMoving=!0,this.draggedEvents++,typeof this.movingTimeout==="number")clearTimeout(this.movingTimeout);this.movingTimeout=window.setTimeout(function(){q.movingTimeout=null,q.isMoving=!1},this.settings.dragTimeout);var V=this.renderer.getCamera(),z=U0(Z,this.container),B=z.x,H=z.y,Y=this.renderer.viewportToFramedGraph({x:this.lastMouseX,y:this.lastMouseY}),$=this.renderer.viewportToFramedGraph({x:B,y:H}),X=Y.x-$.x,j=Y.y-$.y,w=V.getState(),L=w.x+X,A=w.y+j;V.setState({x:L,y:A}),this.lastMouseX=B,this.lastMouseY=H,Z.preventDefault(),Z.stopPropagation()}}},{key:"handleLeave",value:function(Z){this.emit("mouseleave",k0(Z,this.container))}},{key:"handleEnter",value:function(Z){this.emit("mouseenter",k0(Z,this.container))}},{key:"handleWheel",value:function(Z){var q=this,W=this.renderer.getCamera();if(!this.enabled||!W.enabledZooming)return;var V=k6(Z);if(!V)return;var z=j8(Z,this.container);if(this.emit("wheel",z),z.sigmaDefaultPrevented){Z.preventDefault(),Z.stopPropagation();return}var B=W.getState().ratio,H=V>0?1/this.settings.zoomingRatio:this.settings.zoomingRatio,Y=W.getBoundedRatio(B*H),$=V>0?1:-1,X=Date.now();if(B===Y)return;if(Z.preventDefault(),Z.stopPropagation(),this.currentWheelDirection===$&&this.lastWheelTriggerTime&&X-this.lastWheelTriggerTime<this.settings.zoomDuration/5)return;W.animate(this.renderer.getViewportZoomedState(U0(Z,this.container),Y),{easing:"quadraticOut",duration:this.settings.zoomDuration},function(){q.currentWheelDirection=0}),this.currentWheelDirection=$,this.lastWheelTriggerTime=X}},{key:"setSettings",value:function(Z){this.settings=Z}}])}(S6),T8=["dragTimeout","inertiaDuration","inertiaRatio","doubleClickTimeout","doubleClickZoomingRatio","doubleClickZoomingDuration","tapMoveTolerance"],A8=T8.reduce(function(J,K){return v(v({},J),{},F({},K,jJ[K]))},{}),C8=function(J){function K(Q,Z){var q;return g(this,K),q=t(this,K,[Q,Z]),F(q,"enabled",!0),F(q,"isMoving",!1),F(q,"hasMoved",!1),F(q,"touchMode",0),F(q,"startTouchesPositions",[]),F(q,"lastTouches",[]),F(q,"lastTap",null),F(q,"settings",A8),q.handleStart=q.handleStart.bind(q),q.handleLeave=q.handleLeave.bind(q),q.handleMove=q.handleMove.bind(q),Q.addEventListener("touchstart",q.handleStart,{capture:!1}),Q.addEventListener("touchcancel",q.handleLeave,{capture:!1}),document.addEventListener("touchend",q.handleLeave,{capture:!1,passive:!1}),document.addEventListener("touchmove",q.handleMove,{capture:!1,passive:!1}),q}return e(K,J),s(K,[{key:"kill",value:function(){var Z=this.container;Z.removeEventListener("touchstart",this.handleStart),Z.removeEventListener("touchcancel",this.handleLeave),document.removeEventListener("touchend",this.handleLeave),document.removeEventListener("touchmove",this.handleMove)}},{key:"getDimensions",value:function(){return{width:this.container.offsetWidth,height:this.container.offsetHeight}}},{key:"handleStart",value:function(Z){var q=this;if(!this.enabled)return;Z.preventDefault();var W=FJ(Z.touches);if(this.touchMode=W.length,this.startCameraState=this.renderer.getCamera().getState(),this.startTouchesPositions=W.map(function(j){return U0(j,q.container)}),this.touchMode===2){var V=v0(this.startTouchesPositions,2),z=V[0],B=z.x,H=z.y,Y=V[1],$=Y.x,X=Y.y;this.startTouchesAngle=Math.atan2(X-H,$-B),this.startTouchesDistance=Math.sqrt(Math.pow($-B,2)+Math.pow(X-H,2))}this.emit("touchdown",e0(Z,this.lastTouches,this.container)),this.lastTouches=W,this.lastTouchesPositions=this.startTouchesPositions}},{key:"handleLeave",value:function(Z){if(!this.enabled||!this.startTouchesPositions.length)return;if(Z.cancelable)Z.preventDefault();if(this.movingTimeout)this.isMoving=!1,clearTimeout(this.movingTimeout);switch(this.touchMode){case 2:if(Z.touches.length===1){this.handleStart(Z),Z.preventDefault();break}case 1:if(this.isMoving){var q=this.renderer.getCamera(),W=q.getState(),V=q.getPreviousState()||{x:0,y:0};q.animate({x:W.x+this.settings.inertiaRatio*(W.x-V.x),y:W.y+this.settings.inertiaRatio*(W.y-V.y)},{duration:this.settings.inertiaDuration,easing:"quadraticOut"})}this.hasMoved=!1,this.isMoving=!1,this.touchMode=0;break}if(this.emit("touchup",e0(Z,this.lastTouches,this.container)),!Z.touches.length){var z=U0(this.lastTouches[0],this.container),B=this.startTouchesPositions[0],H=Math.pow(z.x-B.x,2)+Math.pow(z.y-B.y,2);if(!Z.touches.length&&H<Math.pow(this.settings.tapMoveTolerance,2))if(this.lastTap&&Date.now()-this.lastTap.time<this.settings.doubleClickTimeout){var Y=e0(Z,this.lastTouches,this.container);if(this.emit("doubletap",Y),this.lastTap=null,!Y.sigmaDefaultPrevented){var $=this.renderer.getCamera(),X=$.getBoundedRatio($.getState().ratio/this.settings.doubleClickZoomingRatio);$.animate(this.renderer.getViewportZoomedState(z,X),{easing:"quadraticInOut",duration:this.settings.doubleClickZoomingDuration})}}else{var j=e0(Z,this.lastTouches,this.container);this.emit("tap",j),this.lastTap={time:Date.now(),position:j.touches[0]||j.previousTouches[0]}}}this.lastTouches=FJ(Z.touches),this.startTouchesPositions=[]}},{key:"handleMove",value:function(Z){var q=this;if(!this.enabled||!this.startTouchesPositions.length)return;Z.preventDefault();var W=FJ(Z.touches),V=W.map(function(K0){return U0(K0,q.container)}),z=this.lastTouches;this.lastTouches=W,this.lastTouchesPositions=V;var B=e0(Z,z,this.container);if(this.emit("touchmove",B),B.sigmaDefaultPrevented)return;if(this.hasMoved||(this.hasMoved=V.some(function(K0,Y0){var r=q.startTouchesPositions[Y0];return r&&(K0.x!==r.x||K0.y!==r.y)})),!this.hasMoved)return;if(this.isMoving=!0,this.movingTimeout)clearTimeout(this.movingTimeout);this.movingTimeout=window.setTimeout(function(){q.isMoving=!1},this.settings.dragTimeout);var H=this.renderer.getCamera(),Y=this.startCameraState,$=this.renderer.getSetting("stagePadding");switch(this.touchMode){case 1:{var X=this.renderer.viewportToFramedGraph((this.startTouchesPositions||[])[0]),j=X.x,w=X.y,L=this.renderer.viewportToFramedGraph(V[0]),A=L.x,G=L.y;H.setState({x:Y.x+j-A,y:Y.y+w-G});break}case 2:{var k={x:0.5,y:0.5,angle:0,ratio:1},T=V[0],P=T.x,O=T.y,M=V[1],I=M.x,R=M.y,U=Math.atan2(R-O,I-P)-this.startTouchesAngle,u=Math.hypot(R-O,I-P)/this.startTouchesDistance,c=H.getBoundedRatio(Y.ratio/u);k.ratio=c,k.angle=Y.angle+U;var h=this.getDimensions(),J0=this.renderer.viewportToFramedGraph((this.startTouchesPositions||[])[0],{cameraState:Y}),E=Math.min(h.width,h.height)-2*$,n=E/h.width,q0=E/h.height,T0=c/E,$0=P-E/2/n,W0=O-E/2/q0,Q0=[$0*Math.cos(-k.angle)-W0*Math.sin(-k.angle),W0*Math.cos(-k.angle)+$0*Math.sin(-k.angle)];$0=Q0[0],W0=Q0[1],k.x=J0.x-$0*T0,k.y=J0.y+W0*T0,H.setState(k);break}}}},{key:"setSettings",value:function(Z){this.settings=Z}}])}(S6);function P8(J){if(Array.isArray(J))return VJ(J)}function I8(J){if(typeof Symbol<"u"&&J[Symbol.iterator]!=null||J["@@iterator"]!=null)return Array.from(J)}function k8(){throw TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function T6(J){return P8(J)||I8(J)||uJ(J)||k8()}function S8(J,K){if(J==null)return{};var Q={};for(var Z in J)if({}.hasOwnProperty.call(J,Z)){if(K.indexOf(Z)!==-1)continue;Q[Z]=J[Z]}return Q}function aJ(J,K){if(J==null)return{};var Q,Z,q=S8(J,K);if(Object.getOwnPropertySymbols){var W=Object.getOwnPropertySymbols(J);for(Z=0;Z<W.length;Z++)Q=W[Z],K.indexOf(Q)===-1&&{}.propertyIsEnumerable.call(J,Q)&&(q[Q]=J[Q])}return q}var A6=function(){function J(K,Q){g(this,J),this.key=K,this.size=Q}return s(J,null,[{key:"compare",value:function(Q,Z){if(Q.size>Z.size)return-1;if(Q.size<Z.size)return 1;if(Q.key>Z.key)return 1;return-1}}])}(),C6=function(){function J(){g(this,J),F(this,"width",0),F(this,"height",0),F(this,"cellSize",0),F(this,"columns",0),F(this,"rows",0),F(this,"cells",{})}return s(J,[{key:"resizeAndClear",value:function(Q,Z){this.width=Q.width,this.height=Q.height,this.cellSize=Z,this.columns=Math.ceil(Q.width/Z),this.rows=Math.ceil(Q.height/Z),this.cells={}}},{key:"getIndex",value:function(Q){var Z=Math.floor(Q.x/this.cellSize),q=Math.floor(Q.y/this.cellSize);return q*this.columns+Z}},{key:"add",value:function(Q,Z,q){var W=new A6(Q,Z),V=this.getIndex(q),z=this.cells[V];if(!z)z=[],this.cells[V]=z;z.push(W)}},{key:"organize",value:function(){for(var Q in this.cells){var Z=this.cells[Q];Z.sort(A6.compare)}}},{key:"getLabelsToDisplay",value:function(Q,Z){var q=this.cellSize*this.cellSize,W=q/Q/Q,V=W*Z/q,z=Math.ceil(V),B=[];for(var H in this.cells){var Y=this.cells[H];for(var $=0;$<Math.min(z,Y.length);$++)B.push(Y[$].key)}return B}}])}();function R8(J){var{graph:K,hoveredNode:Q,highlightedNodes:Z,displayedNodeLabels:q}=J,W=[];return K.forEachEdge(function(V,z,B,H){if(B===Q||H===Q||Z.has(B)||Z.has(H)||q.has(B)&&q.has(H))W.push(V)}),W}var P6=150,I6=50,S0=Object.prototype.hasOwnProperty;function v8(J,K,Q){if(!S0.call(Q,"x")||!S0.call(Q,"y"))throw Error('Sigma: could not find a valid position (x, y) for node "'.concat(K,'". All your nodes must have a number "x" and "y". Maybe your forgot to apply a layout or your "nodeReducer" is not returning the correct data?'));if(!Q.color)Q.color=J.defaultNodeColor;if(!Q.label&&Q.label!=="")Q.label=null;if(Q.label!==void 0&&Q.label!==null)Q.label=""+Q.label;else Q.label=null;if(!Q.size)Q.size=2;if(!S0.call(Q,"hidden"))Q.hidden=!1;if(!S0.call(Q,"highlighted"))Q.highlighted=!1;if(!S0.call(Q,"forceLabel"))Q.forceLabel=!1;if(!Q.type||Q.type==="")Q.type=J.defaultNodeType;if(!Q.zIndex)Q.zIndex=0;return Q}function G8(J,K,Q){if(!Q.color)Q.color=J.defaultEdgeColor;if(!Q.label)Q.label="";if(!Q.size)Q.size=0.5;if(!S0.call(Q,"hidden"))Q.hidden=!1;if(!S0.call(Q,"forceLabel"))Q.forceLabel=!1;if(!Q.type||Q.type==="")Q.type=J.defaultEdgeType;if(!Q.zIndex)Q.zIndex=0;return Q}var O8=function(J){function K(Q,Z){var q,W=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(g(this,K),q=t(this,K),F(q,"elements",{}),F(q,"canvasContexts",{}),F(q,"webGLContexts",{}),F(q,"pickingLayers",new Set),F(q,"textures",{}),F(q,"frameBuffers",{}),F(q,"activeListeners",{}),F(q,"labelGrid",new C6),F(q,"nodeDataCache",{}),F(q,"edgeDataCache",{}),F(q,"nodeProgramIndex",{}),F(q,"edgeProgramIndex",{}),F(q,"nodesWithForcedLabels",new Set),F(q,"edgesWithForcedLabels",new Set),F(q,"nodeExtent",{x:[0,1],y:[0,1]}),F(q,"nodeZExtent",[1/0,-1/0]),F(q,"edgeZExtent",[1/0,-1/0]),F(q,"matrix",H0()),F(q,"invMatrix",H0()),F(q,"correctionRatio",1),F(q,"customBBox",null),F(q,"normalizationFunction",oJ({x:[0,1],y:[0,1]})),F(q,"graphToViewportRatio",1),F(q,"itemIDsIndex",{}),F(q,"nodeIndices",{}),F(q,"edgeIndices",{}),F(q,"width",0),F(q,"height",0),F(q,"pixelRatio",dJ()),F(q,"pickingDownSizingRatio",2*q.pixelRatio),F(q,"displayedNodeLabels",new Set),F(q,"displayedEdgeLabels",new Set),F(q,"highlightedNodes",new Set),F(q,"hoveredNode",null),F(q,"hoveredEdge",null),F(q,"renderFrame",null),F(q,"renderHighlightedNodesFrame",null),F(q,"needToProcess",!1),F(q,"checkEdgesEventsFrame",null),F(q,"nodePrograms",{}),F(q,"nodeHoverPrograms",{}),F(q,"edgePrograms",{}),q.settings=F6(W),UJ(q.settings),U6(Q),!(Z instanceof HTMLElement))throw Error("Sigma: container should be an html element.");q.graph=Q,q.container=Z,q.createWebGLContext("edges",{picking:W.enableEdgeEvents}),q.createCanvasContext("edgeLabels"),q.createWebGLContext("nodes",{picking:!0}),q.createCanvasContext("labels"),q.createCanvasContext("hovers"),q.createWebGLContext("hoverNodes"),q.createCanvasContext("mouse",{style:{touchAction:"none",userSelect:"none"}}),q.resize();for(var V in q.settings.nodeProgramClasses)q.registerNodeProgram(V,q.settings.nodeProgramClasses[V],q.settings.nodeHoverProgramClasses[V]);for(var z in q.settings.edgeProgramClasses)q.registerEdgeProgram(z,q.settings.edgeProgramClasses[z]);return q.camera=new L6,q.bindCameraHandlers(),q.mouseCaptor=new L8(q.elements.mouse,q),q.mouseCaptor.setSettings(q.settings),q.touchCaptor=new C8(q.elements.mouse,q),q.touchCaptor.setSettings(q.settings),q.bindEventHandlers(),q.bindGraphHandlers(),q.handleSettingsUpdate(),q.refresh(),q}return e(K,J),s(K,[{key:"registerNodeProgram",value:function(Z,q,W){if(this.nodePrograms[Z])this.nodePrograms[Z].kill();if(this.nodeHoverPrograms[Z])this.nodeHoverPrograms[Z].kill();return this.nodePrograms[Z]=new q(this.webGLContexts.nodes,this.frameBuffers.nodes,this),this.nodeHoverPrograms[Z]=new(W||q)(this.webGLContexts.hoverNodes,null,this),this}},{key:"registerEdgeProgram",value:function(Z,q){if(this.edgePrograms[Z])this.edgePrograms[Z].kill();return this.edgePrograms[Z]=new q(this.webGLContexts.edges,this.frameBuffers.edges,this),this}},{key:"unregisterNodeProgram",value:function(Z){if(this.nodePrograms[Z]){var q=this.nodePrograms,W=q[Z],V=aJ(q,[Z].map(N0));W.kill(),this.nodePrograms=V}if(this.nodeHoverPrograms[Z]){var z=this.nodeHoverPrograms,B=z[Z],H=aJ(z,[Z].map(N0));B.kill(),this.nodePrograms=H}return this}},{key:"unregisterEdgeProgram",value:function(Z){if(this.edgePrograms[Z]){var q=this.edgePrograms,W=q[Z],V=aJ(q,[Z].map(N0));W.kill(),this.edgePrograms=V}return this}},{key:"resetWebGLTexture",value:function(Z){var q=this.webGLContexts[Z],W=this.frameBuffers[Z],V=this.textures[Z];if(V)q.deleteTexture(V);var z=q.createTexture();return q.bindFramebuffer(q.FRAMEBUFFER,W),q.bindTexture(q.TEXTURE_2D,z),q.texImage2D(q.TEXTURE_2D,0,q.RGBA,this.width,this.height,0,q.RGBA,q.UNSIGNED_BYTE,null),q.framebufferTexture2D(q.FRAMEBUFFER,q.COLOR_ATTACHMENT0,q.TEXTURE_2D,z,0),this.textures[Z]=z,this}},{key:"bindCameraHandlers",value:function(){var Z=this;return this.activeListeners.camera=function(){Z.scheduleRender()},this.camera.on("updated",this.activeListeners.camera),this}},{key:"unbindCameraHandlers",value:function(){return this.camera.removeListener("updated",this.activeListeners.camera),this}},{key:"getNodeAtPosition",value:function(Z){var{x:q,y:W}=Z,V=cJ(this.webGLContexts.nodes,this.frameBuffers.nodes,q,W,this.pixelRatio,this.pickingDownSizingRatio),z=mJ.apply(void 0,T6(V)),B=this.itemIDsIndex[z];return B&&B.type==="node"?B.id:null}},{key:"bindEventHandlers",value:function(){var Z=this;this.activeListeners.handleResize=function(){Z.scheduleRefresh()},window.addEventListener("resize",this.activeListeners.handleResize),this.activeListeners.handleMove=function(W){var V=t0(W),z={event:V,preventSigmaDefault:function(){V.preventSigmaDefault()}},B=Z.getNodeAtPosition(V);if(B&&Z.hoveredNode!==B&&!Z.nodeDataCache[B].hidden){if(Z.hoveredNode)Z.emit("leaveNode",v(v({},z),{},{node:Z.hoveredNode}));Z.hoveredNode=B,Z.emit("enterNode",v(v({},z),{},{node:B})),Z.scheduleHighlightedNodesRender();return}if(Z.hoveredNode){if(Z.getNodeAtPosition(V)!==Z.hoveredNode){var H=Z.hoveredNode;Z.hoveredNode=null,Z.emit("leaveNode",v(v({},z),{},{node:H})),Z.scheduleHighlightedNodesRender();return}}if(Z.settings.enableEdgeEvents){var Y=Z.hoveredNode?null:Z.getEdgeAtPoint(z.event.x,z.event.y);if(Y!==Z.hoveredEdge){if(Z.hoveredEdge)Z.emit("leaveEdge",v(v({},z),{},{edge:Z.hoveredEdge}));if(Y)Z.emit("enterEdge",v(v({},z),{},{edge:Y}));Z.hoveredEdge=Y}}},this.activeListeners.handleMoveBody=function(W){var V=t0(W);Z.emit("moveBody",{event:V,preventSigmaDefault:function(){V.preventSigmaDefault()}})},this.activeListeners.handleLeave=function(W){var V=t0(W),z={event:V,preventSigmaDefault:function(){V.preventSigmaDefault()}};if(Z.hoveredNode)Z.emit("leaveNode",v(v({},z),{},{node:Z.hoveredNode})),Z.scheduleHighlightedNodesRender();if(Z.settings.enableEdgeEvents&&Z.hoveredEdge)Z.emit("leaveEdge",v(v({},z),{},{edge:Z.hoveredEdge})),Z.scheduleHighlightedNodesRender();Z.emit("leaveStage",v({},z))},this.activeListeners.handleEnter=function(W){var V=t0(W),z={event:V,preventSigmaDefault:function(){V.preventSigmaDefault()}};Z.emit("enterStage",v({},z))};var q=function(V){return function(z){var B=t0(z),H={event:B,preventSigmaDefault:function(){B.preventSigmaDefault()}},Y=Z.getNodeAtPosition(B);if(Y)return Z.emit("".concat(V,"Node"),v(v({},H),{},{node:Y}));if(Z.settings.enableEdgeEvents){var $=Z.getEdgeAtPoint(B.x,B.y);if($)return Z.emit("".concat(V,"Edge"),v(v({},H),{},{edge:$}))}return Z.emit("".concat(V,"Stage"),H)}};return this.activeListeners.handleClick=q("click"),this.activeListeners.handleRightClick=q("rightClick"),this.activeListeners.handleDoubleClick=q("doubleClick"),this.activeListeners.handleWheel=q("wheel"),this.activeListeners.handleDown=q("down"),this.activeListeners.handleUp=q("up"),this.mouseCaptor.on("mousemove",this.activeListeners.handleMove),this.mouseCaptor.on("mousemovebody",this.activeListeners.handleMoveBody),this.mouseCaptor.on("click",this.activeListeners.handleClick),this.mouseCaptor.on("rightClick",this.activeListeners.handleRightClick),this.mouseCaptor.on("doubleClick",this.activeListeners.handleDoubleClick),this.mouseCaptor.on("wheel",this.activeListeners.handleWheel),this.mouseCaptor.on("mousedown",this.activeListeners.handleDown),this.mouseCaptor.on("mouseup",this.activeListeners.handleUp),this.mouseCaptor.on("mouseleave",this.activeListeners.handleLeave),this.mouseCaptor.on("mouseenter",this.activeListeners.handleEnter),this.touchCaptor.on("touchdown",this.activeListeners.handleDown),this.touchCaptor.on("touchdown",this.activeListeners.handleMove),this.touchCaptor.on("touchup",this.activeListeners.handleUp),this.touchCaptor.on("touchmove",this.activeListeners.handleMove),this.touchCaptor.on("tap",this.activeListeners.handleClick),this.touchCaptor.on("doubletap",this.activeListeners.handleDoubleClick),this.touchCaptor.on("touchmove",this.activeListeners.handleMoveBody),this}},{key:"bindGraphHandlers",value:function(){var Z=this,q=this.graph,W=new Set(["x","y","zIndex","type"]);return this.activeListeners.eachNodeAttributesUpdatedGraphUpdate=function(V){var z,B=(z=V.hints)===null||z===void 0?void 0:z.attributes;Z.graph.forEachNode(function(Y){return Z.updateNode(Y)});var H=!B||B.some(function(Y){return W.has(Y)});Z.refresh({partialGraph:{nodes:q.nodes()},skipIndexation:!H,schedule:!0})},this.activeListeners.eachEdgeAttributesUpdatedGraphUpdate=function(V){var z,B=(z=V.hints)===null||z===void 0?void 0:z.attributes;Z.graph.forEachEdge(function(Y){return Z.updateEdge(Y)});var H=B&&["zIndex","type"].some(function(Y){return B===null||B===void 0?void 0:B.includes(Y)});Z.refresh({partialGraph:{edges:q.edges()},skipIndexation:!H,schedule:!0})},this.activeListeners.addNodeGraphUpdate=function(V){var z=V.key;Z.addNode(z),Z.refresh({partialGraph:{nodes:[z]},skipIndexation:!1,schedule:!0})},this.activeListeners.updateNodeGraphUpdate=function(V){var z=V.key;Z.refresh({partialGraph:{nodes:[z]},skipIndexation:!1,schedule:!0})},this.activeListeners.dropNodeGraphUpdate=function(V){var z=V.key;Z.removeNode(z),Z.refresh({schedule:!0})},this.activeListeners.addEdgeGraphUpdate=function(V){var z=V.key;Z.addEdge(z),Z.refresh({partialGraph:{edges:[z]},schedule:!0})},this.activeListeners.updateEdgeGraphUpdate=function(V){var z=V.key;Z.refresh({partialGraph:{edges:[z]},skipIndexation:!1,schedule:!0})},this.activeListeners.dropEdgeGraphUpdate=function(V){var z=V.key;Z.removeEdge(z),Z.refresh({schedule:!0})},this.activeListeners.clearEdgesGraphUpdate=function(){Z.clearEdgeState(),Z.clearEdgeIndices(),Z.refresh({schedule:!0})},this.activeListeners.clearGraphUpdate=function(){Z.clearEdgeState(),Z.clearNodeState(),Z.clearEdgeIndices(),Z.clearNodeIndices(),Z.refresh({schedule:!0})},q.on("nodeAdded",this.activeListeners.addNodeGraphUpdate),q.on("nodeDropped",this.activeListeners.dropNodeGraphUpdate),q.on("nodeAttributesUpdated",this.activeListeners.updateNodeGraphUpdate),q.on("eachNodeAttributesUpdated",this.activeListeners.eachNodeAttributesUpdatedGraphUpdate),q.on("edgeAdded",this.activeListeners.addEdgeGraphUpdate),q.on("edgeDropped",this.activeListeners.dropEdgeGraphUpdate),q.on("edgeAttributesUpdated",this.activeListeners.updateEdgeGraphUpdate),q.on("eachEdgeAttributesUpdated",this.activeListeners.eachEdgeAttributesUpdatedGraphUpdate),q.on("edgesCleared",this.activeListeners.clearEdgesGraphUpdate),q.on("cleared",this.activeListeners.clearGraphUpdate),this}},{key:"unbindGraphHandlers",value:function(){var Z=this.graph;Z.removeListener("nodeAdded",this.activeListeners.addNodeGraphUpdate),Z.removeListener("nodeDropped",this.activeListeners.dropNodeGraphUpdate),Z.removeListener("nodeAttributesUpdated",this.activeListeners.updateNodeGraphUpdate),Z.removeListener("eachNodeAttributesUpdated",this.activeListeners.eachNodeAttributesUpdatedGraphUpdate),Z.removeListener("edgeAdded",this.activeListeners.addEdgeGraphUpdate),Z.removeListener("edgeDropped",this.activeListeners.dropEdgeGraphUpdate),Z.removeListener("edgeAttributesUpdated",this.activeListeners.updateEdgeGraphUpdate),Z.removeListener("eachEdgeAttributesUpdated",this.activeListeners.eachEdgeAttributesUpdatedGraphUpdate),Z.removeListener("edgesCleared",this.activeListeners.clearEdgesGraphUpdate),Z.removeListener("cleared",this.activeListeners.clearGraphUpdate)}},{key:"getEdgeAtPoint",value:function(Z,q){var W=cJ(this.webGLContexts.edges,this.frameBuffers.edges,Z,q,this.pixelRatio,this.pickingDownSizingRatio),V=mJ.apply(void 0,T6(W)),z=this.itemIDsIndex[V];return z&&z.type==="edge"?z.id:null}},{key:"process",value:function(){var Z=this;this.emit("beforeProcess");var q=this.graph,W=this.settings,V=this.getDimensions();if(this.nodeExtent=j6(this.graph),!this.settings.autoRescale){var{width:z,height:B}=V,H=this.nodeExtent,Y=H.x,$=H.y;this.nodeExtent={x:[(Y[0]+Y[1])/2-z/2,(Y[0]+Y[1])/2+z/2],y:[($[0]+$[1])/2-B/2,($[0]+$[1])/2+B/2]}}this.normalizationFunction=oJ(this.customBBox||this.nodeExtent);var X=new L6,j=g0(X.getState(),V,this.getGraphDimensions(),this.getStagePadding());this.labelGrid.resizeAndClear(V,W.labelGridCellSize);var w={},L={},A={},G={},k=1,T=q.nodes();for(var P=0,O=T.length;P<O;P++){var M=T[P],I=this.nodeDataCache[M],R=q.getNodeAttributes(M);if(I.x=R.x,I.y=R.y,this.normalizationFunction.applyTo(I),typeof I.label==="string"&&!I.hidden)this.labelGrid.add(M,I.size,this.framedGraphToViewport(I,{matrix:j}));w[I.type]=(w[I.type]||0)+1}this.labelGrid.organize();for(var U in this.nodePrograms){if(!S0.call(this.nodePrograms,U))throw Error('Sigma: could not find a suitable program for node type "'.concat(U,'"!'));this.nodePrograms[U].reallocate(w[U]||0),w[U]=0}if(this.settings.zIndex&&this.nodeZExtent[0]!==this.nodeZExtent[1])T=iJ(this.nodeZExtent,function(LJ){return Z.nodeDataCache[LJ].zIndex},T);for(var u=0,c=T.length;u<c;u++){var h=T[u];L[h]=k,G[L[h]]={type:"node",id:h},k++;var J0=this.nodeDataCache[h];this.addNodeToProgram(h,L[h],w[J0.type]++)}var E={},n=q.edges();for(var q0=0,T0=n.length;q0<T0;q0++){var $0=n[q0],W0=this.edgeDataCache[$0];E[W0.type]=(E[W0.type]||0)+1}if(this.settings.zIndex&&this.edgeZExtent[0]!==this.edgeZExtent[1])n=iJ(this.edgeZExtent,function(LJ){return Z.edgeDataCache[LJ].zIndex},n);for(var Q0 in this.edgePrograms){if(!S0.call(this.edgePrograms,Q0))throw Error('Sigma: could not find a suitable program for edge type "'.concat(Q0,'"!'));this.edgePrograms[Q0].reallocate(E[Q0]||0),E[Q0]=0}for(var K0=0,Y0=n.length;K0<Y0;K0++){var r=n[K0];A[r]=k,G[A[r]]={type:"edge",id:r},k++;var x0=this.edgeDataCache[r];this.addEdgeToProgram(r,A[r],E[x0.type]++)}return this.itemIDsIndex=G,this.nodeIndices=L,this.edgeIndices=A,this.emit("afterProcess"),this}},{key:"handleSettingsUpdate",value:function(Z){var q=this,W=this.settings;if(this.camera.minRatio=W.minCameraRatio,this.camera.maxRatio=W.maxCameraRatio,this.camera.enabledZooming=W.enableCameraZooming,this.camera.enabledPanning=W.enableCameraPanning,this.camera.enabledRotation=W.enableCameraRotation,W.cameraPanBoundaries)this.camera.clean=function(Y){return q.cleanCameraState(Y,W.cameraPanBoundaries&&YJ(W.cameraPanBoundaries)==="object"?W.cameraPanBoundaries:{})};else this.camera.clean=null;if(this.camera.setState(this.camera.validateState(this.camera.getState())),Z){if(Z.edgeProgramClasses!==W.edgeProgramClasses){for(var V in W.edgeProgramClasses)if(W.edgeProgramClasses[V]!==Z.edgeProgramClasses[V])this.registerEdgeProgram(V,W.edgeProgramClasses[V]);for(var z in Z.edgeProgramClasses)if(!W.edgeProgramClasses[z])this.unregisterEdgeProgram(z)}if(Z.nodeProgramClasses!==W.nodeProgramClasses||Z.nodeHoverProgramClasses!==W.nodeHoverProgramClasses){for(var B in W.nodeProgramClasses)if(W.nodeProgramClasses[B]!==Z.nodeProgramClasses[B]||W.nodeHoverProgramClasses[B]!==Z.nodeHoverProgramClasses[B])this.registerNodeProgram(B,W.nodeProgramClasses[B],W.nodeHoverProgramClasses[B]);for(var H in Z.nodeProgramClasses)if(!W.nodeProgramClasses[H])this.unregisterNodeProgram(H)}}return this.mouseCaptor.setSettings(this.settings),this.touchCaptor.setSettings(this.settings),this}},{key:"cleanCameraState",value:function(Z){var q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},W=q.tolerance,V=W===void 0?0:W,z=q.boundaries,B=v({},Z),H=z||this.nodeExtent,Y=v0(H.x,2),$=Y[0],X=Y[1],j=v0(H.y,2),w=j[0],L=j[1],A=[this.graphToViewport({x:$,y:w},{cameraState:Z}),this.graphToViewport({x:X,y:w},{cameraState:Z}),this.graphToViewport({x:$,y:L},{cameraState:Z}),this.graphToViewport({x:X,y:L},{cameraState:Z})],G=1/0,k=-1/0,T=1/0,P=-1/0;A.forEach(function(E){var{x:n,y:q0}=E;G=Math.min(G,n),k=Math.max(k,n),T=Math.min(T,q0),P=Math.max(P,q0)});var O=k-G,M=P-T,I=this.getDimensions(),R=I.width,U=I.height,u=0,c=0;if(O>=R){if(k<R-V)u=k-(R-V);else if(G>V)u=G-V}else if(k>R+V)u=k-(R+V);else if(G<-V)u=G+V;if(M>=U){if(P<U-V)c=P-(U-V);else if(T>V)c=T-V}else if(P>U+V)c=P-(U+V);else if(T<-V)c=T+V;if(u||c){var h=this.viewportToFramedGraph({x:0,y:0},{cameraState:Z}),J0=this.viewportToFramedGraph({x:u,y:c},{cameraState:Z});u=J0.x-h.x,c=J0.y-h.y,B.x+=u,B.y+=c}return B}},{key:"renderLabels",value:function(){if(!this.settings.renderLabels)return this;var Z=this.camera.getState(),q=this.labelGrid.getLabelsToDisplay(Z.ratio,this.settings.labelDensity);rJ(q,this.nodesWithForcedLabels),this.displayedNodeLabels=new Set;var W=this.canvasContexts.labels;for(var V=0,z=q.length;V<z;V++){var B=q[V],H=this.nodeDataCache[B];if(this.displayedNodeLabels.has(B))continue;if(H.hidden)continue;var Y=this.framedGraphToViewport(H),$=Y.x,X=Y.y,j=this.scaleSize(H.size);if(!H.forceLabel&&j<this.settings.labelRenderedSizeThreshold)continue;if($<-P6||$>this.width+P6||X<-I6||X>this.height+I6)continue;this.displayedNodeLabels.add(B);var w=this.settings.defaultDrawNodeLabel,L=this.nodePrograms[H.type],A=(L===null||L===void 0?void 0:L.drawLabel)||w;A(W,v(v({key:B},H),{},{size:j,x:$,y:X}),this.settings)}return this}},{key:"renderEdgeLabels",value:function(){if(!this.settings.renderEdgeLabels)return this;var Z=this.canvasContexts.edgeLabels;Z.clearRect(0,0,this.width,this.height);var q=R8({graph:this.graph,hoveredNode:this.hoveredNode,displayedNodeLabels:this.displayedNodeLabels,highlightedNodes:this.highlightedNodes});rJ(q,this.edgesWithForcedLabels);var W=new Set;for(var V=0,z=q.length;V<z;V++){var B=q[V],H=this.graph.extremities(B),Y=this.nodeDataCache[H[0]],$=this.nodeDataCache[H[1]],X=this.edgeDataCache[B];if(W.has(B))continue;if(X.hidden||Y.hidden||$.hidden)continue;var j=this.settings.defaultDrawEdgeLabel,w=this.edgePrograms[X.type],L=(w===null||w===void 0?void 0:w.drawLabel)||j;L(Z,v(v({key:B},X),{},{size:this.scaleSize(X.size)}),v(v(v({key:H[0]},Y),this.framedGraphToViewport(Y)),{},{size:this.scaleSize(Y.size)}),v(v(v({key:H[1]},$),this.framedGraphToViewport($)),{},{size:this.scaleSize($.size)}),this.settings),W.add(B)}return this.displayedEdgeLabels=W,this}},{key:"renderHighlightedNodes",value:function(){var Z=this,q=this.canvasContexts.hovers;q.clearRect(0,0,this.width,this.height);var W=function(j){var w=Z.nodeDataCache[j],L=Z.framedGraphToViewport(w),A=L.x,G=L.y,k=Z.scaleSize(w.size),T=Z.settings.defaultDrawNodeHover,P=Z.nodePrograms[w.type],O=(P===null||P===void 0?void 0:P.drawHover)||T;O(q,v(v({key:j},w),{},{size:k,x:A,y:G}),Z.settings)},V=[];if(this.hoveredNode&&!this.nodeDataCache[this.hoveredNode].hidden)V.push(this.hoveredNode);this.highlightedNodes.forEach(function(X){if(X!==Z.hoveredNode)V.push(X)}),V.forEach(function(X){return W(X)});var z={};V.forEach(function(X){var j=Z.nodeDataCache[X].type;z[j]=(z[j]||0)+1});for(var B in this.nodeHoverPrograms)this.nodeHoverPrograms[B].reallocate(z[B]||0),z[B]=0;V.forEach(function(X){var j=Z.nodeDataCache[X];Z.nodeHoverPrograms[j.type].process(0,z[j.type]++,j)}),this.webGLContexts.hoverNodes.clear(this.webGLContexts.hoverNodes.COLOR_BUFFER_BIT);var H=this.getRenderParams();for(var Y in this.nodeHoverPrograms){var $=this.nodeHoverPrograms[Y];$.render(H)}}},{key:"scheduleHighlightedNodesRender",value:function(){var Z=this;if(this.renderHighlightedNodesFrame||this.renderFrame)return;this.renderHighlightedNodesFrame=requestAnimationFrame(function(){Z.renderHighlightedNodesFrame=null,Z.renderHighlightedNodes(),Z.renderEdgeLabels()})}},{key:"render",value:function(){var Z=this;this.emit("beforeRender");var q=function(){return Z.emit("afterRender"),Z};if(this.renderFrame)cancelAnimationFrame(this.renderFrame),this.renderFrame=null;if(this.resize(),this.needToProcess)this.process();if(this.needToProcess=!1,this.clear(),this.pickingLayers.forEach(function(A){return Z.resetWebGLTexture(A)}),!this.graph.order)return q();var W=this.mouseCaptor,V=this.camera.isAnimated()||W.isMoving||W.draggedEvents||W.currentWheelDirection,z=this.camera.getState(),B=this.getDimensions(),H=this.getGraphDimensions(),Y=this.getStagePadding();this.matrix=g0(z,B,H,Y),this.invMatrix=g0(z,B,H,Y,!0),this.correctionRatio=X6(this.matrix,z,B),this.graphToViewportRatio=this.getGraphToViewportRatio();var $=this.getRenderParams();for(var X in this.nodePrograms){var j=this.nodePrograms[X];j.render($)}if(!this.settings.hideEdgesOnMove||!V)for(var w in this.edgePrograms){var L=this.edgePrograms[w];L.render($)}if(this.settings.hideLabelsOnMove&&V)return q();return this.renderLabels(),this.renderEdgeLabels(),this.renderHighlightedNodes(),q()}},{key:"addNode",value:function(Z){var q=Object.assign({},this.graph.getNodeAttributes(Z));if(this.settings.nodeReducer)q=this.settings.nodeReducer(Z,q);var W=v8(this.settings,Z,q);if(this.nodeDataCache[Z]=W,this.nodesWithForcedLabels.delete(Z),W.forceLabel&&!W.hidden)this.nodesWithForcedLabels.add(Z);if(this.highlightedNodes.delete(Z),W.highlighted&&!W.hidden)this.highlightedNodes.add(Z);if(this.settings.zIndex){if(W.zIndex<this.nodeZExtent[0])this.nodeZExtent[0]=W.zIndex;if(W.zIndex>this.nodeZExtent[1])this.nodeZExtent[1]=W.zIndex}}},{key:"updateNode",value:function(Z){this.addNode(Z);var q=this.nodeDataCache[Z];this.normalizationFunction.applyTo(q)}},{key:"removeNode",value:function(Z){if(delete this.nodeDataCache[Z],delete this.nodeProgramIndex[Z],this.highlightedNodes.delete(Z),this.hoveredNode===Z)this.hoveredNode=null;this.nodesWithForcedLabels.delete(Z)}},{key:"addEdge",value:function(Z){var q=Object.assign({},this.graph.getEdgeAttributes(Z));if(this.settings.edgeReducer)q=this.settings.edgeReducer(Z,q);var W=G8(this.settings,Z,q);if(this.edgeDataCache[Z]=W,this.edgesWithForcedLabels.delete(Z),W.forceLabel&&!W.hidden)this.edgesWithForcedLabels.add(Z);if(this.settings.zIndex){if(W.zIndex<this.edgeZExtent[0])this.edgeZExtent[0]=W.zIndex;if(W.zIndex>this.edgeZExtent[1])this.edgeZExtent[1]=W.zIndex}}},{key:"updateEdge",value:function(Z){this.addEdge(Z)}},{key:"removeEdge",value:function(Z){if(delete this.edgeDataCache[Z],delete this.edgeProgramIndex[Z],this.hoveredEdge===Z)this.hoveredEdge=null;this.edgesWithForcedLabels.delete(Z)}},{key:"clearNodeIndices",value:function(){this.labelGrid=new C6,this.nodeExtent={x:[0,1],y:[0,1]},this.nodeDataCache={},this.edgeProgramIndex={},this.nodesWithForcedLabels=new Set,this.nodeZExtent=[1/0,-1/0],this.highlightedNodes=new Set}},{key:"clearEdgeIndices",value:function(){this.edgeDataCache={},this.edgeProgramIndex={},this.edgesWithForcedLabels=new Set,this.edgeZExtent=[1/0,-1/0]}},{key:"clearIndices",value:function(){this.clearEdgeIndices(),this.clearNodeIndices()}},{key:"clearNodeState",value:function(){this.displayedNodeLabels=new Set,this.highlightedNodes=new Set,this.hoveredNode=null}},{key:"clearEdgeState",value:function(){this.displayedEdgeLabels=new Set,this.highlightedNodes=new Set,this.hoveredEdge=null}},{key:"clearState",value:function(){this.clearEdgeState(),this.clearNodeState()}},{key:"addNodeToProgram",value:function(Z,q,W){var V=this.nodeDataCache[Z],z=this.nodePrograms[V.type];if(!z)throw Error('Sigma: could not find a suitable program for node type "'.concat(V.type,'"!'));z.process(q,W,V),this.nodeProgramIndex[Z]=W}},{key:"addEdgeToProgram",value:function(Z,q,W){var V=this.edgeDataCache[Z],z=this.edgePrograms[V.type];if(!z)throw Error('Sigma: could not find a suitable program for edge type "'.concat(V.type,'"!'));var B=this.graph.extremities(Z),H=this.nodeDataCache[B[0]],Y=this.nodeDataCache[B[1]];z.process(q,W,H,Y,V),this.edgeProgramIndex[Z]=W}},{key:"getRenderParams",value:function(){return{matrix:this.matrix,invMatrix:this.invMatrix,width:this.width,height:this.height,pixelRatio:this.pixelRatio,zoomRatio:this.camera.ratio,cameraAngle:this.camera.angle,sizeRatio:1/this.scaleSize(),correctionRatio:this.correctionRatio,downSizingRatio:this.pickingDownSizingRatio,minEdgeThickness:this.settings.minEdgeThickness,antiAliasingFeather:this.settings.antiAliasingFeather}}},{key:"getStagePadding",value:function(){var Z=this.settings,q=Z.stagePadding,W=Z.autoRescale;return W?q||0:0}},{key:"createLayer",value:function(Z,q){var W=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(this.elements[Z])throw Error('Sigma: a layer named "'.concat(Z,'" already exists'));var V=w6(q,{position:"absolute"},{class:"sigma-".concat(Z)});if(W.style)Object.assign(V.style,W.style);if(this.elements[Z]=V,"beforeLayer"in W&&W.beforeLayer)this.elements[W.beforeLayer].before(V);else if("afterLayer"in W&&W.afterLayer)this.elements[W.afterLayer].after(V);else this.container.appendChild(V);return V}},{key:"createCanvas",value:function(Z){var q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.createLayer(Z,"canvas",q)}},{key:"createCanvasContext",value:function(Z){var q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},W=this.createCanvas(Z,q),V={preserveDrawingBuffer:!1,antialias:!1};return this.canvasContexts[Z]=W.getContext("2d",V),this}},{key:"createWebGLContext",value:function(Z){var q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},W=(q===null||q===void 0?void 0:q.canvas)||this.createCanvas(Z,q);if(q.hidden)W.remove();var V=v({preserveDrawingBuffer:!1,antialias:!1},q),z;if(z=W.getContext("webgl2",V),!z)z=W.getContext("webgl",V);if(!z)z=W.getContext("experimental-webgl",V);var B=z;if(this.webGLContexts[Z]=B,B.blendFunc(B.ONE,B.ONE_MINUS_SRC_ALPHA),q.picking){this.pickingLayers.add(Z);var H=B.createFramebuffer();if(!H)throw Error("Sigma: cannot create a new frame buffer for layer ".concat(Z));this.frameBuffers[Z]=H}return B}},{key:"killLayer",value:function(Z){var q=this.elements[Z];if(!q)throw Error("Sigma: cannot kill layer ".concat(Z,", which does not exist"));if(this.webGLContexts[Z]){var W,V=this.webGLContexts[Z];(W=V.getExtension("WEBGL_lose_context"))===null||W===void 0||W.loseContext(),delete this.webGLContexts[Z]}else if(this.canvasContexts[Z])delete this.canvasContexts[Z];return q.remove(),delete this.elements[Z],this}},{key:"getCamera",value:function(){return this.camera}},{key:"setCamera",value:function(Z){this.unbindCameraHandlers(),this.camera=Z,this.bindCameraHandlers()}},{key:"getContainer",value:function(){return this.container}},{key:"getGraph",value:function(){return this.graph}},{key:"setGraph",value:function(Z){if(Z===this.graph)return;if(this.hoveredNode&&!Z.hasNode(this.hoveredNode))this.hoveredNode=null;if(this.hoveredEdge&&!Z.hasEdge(this.hoveredEdge))this.hoveredEdge=null;if(this.unbindGraphHandlers(),this.checkEdgesEventsFrame!==null)cancelAnimationFrame(this.checkEdgesEventsFrame),this.checkEdgesEventsFrame=null;this.graph=Z,this.bindGraphHandlers(),this.refresh()}},{key:"getMouseCaptor",value:function(){return this.mouseCaptor}},{key:"getTouchCaptor",value:function(){return this.touchCaptor}},{key:"getDimensions",value:function(){return{width:this.width,height:this.height}}},{key:"getGraphDimensions",value:function(){var Z=this.customBBox||this.nodeExtent;return{width:Z.x[1]-Z.x[0]||1,height:Z.y[1]-Z.y[0]||1}}},{key:"getNodeDisplayData",value:function(Z){var q=this.nodeDataCache[Z];return q?Object.assign({},q):void 0}},{key:"getEdgeDisplayData",value:function(Z){var q=this.edgeDataCache[Z];return q?Object.assign({},q):void 0}},{key:"getNodeDisplayedLabels",value:function(){return new Set(this.displayedNodeLabels)}},{key:"getEdgeDisplayedLabels",value:function(){return new Set(this.displayedEdgeLabels)}},{key:"getSettings",value:function(){return v({},this.settings)}},{key:"getSetting",value:function(Z){return this.settings[Z]}},{key:"setSetting",value:function(Z,q){var W=v({},this.settings);return this.settings[Z]=q,UJ(this.settings),this.handleSettingsUpdate(W),this.scheduleRefresh(),this}},{key:"updateSetting",value:function(Z,q){return this.setSetting(Z,q(this.settings[Z])),this}},{key:"setSettings",value:function(Z){var q=v({},this.settings);return this.settings=v(v({},this.settings),Z),UJ(this.settings),this.handleSettingsUpdate(q),this.scheduleRefresh(),this}},{key:"resize",value:function(Z){var q=this.width,W=this.height;if(this.width=this.container.offsetWidth,this.height=this.container.offsetHeight,this.pixelRatio=dJ(),this.width===0)if(this.settings.allowInvalidContainer)this.width=1;else throw Error("Sigma: Container has no width. You can set the allowInvalidContainer setting to true to stop seeing this error.");if(this.height===0)if(this.settings.allowInvalidContainer)this.height=1;else throw Error("Sigma: Container has no height. You can set the allowInvalidContainer setting to true to stop seeing this error.");if(!Z&&q===this.width&&W===this.height)return this;for(var V in this.elements){var z=this.elements[V];z.style.width=this.width+"px",z.style.height=this.height+"px"}for(var B in this.canvasContexts)if(this.elements[B].setAttribute("width",this.width*this.pixelRatio+"px"),this.elements[B].setAttribute("height",this.height*this.pixelRatio+"px"),this.pixelRatio!==1)this.canvasContexts[B].scale(this.pixelRatio,this.pixelRatio);for(var H in this.webGLContexts){this.elements[H].setAttribute("width",this.width*this.pixelRatio+"px"),this.elements[H].setAttribute("height",this.height*this.pixelRatio+"px");var Y=this.webGLContexts[H];if(Y.viewport(0,0,this.width*this.pixelRatio,this.height*this.pixelRatio),this.pickingLayers.has(H)){var $=this.textures[H];if($)Y.deleteTexture($)}}return this.emit("resize"),this}},{key:"clear",value:function(){return this.emit("beforeClear"),this.webGLContexts.nodes.bindFramebuffer(WebGLRenderingContext.FRAMEBUFFER,null),this.webGLContexts.nodes.clear(WebGLRenderingContext.COLOR_BUFFER_BIT),this.webGLContexts.edges.bindFramebuffer(WebGLRenderingContext.FRAMEBUFFER,null),this.webGLContexts.edges.clear(WebGLRenderingContext.COLOR_BUFFER_BIT),this.webGLContexts.hoverNodes.clear(WebGLRenderingContext.COLOR_BUFFER_BIT),this.canvasContexts.labels.clearRect(0,0,this.width,this.height),this.canvasContexts.hovers.clearRect(0,0,this.width,this.height),this.canvasContexts.edgeLabels.clearRect(0,0,this.width,this.height),this.emit("afterClear"),this}},{key:"refresh",value:function(Z){var q=this,W=(Z===null||Z===void 0?void 0:Z.skipIndexation)!==void 0?Z===null||Z===void 0?void 0:Z.skipIndexation:!1,V=(Z===null||Z===void 0?void 0:Z.schedule)!==void 0?Z.schedule:!1,z=!Z||!Z.partialGraph;if(z)this.clearEdgeIndices(),this.clearNodeIndices(),this.graph.forEachNode(function(P){return q.addNode(P)}),this.graph.forEachEdge(function(P){return q.addEdge(P)});else{var B,H,Y=((B=Z.partialGraph)===null||B===void 0?void 0:B.nodes)||[];for(var $=0,X=(Y===null||Y===void 0?void 0:Y.length)||0;$<X;$++){var j=Y[$];if(this.updateNode(j),W){var w=this.nodeProgramIndex[j];if(w===void 0)throw Error('Sigma: node "'.concat(j,`" can't be repaint`));this.addNodeToProgram(j,this.nodeIndices[j],w)}}var L=(Z===null||Z===void 0||(H=Z.partialGraph)===null||H===void 0?void 0:H.edges)||[];for(var A=0,G=L.length;A<G;A++){var k=L[A];if(this.updateEdge(k),W){var T=this.edgeProgramIndex[k];if(T===void 0)throw Error('Sigma: edge "'.concat(k,`" can't be repaint`));this.addEdgeToProgram(k,this.edgeIndices[k],T)}}}if(z||!W)this.needToProcess=!0;if(V)this.scheduleRender();else this.render();return this}},{key:"scheduleRender",value:function(){var Z=this;if(!this.renderFrame)this.renderFrame=requestAnimationFrame(function(){Z.render()});return this}},{key:"scheduleRefresh",value:function(Z){return this.refresh(v(v({},Z),{},{schedule:!0}))}},{key:"getViewportZoomedState",value:function(Z,q){var W=this.camera.getState(),V=W.ratio,z=W.angle,B=W.x,H=W.y,Y=this.settings,$=Y.minCameraRatio,X=Y.maxCameraRatio;if(typeof X==="number")q=Math.min(q,X);if(typeof $==="number")q=Math.max(q,$);var j=q/V,w={x:this.width/2,y:this.height/2},L=this.viewportToFramedGraph(Z),A=this.viewportToFramedGraph(w);return{angle:z,x:(L.x-A.x)*(1-j)+B,y:(L.y-A.y)*(1-j)+H,ratio:q}}},{key:"viewRectangle",value:function(){var Z=this.viewportToFramedGraph({x:0,y:0}),q=this.viewportToFramedGraph({x:this.width,y:0}),W=this.viewportToFramedGraph({x:0,y:this.height});return{x1:Z.x,y1:Z.y,x2:q.x,y2:q.y,height:q.y-W.y}}},{key:"framedGraphToViewport",value:function(Z){var q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},W=!!q.cameraState||!!q.viewportDimensions||!!q.graphDimensions,V=q.matrix?q.matrix:W?g0(q.cameraState||this.camera.getState(),q.viewportDimensions||this.getDimensions(),q.graphDimensions||this.getGraphDimensions(),q.padding||this.getStagePadding()):this.matrix,z=$J(V,Z);return{x:(1+z.x)*this.width/2,y:(1-z.y)*this.height/2}}},{key:"viewportToFramedGraph",value:function(Z){var q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},W=!!q.cameraState||!!q.viewportDimensions||!q.graphDimensions,V=q.matrix?q.matrix:W?g0(q.cameraState||this.camera.getState(),q.viewportDimensions||this.getDimensions(),q.graphDimensions||this.getGraphDimensions(),q.padding||this.getStagePadding(),!0):this.invMatrix,z=$J(V,{x:Z.x/this.width*2-1,y:1-Z.y/this.height*2});if(isNaN(z.x))z.x=0;if(isNaN(z.y))z.y=0;return z}},{key:"viewportToGraph",value:function(Z){var q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.normalizationFunction.inverse(this.viewportToFramedGraph(Z,q))}},{key:"graphToViewport",value:function(Z){var q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.framedGraphToViewport(this.normalizationFunction(Z),q)}},{key:"getGraphToViewportRatio",value:function(){var Z={x:0,y:0},q={x:1,y:1},W=Math.sqrt(Math.pow(Z.x-q.x,2)+Math.pow(Z.y-q.y,2)),V=this.graphToViewport(Z),z=this.graphToViewport(q),B=Math.sqrt(Math.pow(V.x-z.x,2)+Math.pow(V.y-z.y,2));return B/W}},{key:"getBBox",value:function(){return this.nodeExtent}},{key:"getCustomBBox",value:function(){return this.customBBox}},{key:"setCustomBBox",value:function(Z){return this.customBBox=Z,this.scheduleRender(),this}},{key:"kill",value:function(){if(this.emit("kill"),this.removeAllListeners(),this.unbindCameraHandlers(),window.removeEventListener("resize",this.activeListeners.handleResize),this.mouseCaptor.kill(),this.touchCaptor.kill(),this.unbindGraphHandlers(),this.clearIndices(),this.clearState(),this.nodeDataCache={},this.edgeDataCache={},this.highlightedNodes.clear(),this.renderFrame)cancelAnimationFrame(this.renderFrame),this.renderFrame=null;if(this.renderHighlightedNodesFrame)cancelAnimationFrame(this.renderHighlightedNodesFrame),this.renderHighlightedNodesFrame=null;var Z=this.container;while(Z.firstChild)Z.removeChild(Z.firstChild);for(var q in this.nodePrograms)this.nodePrograms[q].kill();for(var W in this.nodeHoverPrograms)this.nodeHoverPrograms[W].kill();for(var V in this.edgePrograms)this.edgePrograms[V].kill();this.nodePrograms={},this.nodeHoverPrograms={},this.edgePrograms={};for(var z in this.elements)this.killLayer(z);this.canvasContexts={},this.webGLContexts={},this.elements={}}},{key:"scaleSize",value:function(){var Z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.camera.ratio;return Z/this.settings.zoomToSizeRatioFunction(q)*(this.getSetting("itemSizesReference")==="positions"?q*this.graphToViewportRatio:1)}},{key:"getCanvases",value:function(){var Z={};for(var q in this.elements)if(this.elements[q]instanceof HTMLCanvasElement)Z[q]=this.elements[q];return Z}}])}(BJ),R6=O8;var f8={nodes:[],edges:[]};function M8(){let J=window.__KEG__;if(!J||!Array.isArray(J.nodes)||!Array.isArray(J.edges))return f8;return J}function b8(){let J=document.getElementById("panel");if(J)return J;let K=document.createElement("aside");return K.id="panel",K.className="hidden",document.body.appendChild(K),K}function N8(J){J.innerHTML=`
    <div style="padding:24px;font-family:monospace">
      <h2 style="margin:0 0 8px 0">KEG Graph</h2>
      <p style="margin:0;color:#4b5563">No nodes found in dex indexes.</p>
    </div>
  `}function y8(J){let K=new Map;for(let Q of J.nodes){if(!Q||typeof Q.id!=="string"||Q.id.trim()==="")continue;K.set(Q.id,{id:Q.id,label:Q.label||Q.id,summary:Q.summary||"",tags:Array.isArray(Q.tags)?Q.tags:[],url:Q.url||""})}return K}function x8(J){if(J==="backlink")return"rgba(71, 85, 105, 0.42)";return"rgba(30, 64, 175, 0.62)"}function E8(J){if(J==="backlink")return"line";return"arrow"}function D8(){let J=document.getElementById("app");if(!J)return;let K=M8();if(K.nodes.length===0){N8(J);return}let Q=y8(K),Z=new x({multi:!0,type:"directed"}),q=new Map,W=Array.from(Q.values()),V=W.length,z=Math.max(20,Math.sqrt(V)*12);W.forEach((j,w)=>{let L=w/Math.max(V,1)*Math.PI*2,A=1+Math.floor(w/180),G=Math.cos(L)*z*A*0.25,k=Math.sin(L)*z*A*0.25;q.set(j.id,0),Z.addNode(j.id,{x:G,y:k,label:j.label||j.id,size:4,color:"#1f5aa6",data:j})});let B=0;if(K.edges.forEach((j,w)=>{if(!j||!j.source||!j.target)return;if(!Z.hasNode(j.source))Z.addNode(j.source,{x:0,y:0,label:j.source,size:3,color:"#64748b",data:{id:j.source,label:j.source,summary:"",tags:[],url:""}}),q.set(j.source,q.get(j.source)??0);if(!Z.hasNode(j.target))Z.addNode(j.target,{x:0,y:0,label:j.target,size:3,color:"#64748b",data:{id:j.target,label:j.target,summary:"",tags:[],url:""}}),q.set(j.target,q.get(j.target)??0);let L=`${j.source}->${j.target}:${j.type}:${w}`;Z.addEdgeWithKey(L,j.source,j.target,{color:x8(j.type),size:j.type==="backlink"?0.55:0.95,type:E8(j.type),data:j}),q.set(j.source,(q.get(j.source)??0)+1),q.set(j.target,(q.get(j.target)??0)+1),B++}),Z.forEachNode((j)=>{let w=q.get(j)??0;Z.setNodeAttribute(j,"size",2.4+Math.min(10,Math.sqrt(w+1)))}),Z.order>1&&Z.order<=2600&&B>0)tJ.default.assign(Z,{iterations:80,settings:tJ.default.inferSettings(Z)});let H=b8(),Y=new R6(Z,J,{renderLabels:!0,labelRenderedSizeThreshold:9,defaultEdgeType:"arrow",defaultNodeColor:"#1f5aa6",defaultEdgeColor:"rgba(30, 64, 175, 0.62)",defaultDrawEdgeLabels:!1,enableEdgeEvents:!1});function $(){H.classList.add("hidden"),H.innerHTML=""}function X(j){let w=Z.getNodeAttributes(j),L=w.data??{id:j,label:w.label||j,summary:"",tags:[],url:""},A=Z.outDegree(j),G=Z.inDegree(j),k=Array.isArray(L.tags)?L.tags:[],T=k.length>0?k.join(", "):"none",P=L.summary?.trim()||"No summary available.",O=L.url&&L.url.trim()!==""?`<p class="meta"><a href="${L.url}" target="_blank" rel="noopener noreferrer">Open node</a></p>`:"";H.innerHTML=`
      <h2>${L.label||L.id}</h2>
      <p>${P}</p>
      <p class="meta"><strong>ID:</strong> <code>${L.id}</code></p>
      <p class="meta"><strong>Tags:</strong> ${T}</p>
      <p class="meta"><strong>Outgoing:</strong> ${A} &nbsp;&nbsp; <strong>Incoming:</strong> ${G}</p>
      ${O}
    `,H.classList.remove("hidden")}Y.on("clickNode",({node:j})=>{X(j)}),Y.on("clickStage",()=>{$()})}D8();
